(this.webpackJsonplicresia_demo=this.webpackJsonplicresia_demo||[]).push([[0],{12:function(e,n,t){"use strict";(function(e){var i,o=t(8),c=t.n(o),a=t(10),r=t(46),s=t.n(r),l=t(36),d=t(50);!function(n){var t=n.DB_SERVER_DOMAIN="https://licresia-demo01-server.glitch.me",o=n.APP_SERVER_DOMAIN="https://demo-app.licresia.com",r=function(){return new d.a("licresia-demo-user",8)},b=(n.getHashedFromUserSeq=function(e){var n=r().encode(e);return l.a.encode(n,!0)},n.getDecryptionedUserSeq=function(e){var n=r();return Number(n.decode(l.a.decode(e)))},function(){return new d.a("licresia-demo",8)}),u=n.getHashedFromScoreSeq=function(e){var n=b().encode(e);return l.a.encode(n,!0)},h=(n.getDecryptionedScoreSeq=function(e){var n=b();return Number(n.decode(l.a.decode(e)))},n.getPreviewURL=function(e){var n=u(e);return"".concat(o,"/#/preview?v=").concat(n)},n.sendQueryRequestToMailAPI=function(e){return fetch(t+"/mail",function(e){return{mode:"cors",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}}(e))},n.sendQueryRequestToAPI=function(e,n){return fetch(t+"/"+e,function(e){return{mode:"cors",method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({sql:e})}}(n))}),p=n.findUserInfoList=Object(a.a)(c.a.mark((function e(){var n,t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("select","SELECT id, email FROM user_tbl");case 2:return n=e.sent,e.next=5,n.json();case 5:return t=e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));n.findUserIdList=Object(a.a)(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:return n=e.sent,e.abrupt("return",n.map((function(e){return e.id})));case 4:case"end":return e.stop()}}),e)}))),n.findUserInfoFromEmail=function(){var e=Object(a.a)(c.a.mark((function e(n){var t,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("select","SELECT seq, id FROM user_tbl WHERE email = '".concat(n,"'"));case 2:return t=e.sent,e.next=5,t.json();case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n.findUserInfoFromSeq=function(){var e=Object(a.a)(c.a.mark((function e(n){var t,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("select","SELECT seq, id, password, email FROM user_tbl WHERE seq = ".concat(n));case 2:return t=e.sent,e.next=5,t.json();case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n.findUserInfoLogin=function(){var e=Object(a.a)(c.a.mark((function e(n,t){var i,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("select","SELECT seq, id, password, email FROM user_tbl WHERE id = '".concat(n,"' and password = '").concat(t,"'"));case 2:return i=e.sent,e.next=5,i.json();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),n.getNextUserSeq=Object(a.a)(c.a.mark((function e(){var n,t,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("select","SELECT seq FROM sqlite_sequence WHERE name = 'user_tbl'");case 2:return n=e.sent,e.next=5,n.json();case 5:return t=e.sent,o=t[0].seq+1,i.sendQueryRequestToAPI("update","update sqlite_sequence set seq = seq + 1 where name='user_tbl'"),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)}))),n.findUserScoreList=function(){var e=Object(a.a)(c.a.mark((function e(n){var t,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.sendQueryRequestToAPI("select","SELECT seq, dispnam, share FROM scoretbl WHERE user_seq = ".concat(n));case 2:return t=e.sent,e.next=5,t.json();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n.findScore=function(){var e=Object(a.a)(c.a.mark((function e(n){var t,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.sendQueryRequestToAPI("select","SELECT (select id from user_tbl where seq = score.user_seq) as owner, dispnam, data FROM scoretbl score WHERE seq = ".concat(n));case 2:return t=e.sent,e.next=5,t.json();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),n.gZip=function(e){var n=encodeURIComponent(e);return s.a.gzipSync(n).toString("base64")},n.unZip=function(n){var t=e.from(n,"base64"),i=s.a.unzipSync(t);return decodeURIComponent(i.toString())},n.getStringFromDate=function(e){var n=e.getFullYear().toString(),t=(1+e.getMonth()).toString(),i=e.getDate().toString(),o=e.getHours().toString(),c=e.getMinutes().toString(),a=e.getSeconds().toString(),r="YYYY-MM-DD hh:mm:ss";return r=(r=(r=(r=(r=(r=r.replace(/YYYY/g,n)).replace(/MM/g,t)).replace(/DD/g,i)).replace(/hh/g,o)).replace(/mm/g,c)).replace(/ss/g,a)},n.saveFile=function(e,n){var t=n.fileHandle;null!=t?Object(a.a)(c.a.mark((function o(){var a,r;return c.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.createWritable();case 2:return a=o.sent,r=i.gZip(e),o.next=6,a.write(r);case 6:return o.next=8,a.close();case 8:return n.fileHandle=t,o.next=11,t.getFile();case 11:o.sent,alert("saved successfully!");case 13:case"end":return o.stop()}}),o)})))():window.showSaveFilePicker({types:[{accept:{"text/plain":[".lcrs"]}}]}).then((function(t){Object(a.a)(c.a.mark((function o(){var a,r;return c.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,t.createWritable();case 2:return a=o.sent,r=i.gZip(e),o.next=6,a.write(r);case 6:return o.next=8,a.close();case 8:n.fileHandle=t;case 9:case"end":return o.stop()}}),o)})))()})).catch((function(){console.log("\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f")}))}}(i||(i={})),n.a=i}).call(this,t(23).Buffer)},131:function(e,n,t){"use strict";t.r(n);var i,o=t(4),c=t.n(o),a=t(62),r=t.n(a),s=(t(77),t(2)),l=t(9),d=t(3),b=t(8),u=t.n(b),h=t(7),p=t(10),x=t(5);!function(e){e[e.SET_USER_ENV=0]="SET_USER_ENV",e[e.SET_SYSTEM_STATE=1]="SET_SYSTEM_STATE",e[e.SET_SCORE_STATE=2]="SET_SCORE_STATE",e[e.SET_TUNE_STATE=3]="SET_TUNE_STATE",e[e.SET_SCORE_DATA=4]="SET_SCORE_DATA",e[e.SET_REFS=5]="SET_REFS",e[e.SET_INSTRUMENTS=6]="SET_INSTRUMENTS",e[e.SET_BACKING_STATE=7]="SET_BACKING_STATE",e[e.SET_RESERVE_TASKS=8]="SET_RESERVE_TASKS",e[e.SET_INVALIDATE=9]="SET_INVALIDATE"}(i||(i={}));var f,g=function(e,n){var t=n.type,o=n.payload;switch(t){case i.SET_USER_ENV:e.userEnv=o.userEnv;break;case i.SET_SYSTEM_STATE:e.systemState=o.systemState;break;case i.SET_SCORE_STATE:e.scoreState=o.scoreState;break;case i.SET_SCORE_DATA:e.scoreData=o.scoreData;break;case i.SET_TUNE_STATE:e.melodyState=o.tuneState;break;case i.SET_REFS:e.refs=o.refs;break;case i.SET_INSTRUMENTS:e.instruments=o.instruments;break;case i.SET_BACKING_STATE:e.backingState=o.backingState;break;case i.SET_RESERVE_TASKS:e.reserveTasks=o.reserveTasks;break;case i.SET_INVALIDATE:e.invalidate=o.invalidate}return Object(h.a)({},e)};t(72);!function(e){e.MAJOR_SCALE_INTERVALS=[0,2,4,5,7,9,11],e.MINOR_SCALE_INTERVALS=[0,2,3,5,7,8,10],e.KEY12_FLAT_LIST=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],e.KEY12_SHARP_LIST=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];var n=e.DEGREE12_FLAT_LIST=["\u2160","b\u2161","\u2161","b\u2162","\u2162","\u2163","b\u2164","\u2164","b\u2165","\u2165","b\u2166","\u2166"],t=e.DEGREE12_SHARP_LIST=["\u2160","#\u2160","\u2161","#\u2161","\u2162","\u2163","#\u2163","\u2164","#\u2164","\u2165","#\u2165","\u2166"],i=e.KEY12_MAJOR_SCALE_LIST=["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],o=e.KEY12_MINOR_SCALE_LIST=["C","C#","D","D#","E","F","F#","G","G#","A","Bb","B"],c=(e.getDisplayKeyScaleName=function(e,n){return"major"===n?i[e]:o[e]+"m"},e.isFlat=function(e,n){return-1!==("major"===n?i[e]:o[e]).indexOf("b")},e.SCALE_DEF_LIST=["major","minor"],e.BEAT_DEF_LIST=["2/4","4/4","3/4","6/8","9/8","12/8"],e.isFlatFromRelation=function(e){switch(e){case"M2":case"M3":case"M6":case"M7":return!1}return!0},e.SymbolAttributeList=["triad","seventh","add9th","ninth"],e.getBeatProps=function(e){switch(e){case"4/4":return{beatMemoriCount:4,barBeatCnt:4};case"2/4":return{beatMemoriCount:4,barBeatCnt:2};case"3/4":return{beatMemoriCount:4,barBeatCnt:3};case"6/8":return{beatMemoriCount:6,barBeatCnt:2};case"9/8":return{beatMemoriCount:6,barBeatCnt:3};case"12/8":return{beatMemoriCount:6,barBeatCnt:4}}}),a=(e.calcSustainMsec=function(e,n,t,i){return 6e4/t*(e+n*(1/c(i).beatMemoriCount))},e.SYMBOL_LIST=[{key:"major",name:"",base:null,structs:["p1","M3","p5"],attr:"triad"},{key:"minor",name:"m",base:null,structs:["p1","m3","p5"],attr:"triad"},{key:"suspend4th",name:"sus4",base:null,structs:["p1","p4","p5"],attr:"triad"},{key:"diminish",name:"dim",base:null,structs:["p1","m3","d5"],attr:"triad"},{key:"diminish-7th",name:"dim7",base:"diminish",structs:["p1","m3","d5","d7"],attr:"seventh"},{key:"augument",name:"aug",base:null,structs:["p1","M3","a5"],attr:"triad"},{key:"augument-7th",name:"aug7",base:"augument",structs:["p1","M3","a5","m7"]},{key:"minor-minus5",name:"m(-5)",base:null,structs:["p1","m3","d5"],attr:"triad"},{key:"major-minus5",name:"-5",base:null,structs:["p1","M3","d5"],attr:"triad"},{key:"minor7-minus5",name:"m7(-5)",base:"minor-minus5",structs:["p1","m3","d5","m7"],attr:"seventh"},{key:"major-maj7th",name:"maj7",base:"major",structs:["p1","M3","p5","M7"],attr:"seventh"},{key:"major-min7th",name:"7",base:"major",structs:["p1","M3","p5","m7"],attr:"seventh"},{key:"minor-7th",name:"m7",base:"minor",structs:["p1","m3","p5","m7"],attr:"seventh"},{key:"sus4-7th",name:"7sus4",base:"suspend4th",structs:["p1","p4","p5","m7"]},{key:"minor-maj7th",name:"mmaj7",base:"minor",structs:["p1","m3","p5","M7"],attr:"seventh"},{key:"major-add9th",name:"add9",base:"major",structs:["p1","M2","M3","p5"],attr:"add9th"},{key:"minor-add9th",name:"madd9",base:"minor",structs:["p1","M2","m3","p5"],attr:"add9th"},{key:"major-maj9th",name:"maj9",base:"major-maj7th",structs:["p1","m3","p5"],attr:"add9th"},{key:"major-9th",name:"9",base:"major-min7th",structs:["p1","m3","p5"]},{key:"sixth",name:"6",base:"major",structs:["p1","M3","p5","M6"]},{key:"minor-sixth",name:"m6",base:"minor",structs:["p1","m3","p5","M6"]}]),r=e.IntervalRelationProps={p1:0,m2:1,M2:2,m3:3,M3:4,p4:5,d5:6,p5:7,a5:8,m6:8,M6:9,d7:9,m7:10,M7:11},s=(e.DIATONIC_MAJOR_SCALE_LIST=[{root:{index:0,isFlat:!1},symbolKey:"major"},{root:{index:2,isFlat:!1},symbolKey:"minor"},{root:{index:4,isFlat:!1},symbolKey:"minor"},{root:{index:5,isFlat:!1},symbolKey:"major"},{root:{index:7,isFlat:!1},symbolKey:"major"},{root:{index:9,isFlat:!1},symbolKey:"minor"},{root:{index:11,isFlat:!1},symbolKey:"minor-minus5"}],e.DIATONIC_MINOR_SCALE_LIST=[{root:{index:0,isFlat:!1},symbolKey:"minor"},{root:{index:2,isFlat:!1},symbolKey:"minor-minus5"},{root:{index:3,isFlat:!0},symbolKey:"major"},{root:{index:5,isFlat:!1},symbolKey:"minor"},{root:{index:7,isFlat:!1},symbolKey:"minor"},{root:{index:8,isFlat:!0},symbolKey:"major"},{root:{index:10,isFlat:!0},symbolKey:"major"}],e.DEGREE_ALL=[null,{index:0,isFlat:!1},{index:1,isFlat:!1},{index:1,isFlat:!0},{index:2,isFlat:!1},{index:3,isFlat:!1},{index:3,isFlat:!0},{index:4,isFlat:!1},{index:5,isFlat:!1},{index:6,isFlat:!1},{index:6,isFlat:!0},{index:7,isFlat:!1},{index:8,isFlat:!1},{index:8,isFlat:!0},{index:9,isFlat:!1},{index:10,isFlat:!1},{index:10,isFlat:!0},{index:11,isFlat:!1}],e.getDegreeRoot=function(e){return(e.isFlat?n:t)[e.index]},e.DIATONIC_MAJOR_SCALE_DEGREE_NAMES=["\u2160","\u2160maj7","\u2161m","\u2161m7","\u2162m","\u2162m7","\u2163","\u2163maj7","\u2164","\u21647","\u2165m","\u2165m7","\u2166m(-5)","\u2166m7(-5)"]),l=e.DIATONIC_NATURAL_MINOR_SCALE_DEGREE_NAMES=["\u2160m","\u2160m7","\u2161m(-5)","\u2161m7(-5)","b\u2162","b\u2162M7","\u2163m","\u2163m7","\u2164m","\u2164m7","b\u2165","b\u2165M7","b\u2166","b\u21667"];e.getDiatonicDegreeList=function(e){return"major"===e?s:l},e.getRootName=function(e,n){return(e.isFlat?f.KEY12_FLAT_LIST:f.KEY12_SHARP_LIST)[(n+e.index)%12]},e.getSymbolFromKey=function(e){return a.find((function(n){if(e===n.key)return n}))},e.getSymbolsFromAttr=function(e){var n=[];return a.forEach((function(t){e===t.attr&&n.push(t)})),n},e.getSymbolDerives=function(e){var n=[];return a.forEach((function(t){e===t.base&&n.push(t.key)})),n},e.getIntervalValues=function(e,n){return n.map((function(n){return e+r[n]}))}}(f||(f={}));var j,v=f;!function(e){e.OCTAVE_NUM=8,e.STRUCT_NUM=6,e.CHANNEL_MAX=12,e.getChordDetails=function(e,n,t,i){var o=(e.index+n)%12,c=v.getRootName(e,n)+i.name,a=-1;if(null!=t){var r=v.getRootName(t,n);c="".concat(c,"/").concat(r),a=(t.index+n)%12}var s=i.structs.map((function(e){var n=e,t=v.IntervalRelationProps[n],i=(o+t)%12,c=Math.floor((o+t)/12);return{relation:n,soundIndex:i,isFlat:v.isFlatFromRelation(n),adjustOctave:c}}));if(-1!==a){var l=-1;s.some((function(e,n){e.soundIndex!==a||(l=n)})),-1!==l&&s.splice(l,1),s.unshift({relation:null,soundIndex:a,isFlat:!1,adjustOctave:0}),s.sort((function(e,n){return e.soundIndex-n.soundIndex}));var d=-1;s.some((function(e,n){null!=e.relation||(d=n)}));for(var b=s[d].soundIndex,u=[],h=d;h<s.length;h++){var p=s[h];u.push(p)}for(var x=0;x<d;x++){var f=s[x];u.push(f)}u.forEach((function(e){e.adjustOctave=0,e.soundIndex<b&&(e.adjustOctave=1)})),s=u}return[c,s]},e.getInitialRecord=function(e){return new Array(e).fill(null)},e.buildVoicsFromTable=function(e){for(var n=[],t=0;t<e.length;t++)for(var i=0;i<e[t].length;i++)e[t][i]&&n.push({octave:t,structIndex:i});return 0===n.length&&n.push({octave:-1,structIndex:0}),n},e.getVoicingListFromTable=function(e){var n=[];if(null!=e)for(var t=0;t<e.length;t++)for(var i=0;i<e[t].length;i++)e[t][i]&&n.push({octave:t,struct:i});return n},e.buildPatternProps=function(e){var n=e.channels.length,t=[];e.layers.forEach((function(e){var n=e.noteDivList,i=[];e.table.forEach((function(e,n){e.forEach((function(e,t){null!=e&&i.push({x:t,y:n,status:e})}))})),t.push({divs:n,notesList:i,vels:e.velocityList.slice()})}));var i=[];return e.pedalActs.forEach((function(e,n){null!=e&&i.push({divIndex:n,action:e})})),{channelSize:n,pedals:i,layers:t}},e.getChannels=function(e,n){for(var t=[],i=0;i<n;i++){var o={octave:-1,structIndex:0};i<e.length&&(o.octave=e[i].octave,o.structIndex=e[i].structIndex),t.push(o)}return t.reverse()},e.convertEditorLayerFromScore=function(e,n){var t=[];return n.forEach((function(n){for(var i=[],o=function(e){for(var t=[],o=function(i){var o=n.notesList.find((function(n){return n.x===i&&n.y===e}));t.push(null==o?null:o.status)},c=0;c<n.divs.length;c++)o(c);i.push(t)},c=0;c<e;c++)o(c);t.push({noteDivList:n.divs,table:i,velocityList:n.vels})})),t},e.getPitchListFromVoicing=function(e,n){return e.map((function(e){var t=n[e.struct];return 12*(e.octave+t.adjustOctave)+t.soundIndex}))},e.playBacking=function(e,n,t,i,o,c){if(null==i.pattern)o.forEach((function(n){var t=v.KEY12_SHARP_LIST[n%12],i=Math.floor(n/12);T(t+i,e,c/1e3,5)}));else{var a=t.bpm,r=4===v.getBeatProps(t.beatSignature).beatMemoriCount?1:2/3,s=i.pattern,l=[];s.layers.forEach((function(t,i){var d=0,b=t.divs.map((function(e){var n=6e4/a*d,t=4/e.rate*r;return e.isDot?t*=1.5:e.div3>0&&(t/=3*e.div3),d+=t,{start:n,sustain:6e4/a*t}}));0===i&&void 0!=s.pedals&&b.forEach((function(e,n){var t,i=null===(t=s.pedals)||void 0===t?void 0:t.find((function(e){if(n===e.divIndex)return e}));void 0!=i&&(l.length>0&&(l[l.length-1].end=e.start),l.push({start:e.start,end:c,action:i.action}))}));var u=[];t.notesList.forEach((function(i){if(void 0===u.find((function(e){if(e.x===i.x&&e.y===i.y)return e}))){var c=b[i.x],r=(void 0==i.status.timing?0:i.status.timing)*(6e4/a*1/32),s=c.start+r,d=c.sustain;"s"===i.status.signal?d*=.5:"t"===i.status.signal&&function(){for(var e=i.x,n=!0;n;){e++;var o=t.notesList.find((function(n){if(n.x===e&&n.y===i.y)return n}));void 0!=o&&(d+=b[e].sustain,u.push({x:e,y:i.y}),n="t"===o.status.signal)}}();for(var h=0;h<l.length;h++){var p=l[h],x=s+c.sustain;if("off"!==p.action&&x>p.start&&x<=p.end){d=p.end-s;break}}var f=void 0==i.status.velAdj?0:i.status.velAdj,g=t.vels[i.x]+f;g<1&&(g=1),g>10&&(g=10),g*=.6,n.push(setTimeout((function(){var n=o[i.y],t=v.KEY12_SHARP_LIST[n%12],c=Math.floor(n/12);T(t+c,e,d/1e3,g)}),s))}}))}))}},e.stopPreview=function(e,n,t,i){var o;null===(o=e.instruments.harmonyFont)||void 0===o||o.stop(),n.isPreview=!1,i.forEach((function(e){return clearInterval(e)})),t.backing.setState(n)},e.getLimitLen=function(e,n,t){var i=v.getBeatProps(t).beatMemoriCount;return e+(n.head/i+n.tail/i)};var n=e.getUsingLenFromDivs=function(e,n){var t=4/v.getBeatProps(n).beatMemoriCount;return e.reduce((function(e,n){var i=1/n.rate*t;return n.isDot&&(i*=1.5),0!==n.div3&&(i*=n.div3/3),e+4*i}),0)},t=(e.getInitVoicingTable=function(e,n){for(var t=new Array(8),i=function(i){t[i]=new Array(6);for(var o=t[i],c=function(o){if(o>=n)return"continue";var c=e.find((function(e){if(e.octave===i&&e.struct===o)return e}));t[i][o]=null!=c},a=0;a<o.length;a++)c(a)},o=0;o<t.length;o++)i(o);return t},e.getEditorPatternFromChordBacking=function(e,n){var t=null;if(null!=n){var i=j.buildVoicsFromTable(e),o=j.getChannels(i,n.channelSize),c=j.convertEditorLayerFromScore(n.channelSize,n.layers),a=[];if(void 0!=n.pedals)for(var r=function(e){var t=n.pedals.find((function(n){if(n.divIndex===e)return n}));void 0==t?a.push(null):a.push(t.action)},s=0;s<n.layers[0].divs.length;s++)r(s);else for(var l=0;l<n.layers[0].divs.length;l++)0===l?a.push("on"):a.push(null);t={channelIndex:-1,lenIndex:0,mode:"velocity",layerIndex:0,channels:o,layers:c,pedalActs:a}}return t},e.hasBackingError=function(e,t,i){var o=e.backing,c=e.backing.voicingList,a=o.pattern,r=!1;if(c.some((function(e){if(e.struct>i-1)return r=!0,!0})),null!=a){var s=j.getLimitLen(e.beatLen,e.minute,t);a.layers.forEach((function(e){var i=n(e.divs,t);s<i&&(r=!0)}))}return r},e.checkEditorError=function(e,i,o){var c=!1;if(null!=o){i.length<o.channels.length&&(c=!0);var a=j.getLimitLen(e.beatLen,e.minute,e.init.beatSignature);o.layers.forEach((function(t){var i=n(t.noteDivList,e.init.beatSignature);a<i&&(c=!0)})),o.layers[0].table.forEach((function(e,n){e.forEach((function(e,i){null!=e&&t(o.layers,0,n,i)&&(c=!0)}))}))}return c},e.checkOverlapBackLayer=function(e,n,t,o){for(var c=e[n],a=e[0===n?1:0],r=i(c.noteDivList,o),s=Object(l.a)(r,2),d=s[0],b=s[1],u=!1,h=0;h<a.noteDivList.length;h++)if(null!=a.table[t][h]){var p=i(a.noteDivList,h),x=Object(l.a)(p,2),f=x[0],g=x[1];if(b>f&&d<g){u=!0;break}}return u}),i=e.getDivRange=function(e,n){var t=0,i=0;return e.slice(0,n+1).forEach((function(e,n){var o=1/e.rate;e.isDot&&(o*=1.5),0!==e.div3&&(o*=e.div3/3),t=i,i+=4*o})),[t,i]};e.isPermitDot=function(e){return[8,4,2].includes(e.rate)&&0===e.div3},e.isPermit3ren=function(e){return[8,4].includes(e.rate)&&!e.isDot}}(j||(j={}));var m,O=j;!function(e){e.updateHarmonizeCache=function(e,t){var i=e.scoreData.chordList,o=e.scoreState,c=i[0].detail,a=[],r=[],s=[],l=[],d=[],b=[],u=c.keyIndex,h=c.scale,p=c.bpm,x=0,f=-1,g=0,j=0,m=0,O=-1,k=0,y=0,S=0,w=0,L=0,I=0,A=-1,E=c.beatSignature,C=0,T=0,M=function(){d.push({bpm:p,beatRate:D.beatMemoriCount/4,memoriCnt:T}),T=0},D=v.getBeatProps(E);i.forEach((function(e,n){var t=L,o=S,c=y,d=x;switch(e.type){case"fixed":"End"===e.detail.fixed&&(j+=m);break;case"section":var N=e.detail;r.push({labelName:N.labelName,beatSum:0,rangeIndexStart:n,rangeIndexEnd:i.length-2}),++f>0&&(r[f-1].rangeIndexEnd=n-1,r[f-1].beatSum=g,g=0);break;case"chord":j+=m;var F=e.detail;g+=F.beatLen;var _=F.minute.head+F.minute.tail;x+=_,O++,k=F.beatLen*D.beatMemoriCount+_;var z=Math.floor(L/D.barBeatCnt);L+=F.beatLen,z!==Math.floor(L/D.barBeatCnt)&&y++,C+=k,T+=k,m=v.calcSustainMsec(F.beatLen,_,p,E);for(var R=0;R<k;R++){var B=16;w%D.beatMemoriCount===0?B=4:w%(D.beatMemoriCount/(D.beatMemoriCount/2))===0&&(B=8);var P=D.barBeatCnt*D.beatMemoriCount,K=-1;w%P===0&&(K=++I),b.push({rate:B,barCount:K}),S++,w++}A++;break;case"alter":var U=e.detail;switch(U.alterType){case"modulate":switch(l.push({keyIndex:u,scale:h,memoriCnt:C}),C=0,U.modRel){case"domm":u=(u+24+7*U.dommVal)%12;break;case"key":u=(u+12+U.keyAdj)%12;break;case"parallel":u=(u+12+3*("major"===h?-1:1))%12,h="major"===h?"minor":"major";break;case"relative":h="major"===h?"minor":"major"}break;case"tempo":switch(M(),U.tempoRel){case"diff":p+=U.tempoDiff;break;case"rate":p=Math.floor(1*p*(U.tempoRate/100));break;case"abs":p=U.tempoAbs}break;case"beat":M(),s.push({beatSignature:E,memoriCnt:w}),E=U.beatSignature,L=0,w=0,D=v.getBeatProps(E)}}a.push({bar:c,surplusBeat:t%D.barBeatCnt,minute:d,keyIndex:u,scale:h,bpm:p,beatSignature:E,sectionNo:f,pastSecond:j,chordIndex:O,curTotalMemori:o,chordBlockNo:A,reffers:{}})})),r[f].beatSum=g,l.push({keyIndex:u,scale:h,memoriCnt:C}),s.push({beatSignature:E,memoriCnt:w}),M(),o.elementCacheList=a,o.sectionCacheList=r,o.beatCacheList=s,o.tempoCacheList=d,o.scaleCacheList=l,o.measureCacheList=b,o.chordCacheList=n(i,a),t.score.setScoreState(o)};var n=e.createChordCacheList=function(e,n){var t=[];return e.forEach((function(e,i){if("chord"===e.type){var o=e.detail,c=n[i],a=c.keyIndex,r=v.getSymbolFromKey(o.symbolKey),s=null!=o.root?O.getChordDetails(o.root,a,o.on,r):["",[]],d=Object(l.a)(s,2),b=d[0],u=d[1],h=O.hasBackingError(o,c.beatSignature,u.length);t.push({structList:u,chordFullName:b,backingError:h})}})),t};e.getKeyScaleFromNotesPos=function(e,n){for(var t=4*e,i=0,o=null,c=0;c<n.length;c++){var a=n[c];if(t<i){o=n[c-1];break}i+=a.memoriCnt}return null===o?n[n.length-1]:o},e.getTimeInfoFromNotesPos=function(e,n,t){for(var i=4*e,o=0,c=0,a=0,r=null,s=0;s<t.length;s++){var l=t[s];if(i<o){r=t[s-1];break}var d=l.memoriCnt/4;c+=60/l.bpm*d,a+=d,o+=l.memoriCnt}null===r&&(r=t[t.length-1]);var b=(e-a)*r.beatRate;return[c+=60/r.bpm*b,60/r.bpm*n*r.beatRate]}}(m||(m={}));var k,y=m,S=function(e){return(59-e+9)%12},w=function(e){var n,t,i,o,c,a,r=0;return r+=null!==(n=e.len4)&&void 0!==n?n:0,r+=(null!==(t=e.len8)&&void 0!==t?t:0)/2,r+=(null!==(i=e.len16)&&void 0!==i?i:0)/4,r+=(null!==(o=e.len32)&&void 0!==o?o:0)/8,r+=(null!==(c=e.len4div3)&&void 0!==c?c:0)/3,r+=(null!==(a=e.len8div3)&&void 0!==a?a:0)/6},L=function(e,n){var t,i,o,c,a,r,s,l,d,b,u,h,p={},x=(null!==(t=e.len4)&&void 0!==t?t:0)+(null!==(i=n.len4)&&void 0!==i?i:0);x>0&&(p.len4=x);var f=(null!==(o=e.len8)&&void 0!==o?o:0)+(null!==(c=n.len8)&&void 0!==c?c:0);f>0&&(p.len8=f);var g=(null!==(a=e.len16)&&void 0!==a?a:0)+(null!==(r=n.len16)&&void 0!==r?r:0);g>0&&(p.len16=g);var j=(null!==(s=e.len32)&&void 0!==s?s:0)+(null!==(l=n.len32)&&void 0!==l?l:0);j>0&&(p.len32=j);var v=(null!==(d=e.len4div3)&&void 0!==d?d:0)+(null!==(b=n.len4div3)&&void 0!==b?b:0);v>0&&(p.len4=v);var m=(null!==(u=e.len8div3)&&void 0!==u?u:0)+(null!==(h=n.len8div3)&&void 0!==h?h:0);return m>0&&(p.len8div3=m),I(p)},I=function(e){var n,t,i,o,c,a,r=null!==(n=e.len4)&&void 0!==n?n:0,s=null!==(t=e.len8)&&void 0!==t?t:0,l=null!==(i=e.len16)&&void 0!==i?i:0,d=null!==(o=e.len32)&&void 0!==o?o:0,b=null!==(c=e.len4div3)&&void 0!==c?c:0,u=null!==(a=e.len8div3)&&void 0!==a?a:0,h={},p=Math.floor(d/2);d-=2*p,l+=p;var x=Math.floor(u/3);u-=3*x,s+=x;var f=Math.floor(u/2);u-=2*f,b+=f;var g=Math.floor(b/3);b-=3*g,r+=g;var j=Math.floor(l/2);l-=2*j,s+=j;var v=Math.floor(s/2);return s-=2*v,(r+=v)>0&&(h.len4=r),s>0&&(h.len8=s),l>0&&(h.len16=l),d>0&&(h.len32=d),b>0&&(h.len4div3=b),u>0&&(h.len8div3=u),h},A=function(e,n){var t=0,i=0,o=0,c=0,a=0,r=0;switch(e){case 1:t=n;break;case 2:i=n;break;case 3:a=n;break;case 4:o=n;break;case 8:c=n;break;case 6:r=n}var s={};return t>0&&(s.len4=t),i>0&&(s.len8=i),o>0&&(s.len16=o),c>0&&(s.len32=c),a>0&&(s.len4div3=a),r>0&&(s.len8div3=r),I(s)},E=function(e){var n,t,i,o,c,a;return(null!==(n=e.len32)&&void 0!==n?n:0)>0?8:(null!==(t=e.len8div3)&&void 0!==t?t:0)>0?6:(null!==(i=e.len16)&&void 0!==i?i:0)>0?4:(null!==(o=e.len4div3)&&void 0!==o?o:0)>0?3:(null!==(c=e.len8)&&void 0!==c?c:0)>0?2:(null!==(a=e.len4)&&void 0!==a?a:0)>0?1:0},C=function(e,n){var t=(59-e+9)%12,i=Math.floor((59-e+9)/12)+1,o=v.KEY12_SHARP_LIST[t%12],c=n.instruments.melodyFont;null!=c&&(c.stop(),c.play(o+i,0,{duration:.5}))},T=function(e,n,t,i){var o=n.instruments.harmonyFont;null!=o&&o.play(e,0,{gain:i,duration:t})};!function(e){var n=e.stopPreview=function(e,n,t){var i=e.melodyState;i.isPreview=!1,t.forEach((function(e){return clearInterval(e)})),n.melody.setState(i),n.melody.adjustScrollX()},t=(e.previewStart=function(e,i){var o=e.melodyState,c=e.scoreState,a=e.scoreData,r=[],s=e.instruments.melodyFont,d=-1===o.focusIndex?0:o.focusIndex;o.lastFocus=o.focusIndex,o.isPreview=!0;for(var b=e.invalidate.melody,u=-1,h=function(t){var d=a.notesList[t],h=w(d.pos),p=w(d.len),x=y.getTimeInfoFromNotesPos(h,p,c.tempoCacheList),f=Object(l.a)(x,2),g=f[0],j=f[1],m=d.pitchIndex;-1===u&&(u=-1===o.focusIndex?0:g);var O=S(m),k=v.KEY12_SHARP_LIST[O%12],L=Math.floor((59-m+9)/12)+1;r.push(setTimeout((function(){null!=s&&(s.stop(),s.play(k+L,0,{duration:j})),setTimeout((function(){o.focusIndex=t,o.destIndex=o.focusIndex,b(),i.melody.adjustScrollX()}),0)}),1e3*(g-u))),t===a.notesList.length-1&&r.push(setTimeout((function(){n(e,i,r)}),1e3*(g-u+j)))},p=d;p<a.notesList.length;p++)h(p);o.isSolo||t(1e3*u,e,i,r),i.system.setReserveTasks(r),i.melody.setState(o)},function(e,n,t,i){for(var o=n.scoreState,c=n.invalidate.melody,a=o.elementCacheList,r=n.scoreData.chordList,s=function(t){var o=a[t],s=n.scoreState.chordCacheList[o.chordBlockNo],l=r[t];if("chord"===l.type){if(o.pastSecond<e)return"continue";var d=l.detail;if(null==d.root)return{v:void 0};var b=d.backing,u=O.getPitchListFromVoicing(b.voicingList,s.structList),h=d.minute.head+d.minute.tail,p=v.calcSustainMsec(d.beatLen,h,o.bpm,o.beatSignature);i.push(setTimeout((function(){O.playBacking(n,i,o,b,u,p),setTimeout((function(){n.melodyState.tableMouse.curChord=l,c()}),0)}),o.pastSecond-e-0))}},l=3;l<r.length;l++){var d=s(l);if("continue"!==d&&"object"===typeof d)return d.v}});e.previewCurHarmony=function(e,n){var t=e.melodyState,i=e.scoreData.chordList,o=e.scoreState.elementCacheList[3],c=e.scoreState.chordCacheList[o.chordBlockNo],a=i[0].detail,r=t.tableMouse.curChord,s=e.reserveTasks;if(null!=r){var l=r.detail;if(null==l.root)return;var d=l.backing,b=O.getPitchListFromVoicing(d.voicingList,c.structList),u=l.minute.head+l.minute.tail,h=v.calcSustainMsec(l.beatLen,u,a.bpm,a.beatSignature);O.playBacking(e,s,a,d,b,h),s.push(setTimeout((function(){t.isPreview=!1,n.melody.setState(t)}),h)),t.isPreview=!0,n.melody.setState(t)}},e.isEnableQuantize=function(e,n){}}(k||(k={}));var M,D,N=k;(D=M||(M={})).AUTH_TEXT_WIDTH=350,D.AUTH_TEXT_HEIGHT=70;var F,_,z,R,B,P,K,U,V,q,H,J,W,Y,G,Q,X,Z,$,ee,ne=M,te=100,ie=30,oe=50,ce=240,ae=480,re=t(12),se=t(1),le=function(e){var n,t=Object(o.useState)(e.activeNo),i=Object(l.a)(t,2),c=i[0],a=i[1],r=null!==(n=e.tabRecordNum)&&void 0!==n?n:1;return Object(o.useEffect)((function(){a(e.activeNo)}),[e.activeNo]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(ue,{tabRecordNum:r,children:e.tabElements.map((function(n,t){return Object(se.jsx)(de,{name:n.name,isActive:t==c,isDisable:n.disable,selectTab:function(){return function(n){void 0!=e.selectTabIndex?e.selectTabIndex(n):a(n)}(t)}},t)}))}),Object(se.jsx)(he,{tabRecordNum:r,children:e.tabElements.map((function(e,n){return Object(se.jsx)(be,{cont:e.cont,isActive:n===c},n)}))})]})},de=function(e){return Object(se.jsx)(xe,{isDisable:e.isDisable,isActive:e.isActive,onClick:function(){return e.selectTab()},children:e.name})},be=function(e){return Object(se.jsx)(pe,{isActive:e.isActive,children:e.cont})},ue=d.b.div(F||(F=Object(s.a)(["\n    display: inline-block;\n    height: ","px;\n    text-align: left;\n    /* background-color: #ac3b3b; */\n    width: 100%;\n"])),(function(e){return 35*e.tabRecordNum})),he=d.b.div(_||(_=Object(s.a)(["\n    display: block;\n    background-color: #999999;\n    height: calc(100% - ","px);\n    border-radius: 0 6px 6px 6px;\n    box-shadow: 0 2px 0 0 #000b3a48;\n    text-align: left;\n"])),(function(e){return 35*e.tabRecordNum})),pe=d.b.div(z||(z=Object(s.a)(["\n    margin: 3px 0 0 3px;\n    width: calc(100% - 6px);\n    height: calc(100% - 6px);\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(B||(B=Object(s.a)(["display: inline-block;"]))):Object(d.a)(R||(R=Object(s.a)(["display: none;"])))})),xe=d.b.div(P||(P=Object(s.a)(["\n    display: inline-block;\n    /* width: 100px; */\n    padding: 0 10px;\n    \n    ","\n    /* opacity: 0.7; */\n    user-select: none;\n    margin-right: 6px;\n    font-weight: 600;\n    box-sizing: border-box;\n    line-height: 30px;\n    vertical-align: bottom;\n    transition: padding 100ms;\n"])),(function(e){return e.isActive?Object(d.a)(K||(K=Object(s.a)(["\n                color: #ebebeb;\n                padding: 0 35px;\n                background-color: #999999;\n                height: 35px;\n                font-size: 24px;\n                border-radius: 3px 15px 0 0;\n                text-shadow: 1px 2px 3px #00000065;\n            "]))):Object(d.a)(U||(U=Object(s.a)(["\n                height: 100%;\n                color: #555;\n                /* background-color: #90909b; */\n                background: linear-gradient(to bottom, #999999, #7a7a7a);\n                height: 30px;\n                font-size: 18px;\n                margin-top: 5px;\n                border-radius: 3px 10px 0 0;\n                ","\n            "])),e.isDisable?Object(d.a)(V||(V=Object(s.a)(["\n                    pointer-events: none;\n                    opacity: 0.7;\n                "]))):"")}));!function(e){var n=e.FONT_SMALL=16,t=e.FONT_MIDIUM=22,i=(e.FONT_LARGE=32,e.CSS_LABEL=Object(d.a)(Q||(Q=Object(s.a)(["\n        display: inline-block;\n        font-weight: 600;\n        text-align: center;\n        color: black;\n        box-sizing: border-box;\n    "]))));e.CSS_LABEL_SMALL=Object(d.a)(X||(X=Object(s.a)(["\n        ","\n        height: 22px;\n        font-size: ","px;\n        line-height: 18px;\n    "])),i,n),e.CSS_LABEL_MIDIUM=Object(d.a)(Z||(Z=Object(s.a)(["\n        ","\n        height: 30px;\n        font-size: ","px;\n        line-height: 26px;\n    "])),i,t),e.CSS_BUTTON_DISABLE=Object(d.a)($||($=Object(s.a)(["\n        pointer-events: none;\n        opacity: 0.5;\n    "])))}(ee||(ee={}));var fe,ge,je,ve,me,Oe,ke,ye,Se,we,Le,Ie,Ae,Ee,Ce,Te,Me,De,Ne,Fe,_e,ze,Re,Be=ee,Pe=(d.b.div(q||(q=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n"]))),d.b.div(H||(H=Object(s.a)(["\n    display: inline-block;\n"]))),d.b.div(J||(J=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n"]))),Object(d.a)(W||(W=Object(s.a)(["\n    display: inline-block;\n    height: 22px;\n    font-size: 18px;\n    font-weight: 600;\n    color: black;\n    line-height: 18px;\n"])))),Ke=Object(d.a)(Y||(Y=Object(s.a)(["\n    display: inline-block;\n    height: 30px;\n    font-size: ","px;\n    font-weight: 600;\n    text-align: center;\n    color: black;\n    line-height: 24px;\n    box-sizing: border-box;\n"])),ee.FONT_MIDIUM),Ue=Object(d.a)(G||(G=Object(s.a)(["\n    opacity: 0.6;\n    pointer-events: none;\n"])));(Re=ze||(ze={})).InputTextForm=function(e){var n,t,i,c,a,r,s,l=null!==(n=e.isPassword)&&void 0!==n&&n?"password":"text",d=null!==(t=e.validates)&&void 0!==t?t:[],b=e.checkable.errors,u=(null!==(i=e.dependency)&&void 0!==i?i:[]).map((function(e){return e.value})),p=function(e){var n=[];return d.forEach((function(t){t.checker(e)||n.push(t.errorType)})),n};return Object(o.useEffect)((function(){e.checkable.errors=p(e.checkable.value),e.setCheckable(Object(h.a)({},e.checkable))}),u),Object(se.jsxs)(Je,{isEnable:null===(c=e.isEnable)||void 0===c||c,textAlign:null!==(a=e.isCenter)&&void 0!==a&&a?"center":"left",marginTop:null!==(r=e.marginTop)&&void 0!==r?r:0,children:[void 0==e.titleLabel?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(We,{children:e.titleLabel}),Object(se.jsx)(Ye,{type:l,value:e.checkable.value,hasTitle:void 0!=e.titleLabel,width:e.width,isCenter:null!==(s=e.isCenter)&&void 0!==s&&s,placeholder:e.placeholder,onChange:function(n){var t=n.target.value;e.checkable.value=t,e.checkable.errors=p(t),e.setCheckable(Object(h.a)({},e.checkable))},errorType:0===b.length?void 0:b[0],readOnly:e.isReadOnly})]})},Re.ButtonRecord=function(e){var n,t;return Object(se.jsx)(Je,{isEnable:!0,textAlign:null!==(n=e.isCenter)&&void 0!==n&&n?"center":"right",marginTop:null!==(t=e.marginTop)&&void 0!==t?t:0,children:e.buttons.map((function(n,t){var i,o;return Object(se.jsx)(Qe,{isCenter:null!==(i=e.isCenter)&&void 0!==i&&i,isEnable:null===(o=n.isEnable)||void 0===o||o,onClick:n.callback,children:n.label},t)}))})},Re.Message=function(e){var n,t,i;return Object(se.jsx)(Je,{isEnable:!0,textAlign:null!==(n=e.isCenter)&&void 0!==n&&n?"center":"left",marginTop:null!==(t=e.marginTop)&&void 0!==t?t:0,children:Object(se.jsx)(Ge,{isCenter:null!==(i=e.isCenter)&&void 0!==i&&i,children:e.message})})},Re.MessageLink=function(e){var n,t,i;return Object(se.jsx)(Je,{isEnable:!0,textAlign:null!==(n=e.isCenter)&&void 0!==n&&n?"center":"left",marginTop:null!==(t=e.marginTop)&&void 0!==t?t:0,children:Object(se.jsx)(Ge,{isLink:!0,onClick:e.clickAction,isCenter:null!==(i=e.isCenter)&&void 0!==i&&i,children:e.message})})},Re.BorderPanel=function(e){var n;return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Xe,{children:e.title}),Object(se.jsx)(Ze,{isEnable:null===(n=e.isEnable)||void 0===n||n,children:e.innerJsx})]})},Re.InfoFrame=function(e){var n,t=null!==(n=e.height)&&void 0!==n?n:70;return Object(se.jsx)(se.Fragment,{children:Object(se.jsx)($e,{height:t,color:"#1a9900",children:e.textRecords.map((function(e,n){return Object(se.jsxs)("span",{children:[e,Object(se.jsx)("br",{})]},n)}))})})};var Ve,qe,He=ze,Je=d.b.div(fe||(fe=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    margin-top: ","px;\n    /* background-color: #b3b4c4; */\n    /* border: 1px solid #000; */\n    ","\n    text-align: ",";\n"])),(function(e){return e.marginTop}),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}),(function(e){return e.textAlign})),We=d.b.div(ge||(ge=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: 140px;\n    ","\n    color: #585858;\n    border: solid 1px #7a7a7abf;\n    box-sizing: border-box;\n    /* background-color: #85a2c5; */\n    background: linear-gradient(to bottom, #c3c3c3fc, #d8d8d8, #c3c3c3fc);\n    border-radius: 4px;\n    text-align: center;\n    vertical-align: top;\n    margin: 5px 4px 0 4px;\n"])),Be.CSS_LABEL_MIDIUM),Ye=d.b.input(je||(je=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    ","\n    ","\n    margin-top: 2px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #3d3d3d;\n    border: solid 1px #959595;\n    border-radius: 4px;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: ",";\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n    /* "," */\n    ","\n    ::placeholder {\n        color: #00000050;\n        font-style: italic;\n    }\n"])),(function(e){return e.hasTitle?Object(d.a)(me||(me=Object(s.a)(["\n        width: calc(100% - 152px);\n    "]))):Object(d.a)(ve||(ve=Object(s.a)(["\n    "])))}),(function(e){return void 0==e.width?"":Object(d.a)(Oe||(Oe=Object(s.a)(["\n        width: ","px;\n    "])),e.width)}),(function(e){if(void 0==e.errorType)return"#ececec";switch(e.errorType){case"required":return"#dbd7b3";case"length":return"#dbb3b3";case"value":return"#b3b3db";case"relation":return"#b3dbb3"}}),(function(e){return e.isCenter?Object(d.a)(ye||(ye=Object(s.a)([""]))):Object(d.a)(ke||(ke=Object(s.a)(["\n        margin-left: 4px;\n    "])))}),(function(e){return e.readOnly?Object(d.a)(Se||(Se=Object(s.a)(["\n        color: #020075;\n        /* border: none; */\n        outline: none;\n        background-color: transparent;\n    "]))):""})),Ge=(d.b.select(we||(we=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 150px);\n    margin-top: 2px;\n    margin-left: 4px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #1f1f1f;\n    border: solid 1px #000;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n"]))),d.b.div(Le||(Le=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    margin-top: 2px;\n    font-size: ","px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #002c52;\n    border-radius: 4px;\n    padding: 0 5px;\n    box-sizing: border-box;\n    /* background-color: #d37878; */\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n    ","\n    ","\n"])),Be.FONT_MIDIUM,(function(e){return e.isCenter?Object(d.a)(Ae||(Ae=Object(s.a)([""]))):Object(d.a)(Ie||(Ie=Object(s.a)(["\n        margin-left: 4px;\n    "])))}),(function(e){return e.isLink?Object(d.a)(Ee||(Ee=Object(s.a)(["\n        color: #0459a3;\n        user-select: none;\n        text-decoration: underline;\n        &:hover {\n            color: #68a4d8;\n        }\n    "]))):""}))),Qe=(d.b.div(Ce||(Ce=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    /* background-color: #888888; */\n    box-sizing: border-box;\n    text-align: left;\n    white-space: nowrap;\n"]))),d.b.div(Te||(Te=Object(s.a)(["\n    ","\n    /* width: 160px; */\n    padding: 0 40px;\n    /* line-height: 25px; */\n    box-sizing: border-box;\n    /* background-color: #a8a8a8; */\n    background: linear-gradient(to bottom, #cdcdcd, #ebebeb, #cdcdcd);\n    border: 1px solid #747474;\n    color: #515151;\n    border-radius: 4px;\n    ","\n    margin-top: 2px;\n    margin: 5px 0 0 4px;\n    ","\n    &:hover {\n        /* background-color: #98bfc2; */\n    background: linear-gradient(to bottom, #989898, #b4b4b4, #989898);\n    }\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isCenter?Object(d.a)(De||(De=Object(s.a)([""]))):Object(d.a)(Me||(Me=Object(s.a)(["\n        margin-left: 4px;\n    "])))}),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}))),Xe=d.b.div(Ne||(Ne=Object(s.a)(["\n    ","\n    color: #990000;\n    /* background-color: #0a0a0a40; */\n    font-style: italic;\n    margin: 4px 0 0 8px;\n"])),Be.CSS_LABEL_SMALL),Ze=d.b.div(Fe||(Fe=Object(s.a)(["\n    display: inline-block;\n    margin: 0 0 0 6px;\n    padding: 4px;\n    width: calc(100% - 12px);\n    background-color: #dcddce;\n    border: 1px solid #000;\n    box-sizing: border-box;\n    border-radius: 4px;\n    text-align: left;\n    ","\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),$e=d.b.div(_e||(_e=Object(s.a)(["\n    margin: 4px 0 0 0;\n    display: inline-block;\n    background-color: #e7e5e561;\n    border: solid 1px #949494;\n    width: 100%;\n    height: ","px;\n    padding: 2px;\n    box-sizing: border-box;\n    text-align: left;\n    font-size: ","px;\n    color: ",";\n    overflow-y: auto;\n"])),(function(e){return e.height}),Be.FONT_SMALL,(function(e){return e.color}));(qe=Ve||(Ve={})).checkRequired=function(e){return e.length>0},qe.checkStringLength=function(e,n,t){return 0===e.length||e.length>=n&&e.length<=t},qe.checkAsciiChars=function(e){for(var n=0;n<e.length;n++){var t=e.charAt(n);if(-1==="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(t))return!1}return!0},qe.checkAll=function(e){for(var n=!0,t=0;t<e.length;t++)if(!e[t]){n=!1;break}return n};var en,nn,tn,on,cn=Ve;(on||(on={})).Component=function(e){var n,t,i,c=Object(o.useContext)(gS).dispatcher,a=null!==(n=e.width)&&void 0!==n?n:600,r=null!==(t=e.height)&&void 0!==t?t:150,s=null!==(i=e.buttons)&&void 0!==i?i:[{label:"OK",callback:function(){c.system.closeDialog()}}];return Object(se.jsxs)(pn,{width:a,height:r,children:[Object(se.jsx)(xn,{children:Object(se.jsx)(fn,{children:e.message.split("\n").map((function(e,n){return Object(se.jsx)(He.Message,{message:e,isCenter:!0},n)}))})}),Object(se.jsx)(He.ButtonRecord,{isCenter:!0,buttons:s})]})};var an,rn,sn,ln,dn,bn,un,hn=on,pn=d.b.div(en||(en=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 11;\n    top: calc(50% - ","px);\n    left: calc(50% - ","px);\n    width: ","px;\n    height: ","px;\n    background-color: #e7e7e7e2;\n    border: 1px solid #8f8f8f;\n    border-radius: 4px;\n    box-shadow: 10px 15px 15px #0000004b;\n"])),(function(e){return e.height/2}),(function(e){return e.width/2}),(function(e){return e.width}),(function(e){return e.height})),xn=d.b.div(nn||(nn=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 110px;\n    display: flex;\n    align-items: center;\n\n"]))),fn=d.b.div(tn||(tn=Object(s.a)(["\n    /* text-align: center; */\n    display: inline-block;\n    width: 100%;\n    /* background-color: #bb6868e1; */\n"]))),gn=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=Object(o.useState)(0),c=Object(l.a)(i,2),a=c[0],r=c[1],s=Object(o.useState)({value:"",errors:[]}),d=Object(l.a)(s,2),b=d[0],u=d[1],p=Object(o.useState)({value:"",errors:[]}),x=Object(l.a)(p,2),f=x[0],g=x[1],j=Object(o.useState)({value:"",errors:[]}),v=Object(l.a)(j,2),m=v[0],O=v[1],k=Object(o.useState)({value:"",errors:[]}),y=Object(l.a)(k,2),S=y[0],w=y[1],L=Object(o.useState)({value:"",errors:[]}),I=Object(l.a)(L,2),A=I[0],E=I[1],C=Object(o.useState)([]),T=Object(l.a)(C,2),M=T[0],D=T[1],N=Object(o.useState)([]),F=Object(l.a)(N,2),_=F[0],z=F[1],R=Object(o.useState)(!1),B=Object(l.a)(R,2),P=B[0],K=B[1],U=n.userEnv.login,V=function(){u(Object(h.a)(Object(h.a)({},b),{},{value:U.id})),O(Object(h.a)(Object(h.a)({},m),{},{value:""})),w(Object(h.a)(Object(h.a)({},S),{},{value:""})),E(Object(h.a)(Object(h.a)({},A),{},{value:U.email})),g(Object(h.a)(Object(h.a)({},f),{},{value:U.password}))};Object(o.useEffect)((function(){re.a.findUserInfoList().then((function(e){var n=[],t=[];e.forEach((function(e){e.id!==U.id&&n.push(e.id),""!==e.email&&t.push(e.email)})),D(n),z(t)}));var e=re.a.getHashedFromUserSeq(U.seq);return window.history.replaceState("","","/#/user?v=".concat(e)),V(),function(){window.history.replaceState("","","/#/")}}),[]);var q=Object(se.jsxs)(kn,{children:[Object(se.jsx)(He.InputTextForm,{titleLabel:"user id",checkable:b,setCheckable:u,validates:[{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return cn.checkAsciiChars(e)},errorType:"value"},{checker:function(e){return!M.includes(e)},errorType:"relation"}],width:300,marginTop:5,isReadOnly:!P}),Object(se.jsx)(He.InputTextForm,{titleLabel:"new pass",isPassword:!0,checkable:m,setCheckable:O,validates:[{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return e===S.value},errorType:"relation"}],dependency:[S],width:300,marginTop:5,isReadOnly:!P}),Object(se.jsx)(He.InputTextForm,{titleLabel:"new pass*",isPassword:!0,checkable:S,setCheckable:w,validates:[{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return e===m.value},errorType:"relation"}],dependency:[m],width:300,marginTop:5,isReadOnly:!P}),Object(se.jsx)(He.InputTextForm,{titleLabel:"email",checkable:A,setCheckable:E,validates:[{checker:function(e){return cn.checkStringLength(e,4,40)},errorType:"length"},{checker:function(e){return 0===e.length||2===e.split("@").length},errorType:"value"},{checker:function(e){return!_.includes(e)},errorType:"relation"}],marginTop:5,isReadOnly:!P}),Object(se.jsx)(He.InputTextForm,{titleLabel:"old pass",isPassword:!0,checkable:f,setCheckable:g,validates:[{checker:function(e){return e===U.password},errorType:"relation"}],width:300,marginTop:55,isReadOnly:!P})]}),H=0===b.errors.length&&0===m.errors.length&&0===S.errors.length&&0===A.errors.length&&0===f.errors.length;return Object(se.jsxs)(jn,{width:750,height:600,children:[Object(se.jsx)(vn,{children:Object(se.jsx)(He.Message,{message:"If you bookmark this page, you can easily login by URL."})}),Object(se.jsx)(mn,{children:Object(se.jsx)(le,{tabElements:[{name:"User",disable:!1,cont:q},{name:"Security",disable:!1,cont:Object(se.jsx)(se.Fragment,{})}],activeNo:a,selectTabIndex:function(e){return r(e)}})}),Object(se.jsx)(On,{children:Object(se.jsx)(He.ButtonRecord,{buttons:[{label:"Close",callback:function(){t.system.closeDialog()}},{label:"Cancel",isEnable:P,callback:function(){K(!1),V()}},{label:P?"Regist":"Modify",isEnable:!P||H,callback:function(){P?function(){var e=0===m.value.length?"":",password = '".concat(m.value,"'");re.a.sendQueryRequestToAPI("update","UPDATE user_tbl SET id = '".concat(b.value,"', email = '").concat(A.value,"'").concat(e,"\n            WHERE seq = ").concat(null===U||void 0===U?void 0:U.seq)).then((function(){U.id=b.value,m.value.length>0&&(U.password=m.value),U.email=A.value,t.system.setUserEnv(Object(h.a)(Object(h.a)({},n.userEnv),{},{login:Object(h.a)({},U)})),t.system.setDialog(Object(se.jsx)(hn.Component,{message:"Modify successful!"}))}))}():(K(!0),g(Object(h.a)(Object(h.a)({},f),{},{value:""})))}}]})})]})},jn=d.b.div(an||(an=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 11;\n    top: calc(50% - ","px);\n    left: calc(50% - ","px);\n    width: ","px;\n    height: ","px;\n    background-color: #e7e7e7eb;\n    border: 1px solid #9e9e9e;\n    border-radius: 4px;\n"])),(function(e){return e.height/2}),(function(e){return e.width/2}),(function(e){return e.width}),(function(e){return e.height})),vn=(d.b.div(rn||(rn=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 80px;\n    background-color: #eeeaea;\n    text-align: center;\n"]))),d.b.div(sn||(sn=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 50px;\n    /* background-color: #d1d1d1; */\n    /* text-align: center; */\n"])))),mn=d.b.div(ln||(ln=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: calc(100% - 100px);\n    padding: 4px;\n    box-sizing: border-box;\n    /* background-color: #d1d1d1; */\n    text-align: center;\n"]))),On=d.b.div(dn||(dn=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    padding: 6px 4px 0 0;\n    box-sizing: border-box;\n    width: 100%;\n    height: 50px;\n    background-color: #d1d1d1;\n    text-align: right;\n"]))),kn=d.b.div(bn||(bn=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    background-color: #cecece;\n"]))),yn=function e(n,t){var o=this;Object(x.a)(this,e),this.store=void 0,this.dispatch=void 0,this.system={setUserEnv:function(e){o.dispatch(i.SET_USER_ENV,{userEnv:e})},setState:function(e){o.dispatch(i.SET_SYSTEM_STATE,{systemState:e})},setDialog:function(e){o.store.systemState.dialog=e,o.system.setState(o.store.systemState)},closeDialog:function(){o.store.systemState.dialog=null,o.system.setState(o.store.systemState)},switchSplashToMain:function(){var e=o.store.systemState;e.isSplash=!1,o.dispatch(i.SET_SYSTEM_STATE,{systemState:e}),null!=o.store.userEnv.login&&o.system.setDialog(Object(se.jsx)(gn,{}))},setMainTabIndex:function(e){var n=o.store.systemState;n.mainChannelIndex=e,o.dispatch(i.SET_SYSTEM_STATE,{systemState:n})},setRefs:function(e){o.dispatch(i.SET_REFS,{refs:e})},setReserveTasks:function(e){o.dispatch(i.SET_RESERVE_TASKS,{reserveTasks:e})},setInvalidate:function(e){o.dispatch(i.SET_INVALIDATE,{invalidate:e})}},this.score={saveFile:function(){if(!(void 0!=o.store.systemState.directScore)){var e=o.store.scoreState,n=o.store.scoreData,t=e.fileHandle;null!=t?Object(p.a)(u.a.mark((function i(){var c,a;return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.createWritable();case 2:return c=i.sent,a=re.a.gZip(JSON.stringify(n)),i.next=6,c.write(a);case 6:return i.next=8,c.close();case 8:return e.fileHandle=t,o.score.setScoreState(Object(h.a)({},e)),i.next=12,t.getFile();case 12:i.sent,console.log("saved successfully!");case 14:case"end":return i.stop()}}),i)})))():window.showSaveFilePicker({types:[{accept:{"text/plain":[".lcrs"]}}]}).then((function(t){Object(p.a)(u.a.mark((function i(){var c,a;return u.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,t.createWritable();case 2:return c=i.sent,a=re.a.gZip(JSON.stringify(n)),i.next=6,c.write(a);case 6:return i.next=8,c.close();case 8:e.fileHandle=t,o.score.setScoreState(Object(h.a)({},e));case 10:case"end":return i.stop()}}),i)})))()})).catch((function(){console.log("\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f")}))}},setHarmonyFont:function(e){o.dispatch(i.SET_INSTRUMENTS,{instruments:Object(h.a)(Object(h.a)({},o.store.instruments),{},{harmony:e})})},setInstruments:function(e){o.dispatch(i.SET_INSTRUMENTS,{instruments:e})},setScoreTabIndex:function(e){var n=o.store.systemState;n.scoreTabIndex=e,o.dispatch(i.SET_SYSTEM_STATE,{systemState:n})},setScoreState:function(e){o.dispatch(i.SET_SCORE_STATE,{scoreState:e})},clearCache:function(){var e=o.store.scoreState;e.focusIndex=-1,e.distIndex=-1,e.initialBeat=4,e.elementCacheList=[],e.beatCacheList=[],e.chordCacheList=[],e.scaleCacheList=[],e.tempoCacheList=[],e.measureCacheList=[],e.sectionCacheList=[],o.dispatch(i.SET_SCORE_STATE,{scoreState:e})},setKeySwitch:function(e){var n=o.store.scoreState;n.keySwitch=e,o.score.setScoreState(n)},setScoreData:function(e){o.dispatch(i.SET_SCORE_DATA,{scoreData:e})},moveElement:function(e){var n=o.store.scoreState,t=e?1:-1;"fixed"!==o.store.scoreData.chordList[n.focusIndex+t].type&&(n.focusIndex+=t,n.distIndex=n.focusIndex,o.score.setScoreState(n))},moveDist:function(e){var n=o.store.scoreState,t=e?1:-1;"fixed"!==o.store.scoreData.chordList[n.distIndex+t].type&&(n.distIndex+=t,o.score.setScoreState(n))},releaseRange:function(e){var n=o.store.scoreState,t=n.focusIndex<n.distIndex?n.focusIndex:n.distIndex,i=n.focusIndex>n.distIndex?n.focusIndex:n.distIndex;n.focusIndex=e?i:t,n.distIndex=n.focusIndex,o.score.setScoreState(n)},moveSection:function(e){var n=o.store.scoreState,t=n.elementCacheList[n.focusIndex].sectionNo,i=n.sectionCacheList,c=i[t],a=o.store.scoreData.chordList[n.focusIndex].type;e?t<i.length-1?n.focusIndex=i[t+1].rangeIndexStart:n.focusIndex=c.rangeIndexEnd:n.focusIndex="section"===a&&t>0?i[t-1].rangeIndexStart:c.rangeIndexStart,n.distIndex=n.focusIndex,o.score.setScoreState(n)},flashElement:function(e){},incrementDegreeRoot:function(e){var n=o.store.scoreState,t=o.store.scoreData,i=t.chordList[n.focusIndex].detail,c=e?1:-1;null==i.root?e&&(i.root={index:0,isFlat:!1},o.score.setScoreData(t),o.score.flashElement(n.focusIndex)):i.root.index+c>=0&&i.root.index+c<=11?(i.root.index+=c,i.root.isFlat=!e&&![0,2,4,5,7,9,11].includes(i.root.index),o.score.setScoreData(t),o.score.flashElement(n.focusIndex)):i.root.index+c===-1&&(i.root=null,i.symbolKey="major",o.score.setScoreData(t),o.score.flashElement(n.focusIndex));var a=n.elementCacheList[n.focusIndex],r=n.chordCacheList[a.chordBlockNo];if(null!=i.root){var s=v.getSymbolFromKey(i.symbolKey),d=O.getChordDetails(i.root,a.keyIndex,i.on,s),b=Object(l.a)(d,2);r.chordFullName=b[0],r.structList=b[1]}else r.chordFullName="",r.structList=[];o.score.setScoreState(n)},incrementBeatLen:function(e){var n=o.store.scoreState,t=o.store.scoreData,i=t.chordList.slice(),c=i[n.focusIndex].detail,a=e?1:-1;c.beatLen+a>=1&&c.beatLen+a<=4&&(c.beatLen+=a,t.chordList=i,o.score.setScoreData(t),y.updateHarmonizeCache(o.store,o),o.score.flashElement(n.focusIndex))},incrementMinuteVal:function(e,n,t){var i=o.store.scoreData,c=i.chordList[e].detail,a=n?c.minute.tail:c.minute.head;(a+=t)>=-2&&a<=2&&(n?c.minute.tail=a:c.minute.head=a,i.chordList=i.chordList.slice(),o.score.setScoreData(i),y.updateHarmonizeCache(o.store,o))},incrementMinuteValRelation:function(e,n){var t=o.store.scoreState.focusIndex,i=o.store.scoreData.chordList,c=-1;if(e){for(var a=t+1;a<i.length-1;a++)if("chord"===i[a].type){c=a;break}}else for(var r=t-1;r>2;r--)if("chord"===i[r].type){c=r;break}-1!=c&&(o.score.incrementMinuteVal(t,e,n),o.score.incrementMinuteVal(c,!e,-n))},addChordElement:function(){var e=o.store.scoreState,n=o.store.scoreData,t=n.chordList[e.focusIndex],i=e.elementCacheList[e.focusIndex].beatSignature,c=v.getBeatProps(i).barBeatCnt;if("chord"===t.type){var a=t.detail;if(0!=a.minute.tail)return;c=a.beatLen}var r={type:"chord",detail:{beatLen:c,minute:{head:0,tail:0},root:null,on:null,symbolKey:"major",backing:{voicingList:[],pattern:null,hasError:!1}}};n.chordList.splice(e.focusIndex+1,0,r),o.score.setScoreData(n),y.updateHarmonizeCache(o.store,o)},addSectionElement:function(){var e=o.store.scoreState,n=o.store.scoreData;n.chordList.splice(e.focusIndex+1,0,{type:"section",detail:{labelName:"Section"}}),o.score.setScoreData(n),y.updateHarmonizeCache(o.store,o)},addAlterElement:function(){var e=o.store.scoreState,n=o.store.scoreData;n.chordList.splice(e.focusIndex+1,0,{type:"alter",detail:{alterType:null,modRel:null,dommVal:0,keyAdj:0,tempoRel:null,tempoDiff:0,tempoRate:1,tempoAbs:0,beatSignature:"4/4"}}),o.score.setScoreData(n),y.updateHarmonizeCache(o.store,o)},removeElement:function(){for(var e=o.store.scoreState,n=o.store.scoreData,t=e.focusIndex<e.distIndex?e.focusIndex:e.distIndex,i=e.focusIndex>e.distIndex?e.focusIndex:e.distIndex,c=t;c<=i;c++){var a=n.chordList[c],r=o.store.scoreState.elementCacheList[c].sectionNo;if("section"===a.type&&0===r)return}n.chordList.splice(t,i-t+1),o.score.setScoreData(n),e.focusIndex=t-1,e.distIndex=e.focusIndex,o.score.setScoreState(e),y.updateHarmonizeCache(o.store,o)},removeBacking:function(){for(var e=o.store.scoreState,n=o.store.scoreData,t=e.focusIndex<e.distIndex?e.focusIndex:e.distIndex,i=e.focusIndex>e.distIndex?e.focusIndex:e.distIndex,c=t;c<=i;c++){var a=n.chordList[c];if("chord"===a.type)a.detail.backing={voicingList:[],pattern:null}}o.score.setScoreData(n),o.score.setScoreState(Object(h.a)({},e)),y.updateHarmonizeCache(o.store,o)},copyElementList:function(){for(var e=o.store.scoreState,n=o.store.scoreData,t=e.focusIndex<e.distIndex?e.focusIndex:e.distIndex,i=e.focusIndex>e.distIndex?e.focusIndex:e.distIndex,c=[],a=t;a<=i;a++){var r=n.chordList[a];c.push(JSON.parse(JSON.stringify(r)))}console.log(c.length),e.copiedElementList=c,e.cloneBacking=null,o.score.setScoreState(e)},pasteElementList:function(){var e=o.store.scoreState,n=o.store.scoreData,t=e.copiedElementList;null!=t&&(console.log(t.length),t.forEach((function(t,i){n.chordList.splice(e.focusIndex+1+i,0,t)})),o.score.setScoreData(n),e.focusIndex++,e.distIndex=e.focusIndex+t.length-1,e.copiedElementList=null,o.score.setScoreState(e),y.updateHarmonizeCache(o.store,o))},setDiatonicChord:function(e,n){var t=o.store.scoreState,i=o.store.scoreData,c=i.chordList[t.focusIndex].detail,a=("major"===e?v.DIATONIC_MAJOR_SCALE_LIST:v.DIATONIC_MINOR_SCALE_LIST)[n],r=Object(h.a)({},a.root);c.root=r,c.symbolKey=a.symbolKey,c.on=null,o.score.setScoreData(i);var s=t.elementCacheList[t.focusIndex],d=t.chordCacheList[s.chordBlockNo],b=v.getSymbolFromKey(c.symbolKey),u=O.getChordDetails(r,s.keyIndex,null,b),p=Object(l.a)(u,2);d.chordFullName=p[0],d.structList=p[1],d.backingError=O.hasBackingError(c,s.beatSignature,d.structList.length),o.score.setScoreState(t)},setDefaultBacking:function(){var e=o.store.scoreState,n=o.store.scoreData,t=n.chordList[e.focusIndex].detail,i=v.getSymbolFromKey(t.symbolKey);void 0!=i.attr&&(t.backing=function(e){var n=[];switch(e){case"triad":n=[{struct:0,octave:3},{struct:1,octave:3},{struct:2,octave:3}];break;case"seventh":case"add9th":n=[{struct:0,octave:3},{struct:1,octave:3},{struct:2,octave:3},{struct:3,octave:3}]}return{voicingList:n,pattern:null}}(i.attr),o.score.setScoreData(n))},cloneBacking:function(){var e=o.store.scoreState,n=o.store.scoreData.chordList[e.focusIndex].detail;e.cloneBacking=JSON.parse(JSON.stringify(n.backing)),e.copiedElementList=null,o.score.setScoreState(e),console.log("clone backing! \n".concat(JSON.stringify(e.cloneBacking)))},pastBacking:function(){var e=o.store.scoreState;if(null!=e.cloneBacking){console.log("paste backing! \n".concat(JSON.stringify(e.cloneBacking)));var n=o.store.scoreData;n.chordList[e.focusIndex].detail.backing=JSON.parse(JSON.stringify(e.cloneBacking)),o.score.setScoreData(n)}},openLibraryWnd:function(e){var n=o.store.scoreState;if(e)n.hideMenu="preset";else{n.hideMenu="library";var t=o.store.scoreData.chordList[o.store.scoreState.focusIndex].detail,i=n.elementCacheList[n.focusIndex],c=n.chordCacheList[i.chordBlockNo],a=c.structList,r={symbolAttr:v.getSymbolFromKey(t.symbolKey).attr,chordFullName:c.chordFullName,structList:a,beatLen:t.beatLen,minute:t.minute,init:Object(h.a)({},i)};o.backing.setState({chordInfo:r,tabIndex:0,voicingTable:[],pattern:null,isPreview:!1,hasError:!1,closeAction:function(){}})}o.score.setScoreState(n)},closeLibraryWnd:function(){var e=o.store.scoreState;e.hideMenu="none",o.score.setScoreState(e)}},this.symbol={toNext:function(e){var n=o.store.scoreState,t=n.symbolMng,i=o.store.scoreData,c=i.chordList[n.focusIndex].detail,a=e?1:-1,r=t.index+a;if(r>=0&&r<=t.curLine.length-1){t.index+=a,c.symbolKey=t.curLine[t.index],o.score.setScoreData(i);var s=c.root,d=n.elementCacheList[n.focusIndex],b=n.chordCacheList[d.chordBlockNo],u=v.getSymbolFromKey(c.symbolKey),h=O.getChordDetails(s,d.keyIndex,c.on,u),p=Object(l.a)(h,2);b.chordFullName=p[0],b.structList=p[1],o.score.setScoreState(n)}},toBase:function(){var e=o.store.scoreState,n=e.symbolMng,t=o.store.scoreData,i=t.chordList[e.focusIndex].detail;if(n.parentLine.length>0){i.symbolKey=n.parentLine[0],o.score.setScoreData(t);var c=i.root,a=e.elementCacheList[e.focusIndex],r=e.chordCacheList[a.chordBlockNo],s=v.getSymbolFromKey(i.symbolKey),d=O.getChordDetails(c,a.keyIndex,i.on,s),b=Object(l.a)(d,2);r.chordFullName=b[0],r.structList=b[1],r.backingError=O.hasBackingError(i,a.beatSignature,r.structList.length),o.score.setScoreState(e)}},toDerive:function(){var e=o.store.scoreState,n=e.symbolMng,t=o.store.scoreData,i=t.chordList[e.focusIndex].detail;if(n.childrenLine.length>0){i.symbolKey=n.childrenLine[0],o.score.setScoreData(t);var c=i.root,a=e.elementCacheList[e.focusIndex],r=e.chordCacheList[a.chordBlockNo],s=v.getSymbolFromKey(i.symbolKey),d=O.getChordDetails(c,a.keyIndex,i.on,s),b=Object(l.a)(d,2);r.chordFullName=b[0],r.structList=b[1],r.backingError=O.hasBackingError(i,a.beatSignature,r.structList.length),o.score.setScoreState(e)}}},this.melody={setState:function(e){o.dispatch(i.SET_TUNE_STATE,{tuneState:e})},allSelect:function(){var e=o.store.melodyState,n=o.store.scoreData.notesList;n.length>0&&(e.focusIndex=0,e.destIndex=n.length-1,o.melody.setState(e))},setNotesList:function(e){var n=o.store.scoreData;n.notesList=e,o.score.setScoreData(n)},setMelodyFont:function(e){o.dispatch(i.SET_INSTRUMENTS,{instruments:Object(h.a)(Object(h.a)({},o.store.instruments),{},{soundfontPlayer:e})})},incrementCurPitch:function(e,n){var t=o.store.scoreState,i=o.store.melodyState,c=i.focusIndex,a=i.destIndex,r=o.store.scoreData.notesList;if(-1!==c)if(c!==a){r.filter((function(e,n){return n>=c&&n<=a})).forEach((function(n){n.pitchIndex+=1*(e?-1:1)})),i.dataHistory.add(JSON.stringify(o.store.scoreData.notesList)),o.melody.setNotesList(r.slice())}else{for(var s=r[c],l=w(s.pos),d=y.getKeyScaleFromNotesPos(l,t.scaleCacheList),b=("major"===d.scale?v.MAJOR_SCALE_INTERVALS:v.MINOR_SCALE_INTERVALS).map((function(e){return(d.keyIndex+e)%12})),u=s.pitchIndex,h="octave"!==n?1:12,p=s.pitchIndex;e?s.pitchIndex>0:s.pitchIndex<59;)if(p+=h*(e?-1:1),"scale"!==n||"scale"===n&&b.includes(S(p))){s.pitchIndex=p;break}u!==s.pitchIndex&&(C(s.pitchIndex,o.store),i.dataHistory.add(JSON.stringify(o.store.scoreData.notesList)),o.melody.setNotesList(r.slice()),o.melody.adjustScrollY())}},setKeySwitch:function(e){var n=o.store.melodyState;n.keySwitch=e,o.melody.setState(n)},moveFocus:function(e){var n=o.store.melodyState,t=o.store.scoreData.notesList;-1===n.focusIndex?t.length>0&&(n.focusIndex=n.lastFocus,n.destIndex=n.focusIndex,o.melody.setState(n)):(e?n.focusIndex<t.length-1:n.focusIndex>0)&&(n.focusIndex+=e?1:-1,n.destIndex=n.focusIndex,o.melody.setState(n)),o.melody.adjustScrollX(),o.melody.updateCurChord(n.focusIndex)},moveDestFocus:function(e){var n=o.store.melodyState,t=o.store.scoreData.notesList;-1!==n.focusIndex&&((e?n.destIndex<t.length-1:n.destIndex>0)&&(n.destIndex+=e?1:-1,o.melody.setState(n)),o.melody.adjustScrollX())},updateCurChord:function(e){var n=o.store.melodyState,t=o.store.scoreData.chordList,i=w(o.store.scoreData.notesList[e].pos)*n.beatWidth,c=0,a=t.find((function(e){if("chord"===e.type){var t=e.detail.beatLen*n.beatWidth;if(i>=c&&i<c+t)return e;c+=t}}));n.tableMouse.curChord=void 0==a?null:a,o.melody.setState(n)},addNotes:function(){var e=o.store.melodyState,n=e.focusIndex;if(-1!==n){e.dataHistory.add(JSON.stringify(o.store.scoreData.notesList));var t=o.store.scoreData,i=t.notesList,c=i[n],a=L(c.pos,c.len),r=w(a),s=n===i.length-1?-1:w(i[e.focusIndex+1].pos),l=r+1/e.quantize;(-1===s||l<=s)&&(t.notesList.splice(n+1,0,{pos:a,pitchIndex:c.pitchIndex,len:A(e.quantize,1)}),o.score.setScoreData(t),e.focusIndex++,e.destIndex=e.focusIndex,o.melody.setState(e)),o.melody.adjustScrollX()}},removeNotes:function(){var e=o.store.melodyState,n=o.store.scoreData.notesList;e.dataHistory.add(JSON.stringify(o.store.scoreData.notesList));var t=e.focusIndex<e.destIndex?[e.focusIndex,e.destIndex]:[e.destIndex,e.focusIndex],i=Object(l.a)(t,2),c=i[0],a=i[1]-c+1;n.splice(c,a),o.melody.setNotesList(n),e.focusIndex=c-1,e.destIndex=e.focusIndex,o.melody.setState(e),o.melody.adjustScrollX()},releaseRange:function(e){var n=o.store.melodyState,t=n.focusIndex<n.destIndex?[n.focusIndex,n.destIndex]:[n.destIndex,n.focusIndex],i=Object(l.a)(t,2),c=i[0],a=i[1];n.focusIndex=e?a:c,n.destIndex=n.focusIndex,o.melody.setState(n),o.melody.adjustScrollX(),o.melody.updateCurChord(n.focusIndex)},resizeNotes:function(e){var n=o.store.melodyState;if(-1!==n.focusIndex){n.dataHistory.add(JSON.stringify(o.store.scoreData.notesList));var t=o.store.scoreData,i=t.notesList,c=i[n.focusIndex],a=w(c.len),r=w(c.pos)+a,s=n.focusIndex===i.length-1?-1:w(i[n.focusIndex+1].pos),l=1/n.quantize;if(e?-1===s||r+l<=s:a>l){var d=w(c.len)+l*(e?1:-1);c.len=A(n.quantize,d*n.quantize),t.notesList=i.slice(),o.score.setScoreData(t)}}},moveNotes:function(e){var n=o.store.melodyState;if(-1!==n.focusIndex){n.dataHistory.add(JSON.stringify(o.store.scoreData.notesList));var t=o.store.scoreData,i=t.notesList,c=n.destIndex,a=n.focusIndex,r=c>a?[a,c]:[c,a],s=Object(l.a)(r,2),d=s[0],b=s[1],u=0===d?0:w(i[d-1].pos)+w(i[n.focusIndex-1].len),h=b===i.length-1?-1:w(i[b+1].pos),p=1/n.quantize,x=w(i[d].pos),f=w(i[b].pos)+w(i[b].len);if(e?-1===h||f+p<=h:x-p>=u){for(var g=d;g<=b;g++){var j=i[g],v=w(j.pos)+p*(e?1:-1);j.pos=A(n.quantize,v*n.quantize)}t.notesList=i.slice(),o.score.setScoreData(t)}}},firstNotes:function(){var e=o.store.melodyState;o.store.scoreData.notesList.length>0&&(e.focusIndex=0,e.destIndex=e.focusIndex,o.melody.setState(e),o.melody.adjustScrollX())},adjustScrollX:function(){var e=o.store.melodyState,n=o.store.refs.melody.table,t=e.destIndex;if(-1!==t&&null!=n){var i=w(o.store.scoreData.notesList[t].pos)*e.beatWidth;n.scrollTo({left:i-300,behavior:"smooth"})}},adjustScrollY:function(){var e=o.store.melodyState,n=o.store.refs.melody.table;if(-1!==e.focusIndex&&null!=n){var t=o.store.scoreData.notesList[e.focusIndex].pitchIndex*ie;n.scrollTo({top:t-n.clientHeight/2,behavior:"smooth"})}},previewStart:function(){o.store.melodyState;N.previewStart(o.store,o)},copyNotes:function(){for(var e=o.store.melodyState,n=o.store.scoreData.notesList,t=e.focusIndex<e.destIndex?[e.focusIndex,e.destIndex]:[e.destIndex,e.focusIndex],i=Object(l.a)(t,2),c=i[0],a=i[1]-c+1,r=[],s=n[c].pos,d=E(s),b=0;b<a;b++){var u=n[b+c],p=E(u.pos),x=d>p?d:p,f=w(u.pos)-w(s),g=A(x,f/(1/x));console.log("normalPos = ".concat(f,", unit = ").concat(x)),console.log(JSON.stringify(g)),r.push({pitchIndex:u.pitchIndex,pos:g,len:Object(h.a)({},u.len)})}e.cloneNotesList=r,o.melody.setState(e)},pasteNotes:function(){var e=o.store.melodyState;if(-1!==e.focusIndex){e.dataHistory.add(JSON.stringify(o.store.scoreData.notesList));var n=o.store.scoreData,t=n.notesList,i=t[e.focusIndex],c=L(i.pos,i.len),a=e.focusIndex===t.length-1?-1:w(t[e.focusIndex+1].pos),r=JSON.parse(JSON.stringify(e.cloneNotesList));r.forEach((function(e){e.pos=L(e.pos,c)}));var s=r[r.length-1],l=w(s.pos)+w(s.len);console.log("newRight: ".concat(l,", nextLeft: ").concat(a)),(-1===a||l<=a)&&(n.notesList=t.concat(r),n.notesList.sort((function(e,n){var t=w(e.pos),i=w(n.pos);return t===i?0:t<i?-1:1})),o.score.setScoreData(n),e.focusIndex++,e.destIndex=e.focusIndex+r.length-1,o.melody.setState(e))}},undo:function(){var e=o.store.melodyState,n=o.store.scoreData,t=e.dataHistory;console.log("undo start \u2605 length: ".concat(t.list.length,", cur: ").concat(t.cur));var i=t.undo();null!=i&&(0===t.cur&&(console.log("first undo"),t.list.unshift(JSON.stringify(n.notesList)),t.cur=1),n.notesList=JSON.parse(i),e.focusIndex>=n.notesList.length-1&&(e.focusIndex=n.notesList.length-1,e.destIndex=e.focusIndex),o.score.setScoreData(n)),console.log("undo end \u2605 length: ".concat(t.list.length,", cur: ").concat(t.cur))},redo:function(){var e=o.store.melodyState,n=o.store.scoreData,t=e.dataHistory;console.log("redo start \u2605 length: ".concat(t.list.length,", cur: ").concat(t.cur));var i=t.redo();null!=i&&(n.notesList=JSON.parse(i),e.focusIndex>=n.notesList.length-1&&(e.focusIndex=n.notesList.length-1,e.destIndex=e.focusIndex),o.score.setScoreData(n)),console.log("redo end \u2605 length: ".concat(t.list.length,", cur: ").concat(t.cur))}},this.backing={openBackingEditor:function(){var e=o.store.scoreState,n=o.store.scoreData.chordList[e.focusIndex].detail,t=e.elementCacheList[e.focusIndex],i=e.chordCacheList[t.chordBlockNo],c=n.backing,a=i.structList;e.hideMenu="backing",o.score.setScoreState(e);var r=O.getInitVoicingTable(n.backing.voicingList,a.length),s=O.getEditorPatternFromChordBacking(r,c.pattern),l={symbolAttr:v.getSymbolFromKey(n.symbolKey).attr,chordFullName:i.chordFullName,structList:a,beatLen:n.beatLen,minute:n.minute,init:Object(h.a)({},t)},d=O.getVoicingListFromTable(r),b=O.checkEditorError(l,d,s);o.backing.setState({chordInfo:l,tabIndex:0,voicingTable:r,pattern:s,isPreview:!1,hasError:b,closeAction:function(e,n){n&&o.backing.mappingEditorToScore(e),o.backing.closeBackingEditor()}})},closeBackingEditor:function(){var e=o.store.scoreState;e.hideMenu="none",o.score.setScoreState(e),setTimeout((function(){o.backing.setState(null)}),50)},setState:function(e){o.dispatch(i.SET_BACKING_STATE,{backingState:e})},getInitialLayer:function(){return{noteDivList:[{rate:4,isDot:!1,div3:0}],table:[[null]],velocityList:[5]}},mappingEditorToScore:function(e){var n=o.store.scoreState,t=o.store.scoreData,i=n.focusIndex,c=t.chordList[i].detail;console.log(e),c.backing={voicingList:O.getVoicingListFromTable(e.voicingTable),pattern:null==e.pattern?null:O.buildPatternProps(e.pattern)},o.score.setScoreData(t);var a=n.elementCacheList[i];n.chordCacheList[a.chordBlockNo].backingError=e.hasError,o.score.setScoreState(n)},addPatternColumn:function(){var e=o.store.backingState,n=e.pattern,t=n.layers[n.layerIndex],i=t.noteDivList,c=i[n.lenIndex],a={rate:c.rate,div3:c.div3,isDot:c.isDot};i.splice(n.lenIndex+1,0,a),t.noteDivList=i.slice(),t.table.forEach((function(e){e.splice(n.lenIndex+1,0,null)})),t.velocityList.splice(n.lenIndex+1,0,5),0===n.layerIndex&&n.pedalActs.splice(n.lenIndex+1,0,null),o.backing.updateErrorState(),o.backing.setState(e)},movePatternColumn:function(e){var n=o.store.backingState,t=n.pattern,i=t.layers[t.layerIndex],c=t.lenIndex;(c+=1*(e?1:-1))>=0&&c<=i.noteDivList.length-1&&(t.lenIndex=c),o.backing.setState(n)},moveChannelIndex:function(e){var n=o.store.backingState,t=n.pattern,i=t.channelIndex;(e?i<t.channels.length-1:i>0)&&(t.channelIndex+=e?1:-1),o.backing.setState(n)},setCurrentDivRate:function(e){var n=o.store.backingState,t=n.pattern,i=t.layers[t.layerIndex],c=i.noteDivList[t.lenIndex];c.rate=e,c.isDot=!1,c.div3=0,i.noteDivList=i.noteDivList.slice(),o.backing.updateErrorState(),o.backing.setState(n)},toggleCurrentDivHalf:function(){var e=o.store.backingState,n=e.pattern,t=n.layers[n.layerIndex],i=t.noteDivList[n.lenIndex];O.isPermitDot(i)&&(i.isDot=!i.isDot,t.noteDivList=t.noteDivList.slice(),o.backing.setState(e),o.backing.updateErrorState())},getNotes:function(){var e=o.store.backingState.pattern;return e.layers[e.layerIndex].table[e.channels.length-1-e.channelIndex][e.lenIndex]},setNotes:function(e){var n=o.store.backingState,t=n.pattern,i=t.layers[t.layerIndex];i.table[t.channels.length-1-t.channelIndex][t.lenIndex]=e,i.table=i.table.slice(),o.backing.updateErrorState(),o.backing.setState(n)},incrementVel:function(e){var n=o.store.backingState,t=n.pattern,i=t.layers[t.layerIndex],c=i.velocityList[t.lenIndex]+e;c>=1&&c<=10&&(i.velocityList[t.lenIndex]=c,o.backing.setState(n))},deleteColumn:function(){var e=o.store.backingState,n=e.pattern,t=n.layers[n.layerIndex];if(t.noteDivList.length>=2){if(t.noteDivList.splice(n.lenIndex,1),t.table.forEach((function(e){e.splice(n.lenIndex,1)})),t.velocityList.splice(n.lenIndex,1),0===n.layerIndex){if(n.lenIndex<n.pedalActs.length-1)for(var i=n.lenIndex+1;i<n.pedalActs.length;i++)n.pedalActs[i]=null;n.pedalActs.splice(n.lenIndex,1)}n.lenIndex>0&&n.lenIndex--,o.backing.setState(e)}o.backing.updateErrorState()},switchLayer:function(){var e=o.store.backingState,n=e.pattern;n.layerIndex=0===n.layerIndex?1:0,n.lenIndex=0,n.channelIndex=-1,o.backing.setState(e)},switchMode:function(){var e=o.store.backingState,n=e.pattern;"velocity"===n.mode?n.mode="pedal":"pedal"===n.mode&&(n.mode="velocity"),o.backing.setState(e)},testBacking:function(){var e=o.store.backingState,n=o.store.reserveTasks,t=e.chordInfo,i=t.init,c=v.calcSustainMsec(t.beatLen,t.minute.head+t.minute.tail,i.bpm,i.beatSignature),a={voicingList:O.getVoicingListFromTable(e.voicingTable),pattern:null==e.pattern?null:O.buildPatternProps(e.pattern)},r=O.getPitchListFromVoicing(a.voicingList,t.structList);O.playBacking(o.store,n,i,a,r,c),n.push(setTimeout((function(){e.isPreview=!1,o.backing.setState(e)}),c)),e.isPreview=!0,o.backing.setState(e)},updateErrorState:function(){var e=o.store.backingState,n=O.getVoicingListFromTable(e.voicingTable);e.hasError=O.checkEditorError(e.chordInfo,n,e.pattern),o.backing.setState(e)}},this.thema={openBackingEditor:function(e,n,t,i,c,a,r,s){var d=v.getSymbolFromKey(i),b=O.getInitVoicingTable(a.voicingList,d.structs.length),u=O.getEditorPatternFromChordBacking(b,a.pattern),h=O.getChordDetails({index:c,isFlat:!1},0,null,d),p=Object(l.a)(h,2),x=p[0],f=p[1],g={symbolAttr:d.attr,chordFullName:x,structList:f,beatLen:e,minute:{head:n,tail:t},init:{beatSignature:"4/4",bpm:100,keyIndex:0,scale:"major"}},j=O.getVoicingListFromTable(b),m=O.checkEditorError(g,j,u);o.backing.setState({chordInfo:g,tabIndex:0,voicingTable:b,pattern:u,isPreview:!1,hasError:m,closeAction:function(e,n){n&&r(e),s(),o.backing.setState(null)}})},mappingEditorToThema:function(e){if(console.log(e),null!=e.pattern)O.buildPatternProps(e.pattern)},mappingSelectorToScore:function(e,n){var t=o.store.scoreState,i=o.store.scoreData,c=t.focusIndex;i.chordList[c].detail.backing={voicingList:e,pattern:n},o.score.setScoreData(i)}},this.store=n,this.dispatch=function(e,n){return t({type:e,payload:n})}},Sn=t(6),wn=function(){function e(){Object(x.a)(this,e),this.cur=void 0,this.list=void 0,this.cur=-1,this.list=[]}return Object(Sn.a)(e,[{key:"add",value:function(e){this.cur>-1&&(this.list.splice(0,this.cur+1),this.cur=-1,console.log("restert")),this.list.unshift(e)}},{key:"undo",value:function(){var e=null;return this.cur<this.list.length-1&&(this.cur++,e=this.list[this.cur]),e}},{key:"redo",value:function(){var e=null;return this.cur>0&&(this.cur--,e=this.list[this.cur]),e}}]),e}();!function(e){e.getEnableState=function(e){var n=e.scoreData.chordList,t=e.scoreState,i=n[t.focusIndex];return{isChordElement:"chord"===i.type&&null!=i.detail.root,isUseLib:-1!==e.systemState.activeThemaIndex,isRangeSelect:t.focusIndex!==t.distIndex}};var n=function(e,n,t,i,o,c,a){(function(){if(null==o||null==e||-1===n.refer)return n.attrs;var t=e.find((function(e){return n.refer===e.key}));return void 0==t?[]:t.attrs})().forEach((function(e){if(!(t.attr===e.attr&&e.symbols.includes(t.key)))return 1;e.roots.forEach((function(e){if(!(i>=e.minIdx&&i<=e.maxIdx))return 1;e.voics.forEach((function(e){if(null!=o&&!e.preUsies.map((function(e){return"".concat(-1===e.depPatt?n.key:e.depPatt,",").concat(e.presKey)})).includes("".concat(n.key,",").concat(o)))return 1;c(e),a(n,e)}))}))}))},t=e.searchSustMeth=function(e,t,i,o){if("sustain"===e.method){var c=v.getSymbolFromKey(t.symbolKey),a=t.rootIndex,r=e.defs;n(null,{attrs:r,key:-1,refer:-1,pattName:"",source:{channelSize:0,layers:[],pedals:[]}},c,a,i,o,(function(){}))}},i=e.searchPattMeth=function(e,t,i,o,c,a){if("pattern"===e.method){var r=v.getSymbolFromKey(t.symbolKey),s=t.rootIndex;e.defs.forEach((function(e){if(!(t.beatLen===e.beat&&t.head===e.head&&t.tail===e.tail))return 1;e.patts.forEach((function(t){n(e.patts,t,r,s,i,c,a),o(t)}))}))}};e.getDistinctionFromRelate=function(e){switch(e.relation){case"p1":return 1;case"M2":case"m2":return 9;case"m3":case"M3":return 3;case"p4":case"p5":case"a5":case"d5":return 5;case"m7":case"M7":return 7}return-1},e.acceptVoic=function(e,n,t){var i=n[t].refer,o=-1;n.some((function(e,n){-1===i||e.key!==i||(o=n)}));var c=-1===e.pattIdx,a=e.pattIdx===t,r=o===e.pattIdx;return c||a||r},e.getPresetList=function(e,n){var o=[];return e.meths.forEach((function(e){e.prenams.forEach((function(c){var a=n.map((function(n){var o=[];switch(e.method){case"sustain":t(e,n,c.seq,(function(e){o.push({pattern:null,voicingList:e.source})}));break;case"pattern":i(e,n,c.seq,(function(){}),(function(){}),(function(e,n){o.push({pattern:e.source,voicingList:n.source})}))}return{condition:n,backing:0===o.length?null:o[0]}}));o.push({method:e.method,dispName:c.name,applyList:a})}))})),o},e.matchCondition=function(e,n){return e.beatLen===n.beatLen&&e.head===n.head&&e.tail===n.tail&&e.rootIndex===n.rootIndex&&e.symbolKey===n.symbolKey},e.getDefaultLibs=function(){return[]}}(un||(un={}));var Ln,In,An,En,Cn,Tn,Mn,Dn,Nn,Fn,_n,zn,Rn,Bn,Pn=un,Kn={userEnv:{keyConfig:{note:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown",addChord:"a",addSection:"s",addChange:"m",deleteCur:"Delete",distMode:"Shift",edit1:"f",edit2:"c",incRoot:"ArrowUp",decRoot:"ArrowDown",incBeat:"ArrowRight",decBeat:"ArrowLeft"}},colorProps:{entryBackground:"#e2a9ae"},login:null},systemState:{directScore:null,isSplash:!0,mainChannelIndex:0,scoreTabIndex:0,editable:!0,dialog:null,themaList:Pn.getDefaultLibs(),activeThemaIndex:-1,cache:null},backingState:null,scoreState:{fileHandle:null,isMelody:!1,initialBeat:4,focusIndex:-1,distIndex:-1,elementCacheList:[],chordCacheList:[],sectionCacheList:[],scaleCacheList:[],tempoCacheList:[],beatCacheList:[],measureCacheList:[],keySwitch:{distMode:!1,sustainMode:!1,chordMode:!1,symbolMode:!1,control:!1,minHeadMode:!1,minTailMode:!1},symbolMng:null,hideMenu:"none",isPreview:!1,isSolo:!1,cloneBacking:null,copiedElementList:null,backingDataHistory:new wn},melodyState:{focusIndex:-1,destIndex:-1,lastFocus:-1,quantize:1,beatWidth:120,tableMouse:{isPut:!1,lock:{x:0,y:0},width:0,prevRight:0,nextLeft:0,notesState:{index:-1,side:"normal",isResize:!1,isMove:!1},curChord:null,mousePitchIndex:-1,mouseMeasurePos:-1},timelineMouse:{pos:-1,isPut:!1,lock:-1,width:0},soundfontInfo:{name:"violin",gain:9},keySwitch:{scaleMode:!1,octave:!1,resize:!1,move:!1,shift:!1,control:!1},isPreview:!1,isSolo:!1,cloneNotesList:[],dataHistory:new wn,notesCacheList:[]},scoreData:{chordList:[],notesList:[]},instruments:{harmonyFont:null,melodyFont:null},refs:{harmonize:{note:{}},melody:{table:null,measure:null,chord:null,pitch:null}},reserveTasks:[],invalidate:{harmoniizeInvalidate:{},harmonize:null,melody:null}},Un=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.systemState.dialog;return null==i?Object(se.jsx)(se.Fragment,{}):Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Vn,{onClick:function(){n.systemState.dialog=null,t.system.setState(n.systemState)}}),i]})},Vn=d.b.div(Ln||(Ln=Object(s.a)(["\n    display: block;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    background-color: #000329a2;\n    z-index: 10;\n    text-align: center;\n"]))),qn=function(e){var n=Object(o.useState)(e.activeNo),t=Object(l.a)(n,2),i=t[0],c=t[1];return Object(o.useEffect)((function(){c(e.activeNo)}),[e.activeNo]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Wn,{children:e.tabElements.map((function(n,t){return Object(se.jsx)(Hn,{name:n.name,icon:n.icon,isActive:t==i,isEnable:n.isEnable,selectTab:function(){return function(n){void 0!=e.selectTabIndex?e.selectTabIndex(n):c(n)}(t)}},t)}))}),Object(se.jsx)(Yn,{children:e.tabElements.map((function(e,n){return Object(se.jsx)(Jn,{cont:e.cont,isActive:n===i},n)}))})]})},Hn=function(e){return Object(se.jsxs)(Qn,{isEnable:e.isEnable,isActive:e.isActive,onClick:function(){return e.selectTab()},children:[Object(se.jsx)(Xn,{children:e.icon}),Object(se.jsx)(Zn,{children:e.name})]})},Jn=function(e){return Object(se.jsx)(Gn,{isActive:e.isActive,children:e.cont})},Wn=d.b.div(In||(In=Object(s.a)(["\n    display: inline-block;\n    width: 100px;\n    margin-right: 5px;\n    height: 100%;\n    background-color: #b9b9b9;\n    border: 1px solid #707070;\n    box-sizing: border-box;\n    border-radius: 10px 0 0 10px;\n    vertical-align: top;\n    box-shadow: 1px 2px 12px #aaaaaa;\n"]))),Yn=d.b.div(An||(An=Object(s.a)(["\n    display: inline-block;\n    background-color: #b9b9b9;\n    border: 1px solid #707070;\n    box-sizing: border-box;\n    width: calc(100% - 105px);\n    height: 100%;\n    border-radius: 0 6px 6px 0;\n    box-shadow: 1px 2px 12px #aaaaaa;\n"]))),Gn=d.b.div(En||(En=Object(s.a)(["\n    /* margin: 3px 0 0 3px;\n    width: calc(100% - 6px);\n    height: calc(100% - 6px); */\n    width: 100%;\n    height: 100%;\n    /* background-color: #ece6e6; */\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(Tn||(Tn=Object(s.a)(["display: inline-block;"]))):Object(d.a)(Cn||(Cn=Object(s.a)(["display: none;"])))})),Qn=d.b.div(Mn||(Mn=Object(s.a)(["\n    display: inline-block;\n    width: 90px;\n    height: 90px;\n    margin: 5px 0 0 5px;\n    border-radius: 10px;\n    ","\n    ","\n    transition: background-color 500ms;\n    & *{\n        transition: color 150ms;\n    }\n    // \u30a2\u30af\u30c6\u30a3\u30d6\u3058\u3083\u306a\u3044\u6642\u3060\u3051hover\u8981\u7d20\u3092\u4ed8\u52a0\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(Dn||(Dn=Object(s.a)(["\n                background-color: #e4e3e1;\n                border: 1px solid #949494\n            "]))):Object(d.a)(Nn||(Nn=Object(s.a)(["\n                background-color: #d1d1d1;\n                opacity: 0.8;\n            "])))}),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}),(function(e){return e.isActive?"":Object(d.a)(Fn||(Fn=Object(s.a)(["\n        &:hover {\n            & *{\n                transition: color 150ms;\n                /* background-color: #e2d6d6; */\n                text-shadow: 1px 2px 22px #f7f7f7ea;\n                color: #a7a7a7;\n            }\n        }\n    "])))})),Xn=(Object(d.a)(_n||(_n=Object(s.a)(["\n    text-shadow: 1px 2px 22px #f7f7f7cf;\n    color: #a3a3a3;\n"]))),d.b.div(zn||(zn=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 60px;\n    /* background-color: #df828221; */\n    font-size: 50px;\n    color: #757575;\n    text-align: center;\n    padding-top: 5px;\n    box-sizing: border-box;\n"])))),Zn=d.b.div(Rn||(Rn=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 30px;\n    /* background-color: #8482df20; */\n    font-size: 20px;\n    font-weight: 600;\n    color: #757575;\n    text-align: center;\n"]))),$n=t(68),et=t(48),nt=t(19),tt=t(35),it=t(69);!function(e){e.search=function(e){return i.filter((function(n){return n.condition.beat===e.beat&&(0===e.step||n.condition.step===e.step)&&(""===e.firstChord||n.condition.firstChord===e.firstChord)&&(""===e.secondChord||n.condition.secondChord===e.secondChord)}))};var n=e.parseChord=function(e){var n=-1,i=e.split(" "),o=[];return i.some((function(e,i){var c=e.charAt(0);if("@"===c){var a=Number(e.charAt(1));n=a}else{if(!["1","2","3","4","5","6","7"].includes(c))return!0,!0;var r=Number(c)-1,s=null,l=v.DIATONIC_MAJOR_SCALE_LIST[r];if(1===e.length)s={root:l.root,symbolKey:l.symbolKey,beatLen:n};else{var d=e.charAt(1),b="#"===d?1:"b"===d?-1:0,u=e.substring(2),p=t(u);if(void 0!=p){var x=Object(h.a)({},l.root);x.index+=b,x.isFlat=-1===b,s={root:x,symbolKey:p.key,beatLen:n}}}if(null==s)return!0,!0;o.push(s)}})),o},t=function(e){return v.SYMBOL_LIST.find((function(n){if("*"+n.name===e)return n}))},i=[{condition:{beat:"4/4",step:2,firstChord:"\u2160",secondChord:"\u2164"},chordList:n("@2 1 5 6 3 4 1 2 5")},{condition:{beat:"4/4",step:2,firstChord:"\u2160",secondChord:"\u2164"},chordList:n("@2 1 5 6 3 4 3 2 5")},{condition:{beat:"4/4",step:2,firstChord:"\u2160",secondChord:"\u2164"},chordList:n("@2 1 5 6 3 4 1 2 5 1")},{condition:{beat:"4/4",step:2,firstChord:"\u2160",secondChord:"\u2164"},chordList:n("@2 1 5 6 5 4 1 2 5")},{condition:{beat:"4/4",step:4,firstChord:"\u2160",secondChord:"\u2164"},chordList:n("@4 1 5 6 4 1 5 6 4")},{condition:{beat:"4/4",step:2,firstChord:"\u2160",secondChord:"\u2164"},chordList:n("@2 1 5 7b* 6n*7 2 1#*dim 2 5")},{condition:{beat:"4/4",step:4,firstChord:"\u2160",secondChord:"\u2163"},chordList:n("@4 1 4 5 6 2 5")},{condition:{beat:"4/4",step:4,firstChord:"\u2160",secondChord:"\u2165m"},chordList:n("@4 1 6 2 5 1 6 2 5")},{condition:{beat:"4/4",step:4,firstChord:"\u2160",secondChord:"\u2165m"},chordList:n("@4 1 6 4 5 1 6 4 5")},{condition:{beat:"4/4",step:2,firstChord:"\u2163",secondChord:"\u2164"},chordList:n("@2 4 5 3 6 4 5 3 6")},{condition:{beat:"4/4",step:2,firstChord:"\u2163",secondChord:"\u2164"},chordList:n("@2 4n*maj7 5 3n*m7 6 4n*maj7 5 3n*m7 6")},{condition:{beat:"4/4",step:2,firstChord:"\u2163",secondChord:"\u2164"},chordList:n("@2 4n*maj7 5 3n*m7 6 2n*m7 3n*7 6 6n*7")},{condition:{beat:"4/4",step:2,firstChord:"\u2163",secondChord:"\u2164"},chordList:n("@2 2n*m7 5 3n*m7 6 2n*m7 3n*7 6n*sus4 6")},{condition:{beat:"4/4",step:2,firstChord:"\u2165m",secondChord:"\u2163"},chordList:n("@2 6 4 5 1 6 4 5 1")},{condition:{beat:"4/4",step:4,firstChord:"\u2165m",secondChord:"\u2163"},chordList:n("@4 6 4 5 1 6 4 5 1")},{condition:{beat:"4/4",step:2,firstChord:"\u2165m",secondChord:"\u2163"},chordList:n("@2 6 4 1 5 6 4 1 5")},{condition:{beat:"4/4",step:4,firstChord:"\u2165m",secondChord:"\u2163"},chordList:n("@4 6 4 1 5 6 4 1 5")},{condition:{beat:"4/4",step:2,firstChord:"\u2165m",secondChord:"\u2164"},chordList:n("@2 6 5 4 3n*m7 2n*m7 6 2#*dim 3n*7")}]}(Bn||(Bn={}));var ot,ct,at,rt,st,lt=Bn;(st=rt||(rt={}))._TitleLabel=d.b.div(ot||(ot=Object(s.a)(["\n        ",";\n        background-color: #f0f0f049;\n        width: 120px;\n        text-align: center;\n        border-radius: 10px;\n        color: #2c2c2c;\n        border: solid 1px #ffffff79;\n        box-sizing: border-box;\n        vertical-align: top;\n    "])),Be.CSS_LABEL_MIDIUM),st._Combobox=d.b.select(ct||(ct=Object(s.a)(["\n        display: inline-block;\n        height: 30px;\n        ","\n        font-size: ","px;\n        text-align: left;\n        color: black;\n        line-height: 24px;\n        width: ","px;\n        box-sizing: border-box;\n    "])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}),Be.FONT_MIDIUM,(function(e){return e.width})),st._Label=d.b.div(at||(at=Object(s.a)(["\n        display: inline-block;\n        height: 30px;\n        ","\n        font-size: ","px;\n        text-align: left;\n        color: #002bc5;\n        font-weight: 600;\n        background-color: #e1f9fa;\n        padding-left: 4px;\n        border-radius: 4px;\n        line-height: 24px;\n        width: ","px;\n        box-sizing: border-box;\n        vertical-align: top;\n    "])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}),Be.FONT_MIDIUM,(function(e){return e.width}));var dt,bt=rt;(dt||(dt={})).BACKING_SAMPLE_LIST=[{name:"none",patternConditions:[]},{name:"barrade-01",patternConditions:[{beatLen:2,source:"H4sIAAAAAAAAA8VTwRKCIBD9Gu4FOnbVvDTTrS9ghIyGsJHNyb4+BCkxb416YWD3LW/fY0FJhjAuLlQpLk/ixc0JkTRGeG92d86o1C6E4gxZMBPNQTH+dOGNQ9ICRKV6JMZum+Qozl1e0pbXEzeNQzWFvoXIFQqdV+AiZ9MLd1FTSTx/YilG1btf3PR1f1d7haoCro9Cw0hR6FMbnDRQeHgLLFqLUlH58dHaaKEgbkKVQXXDZcquAxsGWnpWvArrNmDdzsXqnTe57xh1k9uNDunSg9ZmnLVo7mnBq7zbUqyhVrKK1qVYQ63R4j/D/wq7vgHgSWwr/AUAAA==",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmtCghuwqAW7wdQFAL14+prfAAAA"},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BqRoNYYl1oTHG4wdQEAGcWLSt8AAAA="}]},{beatLen:4,source:"H4sIAAAAAAAAA9WVwVLDIBCGn4a7XcB4bc3Fmd58AqbBioPECdtO69NLINGAdexBYLwwsOzPB7sskGZDAHbPwhipH9W7dCNC17cE7l3vTXZC22AifEO8c6eOD6aTp2C+CZ5ih6o3kydA6DYt4W2Y1+IshwsrpaZB4LQFFoTKtj0Gy5PbiwxWp6Qzv/GIRH333e/ychnU7Hc1Doc/QM/BNT1Ku1UWk2DGKTpHI4sCD3P0vbdVeyP0Zwp9Br0rqldl9pH6KPW6e1lkYHGWUxSFwtRVRF0VotIqVIiokIs63zI391Wt3NnGDI8nH/swui22mLG0ryivbKX9X9RXvgy0zA1K7i2vQo1fQVrlPSpFZVWocYRZlQiXokIVKqtCjfPKq0Q4G/XH341OPxwkP5xvPwCCCyaGNwsAAA==",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTFlag1JUGuES60JCW7AohbsBlMXAA68b5wLAQAA"},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTFlag1JUGtEglpjXGpNcLjB1AUAqgEeTAsBAAA="}]}]},{name:"barrade-02",patternConditions:[{beatLen:2,source:"H4sIAAAAAAAAA8VTXQ+CIBT9NbwbxPRV86Wtt34BUzIaYQty2a+PQFLMuT7tgQ3OPZdzOZcLwgRAmG2JEJSv2YXqE0AxBnChdweaEy4tBHACDDln1VLk9GzhwDJJplgpGiaEdhumAKc2zklNjwM39aEjUU0JkU1kMi2VRTa6FmpRnYmcfmgkhrO7vOHr/pzt/BGlonLFpOr54btceyepiDo5Aw1bskIQfu+CaYKhKrZnovCyK8rjfNcxsfOWRnXmqc4mUkWeKpxIFXqq6Feqrt861n7927S1C3vljc7I/IUZeeunTeV+8EX30TMS848koseHwfEGYxcM0ysSYVFzcwUAAA==",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmtCghuwqAWba+oCACBiEqvfAAAA"},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmtCghuwqDUGqTV1AQCUaWUN3wAAAA=="}]},{beatLen:4,source:"H4sIAAAAAAAAA+2V0W7CIBSGn4b7eUrFW11vTHbnExCLjgWpEWbUp5dC2cA1y1YSuPGiLRzOz8dJfwCRFQLYvlMpmdjwGzM9VC3nCF5N68haKpQLoXqFbHLLz2vZsosLv7hMutW8k0MmgGuSBtWNGxf0yk4jMz2GTlQPS1g4IVdNp11kZ9bCXNQoK88nFjGuDvPGp3uqi6i9L2SnmXrjSj/4IHbXNeopTfWnN47NVnwvqfhynzWfTdX8wOU+Up+ZWLYfgXmCWgbqLKLOMlFxEWoVUSETtS5CJUWoEFGrTNR5Hqrfx2bs+yjv/65/cPDtH+glwXJ/vQNw0h2Ak06z/6gnnWa5nFDGf3GtOImKf1LhL7WmUafWWidRycS9hod9Zd93wUPW69YJAAA=",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmtCghuwqMXpBlMc5pq6AADXs/OfCwEAAA=="},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmtCghuwqCXFXGOQWlMXACkdNMwLAQAA"}]}]},{name:"8beat-01",patternConditions:[{beatLen:2,source:"H4sIAAAAAAAAA8VTSw7CIBQ8DXulJbht7cbEnScgLVYMUlOwsZ5e5BUtTeNGU1bAMMM83gfRHGFcnphSXB7Eg9sTSrIU4a3dXXnFpAYIkRw5ciW6nar4HeAVMFlpRKMGJsawpQUiBdxL1vN25qUp1DIzhLABodBFYwA52lg4oFaZeH/qLObVY978c5HVPj+qMVzvhTaTfIRZ7oOTNszcfAIdW4taMfmugiuCoxpxEaoO1B2XWXUeJXH0l8F1HcUVR3FNlnH19bZ3n9YnFnv5w0qC8L7OSPrTjKT/79OwY9YL1S6cDhxlOpZyDf+aROhT4gm0eAKCqPtePgYAAA==",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTFlag1JUGsEUmvqAgBJsewgswAAAA=="},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BqRoNYYpNbUBQClqctlswAAAA=="}]},{beatLen:4,source:"H4sIAAAAAAAAA+2V0Q6CIBSGn4b7Omp2W3nT1l1PwJSKRtiEXPb0IWhJc67N5bnpRuBwDh+w3x8SrwlAeqJSMrHnD2ZGJFiFBDamd2UZFcqFSLQmNjnj5VZm7O7CM5dJU81z2WQCuG6ckChx84JWrOhZ6TNUUN1sYekKuUpy7SIHsxfmoqYyaPmxRfRXd/P6l/tXo1S3upC5ZmrHlf7Qga+uyhspTfWtFY7NVvwoqXipz4rPpmp+4fLoVZdMrLJzRzydszTUOQoVUKgBCjVEoUYo1AUKNZ6G2v7HZu5t5fU917rqbyNvu4NvQDjqDQhHudl01V96oe9KcxR/mIrq+z6g+P5UVECh+jccoJz1Z9RBV4KOC9nvE4/6Z+UECwAA",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmuCww2mLgAeyOCMswAAAA=="},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BqRoNYYpNbUBQClqctlswAAAA=="}]}]},{name:"8beat-02",patternConditions:[{beatLen:2,source:"H4sIAAAAAAAAA8VTQQ6CMBB8Te9SJHgFuZh48wUNVKypxdCFiK+3dqlSwsXE0Attp7M7y26HpDmhtLwwpbg8iSc3JxJnW0L3ZnfnFZMaIZLkxJIr0R9UxR8Ib5DJShCNGpmU4jYtSFLgvWQDbxcyzaGWwVjCDgOFLhpA5Gxq4YiayNjpp1ZiOXrKW04XONr1RzXA9VFomPXD7/LgnTQw6FwDLVuLWjH5mYIdgqWCuAlVe9E9l1l1nTRx8i+jahRElQZRjddRdfM2d9+nnxjsrY9r4pX3o0eg7f5oEZttrTfuv7Zopbn7zqJBnLWWKg2i6nc4DuIs5yr7fQFCZXGQ9AYAAA==",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTFlag1JUGsEUmvqAgBJsewgswAAAA=="},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BqRoNYYpNbUBQClqctlswAAAA=="}]},{beatLen:4,source:"H4sIAAAAAAAAA+2VwU4DIRCGn4a7nQXx2roXE28+AelixSBrFtrYPn0ps+jSEBMTw8TEE+wwPx/L/jvD5IYBbF+Uc9o+mZOOT6xbcwb3cfauB2U9hpjYsJQ8mMODG/QHhm8wU22DGd2cCYBT2TPR47pVRz1VdroOTSrMR7hDofH9GDDyHM+iMRqVXebLhKirl3n17f7VJOrsCzcG7R+ND1c+KN11LJ58UGGfjZOyvdk5ZT/dl8yXUoN5M25XqA/arofXhXkW7zJTVyRUIKF2JFROQhUk1FsSqmxDzf9xXPsq5Zd7vviqPoriuD/sAWHa/2ILSLtVxfyP1NEmVbishyuSytSKKkioZZ8Dkj7XigokVE5CLb9rR3LDrai8DfXbjgPziHORBbI/A9v3xeToDAAA",voicingConditions:[{attr:"triad",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BrhUmuCww2mLgAeyOCMswAAAA=="},{attr:"seventh",source:"H4sIAAAAAAAAA1M1dVI1d1I1MspPLkksSwUyVI0djVSNnIGs4pKi0uQSiJCBqrkLSBRDrTGmWkMS1BqRoNYYpNbUBQClqctlswAAAA=="}]}]},{name:"arpeggio-01",patternConditions:[]},{name:"arpeggio-02",patternConditions:[]},{name:"rock-01",patternConditions:[]},{name:"16beat-01",patternConditions:[]}];var ut,ht=dt;!function(e){var n=e.STEP_LIST=[0,2,3,4],t=(e.DEGREE_FILTER_LIST=["","\u2160","\u2164","\u2163","\u2165m","\u2161m","\u2162m"],e.getInitialBlockList=function(){return[{type:"fixed",detail:"Start"},{type:"fixed",detail:"End"}]},e.getBlankBlockList=function(){return[{type:"fixed",detail:"Start"},{type:"section",detail:{sectionName:"Section",sectionNo:"",chordList:[t()],backingNo:0}},{type:"fixed",detail:"End"}]},e.getDefaultChord=function(){return{beatLen:4,minute:{head:0,tail:0},root:null,on:null,symbolKey:"major",backing:{voicingList:[],pattern:null}}});e.getFilteredStepList=function(e){return n.filter((function(n){if(0===n)return!0;switch(e){case"4/4":case"6/8":if(3===n)return!1;break;case"3/4":case"9/8":if(3!==n)return!1;break;case"2/4":case"6/8":if(2!==n)return!1}return!0}))},e.buildScoreData=function(e){var n=[];return n.push({type:"init",detail:{keyIndex:0,bpm:100,scale:"major",beatSignature:"4/4"}}),e.forEach((function(e){if("fixed"===e.type){var t=e.detail;n.push({type:"fixed",detail:{fixed:t}})}else{var i=e.detail;n.push({type:"section",detail:{labelName:i.sectionName}});var o=ht.BACKING_SAMPLE_LIST[i.backingNo];i.chordList.forEach((function(e){var t=e,i=[],c=null;o.patternConditions.some((function(e){if(e.beatLen===t.beatLen)return c=JSON.parse(re.a.unZip(e.source)),e.voicingConditions.some((function(e){var n=v.getSymbolFromKey(t.symbolKey);if(e.attr===n.attr)return i=JSON.parse(re.a.unZip(e.source)),!0})),!0})),t.backing.voicingList=i,t.backing.pattern=c,n.push({type:"chord",detail:t})}))}})),{chordList:n,notesList:[]}}}(ut||(ut={}));var pt,xt,ft,gt,jt,vt,mt,Ot,kt,yt,St,wt,Lt=ut,It=function(e){var n=Object(o.useState)(0),t=Object(l.a)(n,2),i=t[0],c=t[1],a=Object(o.useState)(["",""]),r=Object(l.a)(a,2),s=r[0],d=r[1],b=Object(o.useState)(null),u=Object(l.a)(b,2),h=u[0],p=u[1],x=Object(o.useState)(-1),f=Object(l.a)(x,2),g=f[0],j=f[1],m=Object(o.useMemo)((function(){return""===e.beat?[0]:Lt.getFilteredStepList(e.beat)}),[e.beat]),O=Object(o.useMemo)((function(){return m.map((function(e,n){var t=0===e?"":e;return Object(se.jsx)("option",{value:e,children:t},n)}))}),[m]),k=Object(o.useMemo)((function(){return[Lt.DEGREE_FILTER_LIST.map((function(e,n){return Object(se.jsx)("option",{value:e,children:e},n)})),Lt.DEGREE_FILTER_LIST.map((function(e,n){return Object(se.jsx)("option",{value:e,children:e},n)}))]}),[s]),y=Object(o.useMemo)((function(){if(""===e.beat)return[[],[]];var n=e.beat,t=lt.search({beat:e.beat,step:i,firstChord:s[0],secondChord:s[1]}),o=t.map((function(e,t){var i=g===t,o=[],c="",a=0,r=v.getBeatProps(n).barBeatCnt;return e.chordList.forEach((function(e,n){var t=v.getDegreeRoot(e.root)+v.getSymbolFromKey(e.symbolKey).name;if(0!==n){var i=a%r===0?" | ":"\u30fb";o.push(Object(se.jsx)(Dt,{children:i},o.length)),c+=i}var l=!1;0===n?l=""!==s[0]:1===n&&(l=""!==s[1]),o.push(Object(se.jsx)(Mt,{isMatch:l,children:t},o.length)),c+=t,a+=e.beatLen})),Object(se.jsx)(Tt,{isActive:i,title:c,onClick:function(){j(t)},children:o},t)}));return[t,o]}),[e.beat,i,s,g]),S=Object(l.a)(y,2),w=S[0],L=S[1],I=function(e,n){var t=e.target.value;s[n]=t,0===n&&""===t&&(s[1]=""),d(s.slice()),j(-1)};return Object(se.jsxs)(At,{isEnable:""!==e.beat,children:[Object(se.jsxs)(Et,{children:[Object(se.jsx)(bt._TitleLabel,{children:"Step"}),Object(se.jsx)(bt._Combobox,{isEnable:!0,width:80,value:i,onChange:function(e){!function(e){c(Number(e.target.value)),j(-1)}(e)},children:O}),Object(se.jsx)(bt._TitleLabel,{children:"Last"}),Object(se.jsx)(bt._Label,{isEnable:!0,width:80,children:function(){var e="-";null!=h&&(e=v.getDegreeRoot(h.root)+v.getSymbolFromKey(h.symbolKey).name);return e}()})]}),Object(se.jsxs)(Et,{children:[Object(se.jsx)(bt._TitleLabel,{children:"Chord"}),Object(se.jsx)(bt._Combobox,{isEnable:!0,width:80,value:s[0],onChange:function(e){I(e,0)},children:k[0]}),Object(se.jsx)(bt._Combobox,{isEnable:""!==s[0],width:80,value:s[1],onChange:function(e){I(e,1)},children:k[1]})]}),Object(se.jsx)(Ct,{children:Object(se.jsx)("div",{children:L})}),Object(se.jsxs)(Nt,{children:[Object(se.jsx)(Ft,{isEnable:e.unitNum>0,onClick:function(){c(0),d(["",""]),e.reset()},children:"Reset"}),Object(se.jsx)(Ft,{isEnable:-1!==g,onClick:function(){var n=w[g];e.insertProgUnit("Section","",n.chordList),j(-1),c(0),d(["",""]);var t=n.chordList[n.chordList.length-1];p(t)},children:"Add"})]})]})},At=d.b.div(pt||(pt=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    ","\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),Et=d.b.div(xt||(xt=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    /* background-color: #d5eae4; */\n    /* margin: 2px 0 0 0; */\n    text-align: left;\n    & *{\n        margin: 5px 0 0 5px;\n    }\n"])),40),Ct=d.b.div(ft||(ft=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: calc(100% - ","px);\n    /* background-color: #babaa8; */\n    text-align: left;\n    & >div{\n        display: inline-block;\n        width: calc(100% - 8px);\n        height: calc(100% - 8px);\n        margin: 4px 0 0 4px;\n        background-color: #dde0e7;\n        box-sizing: border-box;\n        border: 1px solid #797979;\n        overflow-y: auto;\n        \n        &::-webkit-scrollbar {\n            width: 10px;\n            height: 10px;\n        }\n        &::-webkit-scrollbar-thumb {\n            border-radius: 5px;\n            background: #1959A8;\n        }\n        &::-webkit-scrollbar-track {\n            border-radius: 5px;\n            box-shadow: 0 0 4px #aaa inset;\n        }\n    }\n"])),120),Tt=d.b.div(gt||(gt=Object(s.a)(["\n    ","\n    display: inline-block;\n    width: 100%;\n    background-color: #00000010;\n    ","\n    text-align: left;\n    margin: 2px 0 0 0;\n    padding: 0 0 0 5px;\n    overflow: hidden;\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isActive?Object(d.a)(jt||(jt=Object(s.a)(["\n        background-color: #f6ff0062;\n    "]))):""})),Mt=d.b.span(vt||(vt=Object(s.a)(["\n    color: #000f59;\n    ","\n"])),(function(e){return e.isMatch?Object(d.a)(mt||(mt=Object(s.a)(["\n        color: #a0000d;\n        /* background-color: #5eff0061; */\n    "]))):""})),Dt=d.b.span(Ot||(Ot=Object(s.a)(["\n    color: #0000005d;\n"]))),Nt=d.b.div(kt||(kt=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    /* background-color: #94babd; */\n    text-align: center;\n    & *{\n        margin: 5px 0 0 5px;\n    }\n"])),40),Ft=d.b.div(yt||(yt=Object(s.a)(["\n    ",";\n    ",";\n    background-color: #737d94;\n    width: 130px;\n    text-align: center;\n    border-radius: 4px;\n    border: solid 1px #505971;\n    box-sizing: border-box;\n    &:hover {\n        background-color: #8da0b0;\n    }\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}));(wt=St||(St={})).SECTION_CATEGORY=["Section","Intro","A","B","C","D","Outro"],wt.SECTION_NO=["","1","2","3","4","5","6"];var _t,zt,Rt,Bt,Pt,Kt,Ut,Vt,qt,Ht,Jt,Wt,Yt,Gt,Qt=St,Xt=function(e){var n=Object(o.useMemo)((function(){return[Qt.SECTION_CATEGORY.map((function(e,n){return Object(se.jsx)("option",{value:e,children:e},n)})),Qt.SECTION_NO.map((function(e,n){return Object(se.jsx)("option",{value:e,children:e},n)}))]}),[]),t=Object(l.a)(n,2),i=t[0],c=t[1],a=ht.BACKING_SAMPLE_LIST.map((function(e,n){return Object(se.jsx)("option",{value:n,children:e.name},n)})),r=e.outputUnits.map((function(n,t){var o="fixed"===n.type;return Object(se.jsx)($t,{isFixed:o,children:function(){if(o)return Object(se.jsx)(ei,{children:n.detail});var t=n.detail,r=t.chordList;return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(ni,{children:[Object(se.jsx)(ti,{children:"Section"}),Object(se.jsx)(ii,{isEnable:!0,width:180,value:t.sectionName,onChange:function(n){t.sectionName=n.target.value,e.updateOutputUnits()},children:i}),Object(se.jsx)(ii,{isEnable:!0,width:60,value:t.sectionNo,onChange:function(n){t.sectionNo=n.target.value,e.updateOutputUnits()},children:c})]}),Object(se.jsxs)(ni,{children:[Object(se.jsx)(ti,{children:"Backing"}),Object(se.jsx)(ii,{isEnable:!0,width:180,value:t.backingNo,onChange:function(n){t.backingNo=Number(n.target.value),e.updateOutputUnits()},children:a})]}),Object(se.jsx)(oi,{children:r.map((function(e,n){var t,i="none";return null!==e.root&&(i=v.getDegreeRoot({index:e.root.index,isFlat:e.root.isFlat})+(null===(t=v.getSymbolFromKey(e.symbolKey))||void 0===t?void 0:t.name)),Object(se.jsxs)(ci,{children:[Object(se.jsx)(ai,{children:i}),Object(se.jsx)(ri,{children:function(){for(var n=[],t=0;t<e.beatLen;t++)n.push(Object(se.jsx)(si,{},t));return n}()})]},n)}))})]})}()},t)}));return Object(se.jsx)(Zt,{children:r})},Zt=d.b.div(_t||(_t=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    overflow-y: auto;\n    \n    &::-webkit-scrollbar {\n        width: 10px;\n        height: 10px;\n    }\n    &::-webkit-scrollbar-thumb {\n        border-radius: 5px;\n        background: #1959A8;\n    }\n    &::-webkit-scrollbar-track {\n        border-radius: 5px;\n        box-shadow: 0 0 4px #aaa inset;\n    }\n"]))),$t=d.b.div(zt||(zt=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 10px);\n    background-color: #e8e4c5;\n    margin: 5px 0 0 5px;\n    box-sizing: border-box;\n    /* border: 1px solid #7e7e7ee8; */\n    text-align: left;\n    ","\n"])),(function(e){return e.isFixed?Object(d.a)(Rt||(Rt=Object(s.a)(["\n        text-align: left;\n    "]))):""})),ei=d.b.div(Bt||(Bt=Object(s.a)(["\n    ","\n    width: 200px;\n    background-color: #b14272;\n    border-radius: 2px 15px 15px 2px;\n    color: white;\n    margin: 5px 0 5px 5px;\n"])),Be.CSS_LABEL_SMALL),ni=(d.b.div(Pt||(Pt=Object(s.a)(["\n    ","\n    width: 120px;\n    background-color: #4297b1;\n    color: white;\n    border-radius: 2px;\n    margin: 5px 0 0 5px;\n"])),Be.CSS_LABEL_SMALL),d.b.div(Kt||(Kt=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    /* background-color: #5b6e69; */\n    margin: 2px 0 0 0;\n    text-align: left;\n    /* padding: 5px 0 0 0; */\n"])),22)),ti=d.b.div(Ut||(Ut=Object(s.a)(["\n    ","\n    width: 90px;\n    background-color: #95b6d1;\n    color: white;\n    border-radius: 8px;\n    margin: 0 0 0 5px;\n"])),Be.CSS_LABEL_SMALL),ii=d.b.select(Vt||(Vt=Object(s.a)(["\n    ","\n    font-weight: inherit;\n    text-align: left;\n    ","\n    width: ","px;\n    margin: 0 0 0 5px;\n    box-sizing: border-box;\n"])),Be.CSS_LABEL_SMALL,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}),(function(e){return e.width})),oi=d.b.div(qt||(qt=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 10px);\n    /* height: 100px; */\n    padding: 0 5px 5px 0;\n    background-color: #c2d6dd1e;\n    border: solid 2px #ab4343;\n    border-radius: 8px;\n    box-sizing: border-box;\n    margin: 5px 0 5px 5px;\n    text-align: left;\n"]))),ci=d.b.div(Ht||(Ht=Object(s.a)(["\n    display: inline-block;\n    height: 45px;\n    background-color: #676767;\n    color: white;\n    border-radius: 2px;\n    margin: 5px 0 0 5px;\n"]))),ai=d.b.div(Jt||(Jt=Object(s.a)(["\n    ","\n    padding: 0 20px;\n    /* background-color: #b38282; */\n    color: white;\n"])),Be.CSS_LABEL_SMALL),ri=d.b.div(Wt||(Wt=Object(s.a)(["\n    display: block;\n    height: 25px;\n    min-width: 100%;\n    /* background-color: #c5adad; */\n    text-align: center;\n"]))),si=d.b.div(Yt||(Yt=Object(s.a)(["\n    display: inline-block;\n    width: 8px;\n    height: calc(100% - 12px);\n    margin: 6px 2px 0 2px;\n    background-color: #ddd796;\n    border-radius: 2px;\n"])));!function(e){e.search=function(e){return console.log(JSON.stringify(e)),n.filter((function(n){return n.condition.beat===e.beat}))};var n=[{name:"major minimum 01 [\u2160\u2192\u2163\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@4 1 4 5 @2 1 5 @4 6 4 5 1")}]},{name:"major minimum 02 [\u2160\u2192\u2164\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@2 1 5 6 3 4 1 2 5 1 5 3n*7 6 2 3 4n*m 1")}]},{name:"minor minimum 01 [\u2165\u2192\u2164\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@2 6 5 4 3n*m7 2n*m7 6 7n*7 3n*7 6")}]},{name:"minor minimum 02 [\u2161m\u2192\u2164\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@2 2n*m7 5 1 6 2n*m7 3n*7 6 6n*7 2n*m7 5 3n*m7 6 2n*m7 3n*7 6n*sus4 6")}]},{name:"major short 01 [\u2160\u2192\u2164\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@2 1 5 6 3n*m7 4 1 2n*m7 5 1 5 6 3 4 1 2n*7 3n*7")},{sectionName:"B",chordList:lt.parseChord("@4 4n*maj7 5 3n*m7 6 4 5 1n*sus4 1")}]},{name:"major short 02 [\u2163\u2192\u2164\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@4 4n*maj7 5 3n*m7 6 2n*m7 5 1 @2 5n*m 1n*7 @4 4n*maj7 5 @2 1 5 @4 6 2n*m7 5 6n*sus4 6n*")}]},{name:"major short 03 [\u2160\u2192\u2165m\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@4 1 1 6 6 4 4 5 5 1 1 6 6 4 4 5 5")},{sectionName:"B",chordList:lt.parseChord("@4 4n*maj7 5 3n*m7 6 4 5 1n*sus4 1")}]},{name:"minor short 01 [\u2165\u2192\u2163\uff5e]",condition:{beat:"4/4"},unitList:[{sectionName:"A",chordList:lt.parseChord("@2 6 4 5 1 6 4 5 1 6 4 5 1 2 3n*m7 4n*maj7 3n*7")},{sectionName:"B",chordList:lt.parseChord("@4 4 5 3 6 2 3 6n*sus4 6")}]}]}(Gt||(Gt={}));var li,di,bi,ui,hi,pi,xi,fi,gi,ji,vi,mi,Oi,ki,yi,Si,wi,Li,Ii,Ai,Ei,Ci,Ti,Mi,Di,Ni,Fi,_i,zi,Ri,Bi,Pi,Ki,Ui,Vi,qi,Hi,Ji,Wi,Yi,Gi,Qi,Xi,Zi,$i,eo,no,to,io,oo,co,ao,ro,so,lo,bo,uo,ho,po,xo,fo,go,jo,vo,mo,Oo,ko,yo,So,wo,Lo,Io,Ao,Eo,Co,To,Mo,Do,No,Fo,_o,zo,Ro,Bo,Po,Ko,Uo,Vo,qo,Ho,Jo,Wo,Yo,Go,Qo,Xo,Zo,$o,ec,nc,tc,ic,oc,cc,ac,rc,sc,lc,dc,bc,uc,hc,pc,xc,fc,gc,jc,vc,mc,Oc,kc,yc,Sc,wc,Lc,Ic,Ac,Ec,Cc,Tc,Mc,Dc,Nc,Fc,_c,zc=Gt,Rc=function(e){var n=Object(o.useContext)(gS),t=(n.store,n.dispatcher,Object(o.useState)(-1)),i=Object(l.a)(t,2),c=i[0],a=i[1],r=zc.search({beat:e.beat}),s=Object(o.useMemo)((function(){return r.map((function(n,t){return Object(se.jsx)(Pc,{isFocus:t===c,onClick:function(){a(t),e.applyProgTemplate(r[t])},children:n.name},t)}))}),[r,c]);return Object(se.jsx)(Bc,{children:s})},Bc=d.b.div(li||(li=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n"]))),Pc=d.b.div(di||(di=Object(s.a)(["\n    ","\n    display: inline-block;\n    width: 100%;\n    background-color: #00000010;\n    ","\n    text-align: left;\n    margin: 2px 0 0 0;\n    padding: 0 0 0 5px;\n    color: #eb0000;\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isFocus?Object(d.a)(bi||(bi=Object(s.a)(["\n        background-color: #f6ff0062;\n    "]))):""})),Kc=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=Object(o.useState)("blank"),a=Object(l.a)(c,2),r=a[0],s=a[1],d=Object(o.useState)(Lt.getBlankBlockList()),b=Object(l.a)(d,2),u=b[0],h=b[1],p=Object(o.useState)(""),x=Object(l.a)(p,2),f=x[0],g=x[1],j=function(){t.systemState.dialog=null,i.system.setState(t.systemState)},m=Object(o.useMemo)((function(){return"blank"===r?[Object(se.jsx)("option",{value:""},0)]:[""].concat(v.BEAT_DEF_LIST).map((function(e,n){return Object(se.jsx)("option",{value:e,children:e},n)}))}),[r]),O=function(e,n,t){var i={type:"section",detail:{sectionName:e,sectionNo:n,chordList:t.map((function(e){var n=Lt.getDefaultChord();return n.beatLen=e.beatLen,n.symbolKey=e.symbolKey,n.root=e.root,n})),backingNo:1}};u.splice(u.length-1,0,i),h(u.slice())},k=function(e){u.splice(0),Lt.getInitialBlockList().forEach((function(e){u.push(e)})),e.unitList.forEach((function(e){O(e.sectionName,"",e.chordList)}))},y=function(e,n,t){return Object(se.jsx)(Qc,{isActive:n,onClick:t,children:e})},S=u.length<=2,w="blank"===r?"":f;return Object(se.jsxs)(Uc,{children:[Object(se.jsxs)(Vc,{children:[y("Blank","blank"===r,(function(){h(Lt.getBlankBlockList()),s("blank")})),y("Custom","custom"===r,(function(){h(Lt.getInitialBlockList()),s("custom")})),y("Template","template"===r,(function(){h(Lt.getInitialBlockList()),s("template")}))]}),Object(se.jsxs)(qc,{children:[Object(se.jsxs)(Hc,{isEnable:"blank"!==r,children:[Object(se.jsxs)(Jc,{children:[Object(se.jsx)(bt._TitleLabel,{children:"Beat"}),Object(se.jsx)(bt._Combobox,{value:w,isEnable:S,width:150,onChange:function(e){!function(e){g(e.target.value)}(e)},children:m})]}),Object(se.jsx)(Wc,{children:function(){switch(r){case"blank":return Object(se.jsx)(se.Fragment,{});case"custom":return Object(se.jsx)(It,{beat:f,unitNum:u.length-2,reset:function(){h(Lt.getInitialBlockList())},insertProgUnit:O});case"template":return Object(se.jsx)(Rc,{beat:f,applyProgTemplate:k})}}()})]}),Object(se.jsx)(Yc,{children:Object(se.jsx)(Xt,{outputUnits:u,updateOutputUnits:function(){h(u.slice())}})})]}),Object(se.jsxs)(Gc,{children:[Object(se.jsx)(Xc,{isEnable:!0,onClick:j,children:"Cancel"}),Object(se.jsx)(Xc,{isEnable:u.length>=3,onClick:function(){var n=Lt.buildScoreData(u);e.setScoreData(n),j(),t.systemState.scoreTabIndex=1,i.system.setState(t.systemState)},children:"Start"})]})]})},Uc=d.b.div(ui||(ui=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: 50px;\n    top: 50px;\n    width: 1024px;\n    height: 768px;\n    z-index: 11;\n    /* top: 100px;\n    left: 100px; */\n    /* width: calc(100% - 200px);\n    height: calc(100% - 200px); */\n    background-color: #929292;\n    border: solid 2px #404250;\n    border-radius: 8px;\n    /* border: 1px solid #dadada; */\n"]))),Vc=d.b.div(hi||(hi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #7d8d97;\n    text-align: center;\n"])),50),qc=d.b.div(pi||(pi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: calc(100% - ","px);\n    /* background-color: #7d8d97; */\n    text-align: left;\n"])),100),Hc=d.b.div(xi||(xi=Object(s.a)(["\n   display: inline-block;\n   vertical-align: top;\n   width: calc(50% - 6px);\n   height: calc(100% - 8px);\n   background-color: #bdced8;\n   text-align: left;\n   margin: 4px 2px 4px 4px;\n   ","\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),Jc=d.b.div(fi||(fi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    /* background-color: #b4c7ba; */\n    padding: 5px 0 0 5px;\n    box-sizing: border-box;\n"])),40),Wc=(d.b.select(gi||(gi=Object(s.a)(["\n    display: inline-block;\n    height: 30px;\n    font-size: ","px;\n    text-align: left;\n    color: black;\n    vertical-align: top;\n    line-height: 24px;\n    width: 210px;\n    box-sizing: border-box;\n    margin: 0 0 0 5px;\n"])),Be.FONT_MIDIUM),d.b.div(ji||(ji=Object(s.a)(["\n    display: inline-block;\n    background-color: #cedbd7;\n    border: 1px solid #696969;\n    box-sizing: border-box;\n    margin: 5px 0 0 5px;\n    width: calc(100% - 10px);\n    height: calc(100% - ","px);\n"])),50)),Yc=d.b.div(vi||(vi=Object(s.a)(["\n    display: inline-block;\n    vertical-align: top;\n    width: calc(50% - 6px);\n    height: calc(100% - 8px);\n    background-color: #bdced8;\n    text-align: left;\n    margin: 4px 4px 4px 2px;\n"]))),Gc=d.b.div(mi||(mi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #d1d1d1;\n    text-align: right;\n    & *{\n        margin: 10px 5px 0 0;\n    }\n"])),50),Qc=d.b.div(Oi||(Oi=Object(s.a)(["\n    ",";\n    background-color: #5083c5;\n    ",";\n    width: 200px;\n    margin: 10px 5px 0 0;\n    text-align: center;\n    border-radius: 4px;\n    border: solid 1px #375176;\n    box-sizing: border-box;\n    &:hover {\n        background-color: #77a7e6;\n    ",";\n}\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isActive?Object(d.a)(ki||(ki=Object(s.a)(["\n        background-color: #c5b950;\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(yi||(yi=Object(s.a)(["\n            background-color: #c5b950;\n    "]))):""})),Xc=d.b.div(Si||(Si=Object(s.a)(["\n    ",";\n    ",";\n    background-color: #5c9253;\n    width: 130px;\n    text-align: center;\n    border-radius: 4px;\n    border: solid 1px #2d5625;\n    box-sizing: border-box;\n    &:hover {\n        background-color: #7eaf75;\n    }\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),Zc=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=Object(o.useState)(null),c=Object(l.a)(i,2),a=c[0],r=c[1],s=n.scoreState.fileHandle,d=n.scoreData,b=n.systemState.scoreTabIndex,x=n.userEnv.login,f=Object(o.useState)(null),g=Object(l.a)(f,2),j=g[0],m=g[1],O=Object(o.useState)(-1),k=Object(l.a)(O,2),S=k[0],w=k[1],L=Object(o.useState)("-"),I=Object(l.a)(L,2),A=I[0],E=I[1],C=Object(o.useState)(""),T=Object(l.a)(C,2),M=T[0],D=T[1];Object(o.useEffect)((function(){N()}),[x]);var N=function(){void 0!=x&&re.a.findUserScoreList(x.seq).then((function(e){m(e.map((function(e){var n=e.seq,t=re.a.getHashedFromScoreSeq(n),i=re.a.getPreviewURL(n);return{seq:n,name:e.dispnam,hash:t,url:i,share:e.share}}))),console.log("load")}))},F=Object(o.useMemo)((function(){var e="-",t="-",i="-",o="-",c="-",r="-",s="-",l="-",u="-",h="-",p="-";if(0===b&&(null!=a&&(e=a.name,t="".concat(a.size.toString()," byte"),i=re.a.getStringFromDate(new Date(a.lastModified))),d.chordList.length>0)){var x=d.chordList[0].detail;o="".concat(v.KEY12_MAJOR_SCALE_LIST[x.keyIndex]," ").concat(x.scale),c=x.bpm.toString(),r=x.beatSignature;var f=0,g=0;d.chordList.forEach((function(e){switch(e.type){case"section":f++;break;case"chord":g++}})),s=f.toString(),l=g.toString();var j=n.scoreState.elementCacheList;if(j.length>0){var m=j[j.length-1];h="".concat(m.pastSecond/1e3,"s"),u="".concat(m.bar," (").concat(m.surplusBeat,")")}p=d.notesList.length.toString()}return[{name:e,size:t,modified:i},{key:o,tempo:c,rate:r,section:s,chord:l,bar:u,time:h,notes:p}]}),[b,d,a]),_=Object(l.a)(F,2),z=_[0],R=_[1];Object(o.useEffect)((function(){0===b&&null!=s&&s.getFile().then((function(e){r(e)}))}),[b]);var B,P,K,U=function(e){n.scoreState.focusIndex=2,n.scoreState.distIndex=n.scoreState.focusIndex,t.score.setScoreState(Object(h.a)({},n.scoreState)),t.score.setScoreData(e),n.scoreData=e,y.updateHarmonizeCache(n,t)},V=function(e,n){return Object(se.jsxs)(ra,{children:[Object(se.jsx)(sa,{children:e}),Object(se.jsx)(la,{children:n})]})},q=function(){n.scoreState.fileHandle=null,t.score.setScoreState(Object(h.a)({},n.scoreState)),n.scoreData=d,y.updateHarmonizeCache(n,t),r(null)},H=null!=s,J=void 0==x?Object(se.jsx)(se.Fragment,{}):null==j?Object(se.jsx)(fa,{children:"Now loading your cloud score..."}):j.map((function(e,n){return Object(se.jsxs)(ga,{isActive:n===S,onClick:function(){w(n);var e=j[n];null!=e&&E(e.name)},children:[Object(se.jsx)(ja,{children:e.name}),Object(se.jsxs)(va,{children:[" [",e.hash,"]"]})]},n)})),W=null==j?null:j[S],Y=d.chordList.length>0&&-1===S,G=d.chordList.length>0,Q=-1!==S;return Object(se.jsxs)($c,{children:[Object(se.jsx)(ha,{children:Object(se.jsx)(pa,{isEnable:!H&&!G,onClick:function(){n.systemState.dialog=Object(se.jsx)(Kc,{setScoreData:U}),t.system.setState(n.systemState)},children:"new score"})}),Object(se.jsxs)(ea,{children:[Object(se.jsx)(na,{children:Object(se.jsxs)(ca,{isEnable:!0,children:[Object(se.jsxs)(ha,{children:[Object(se.jsx)(pa,{isEnable:void 0!=x&&Y,onClick:function(){if(m(null),void 0!=x&&null!=j){var e="new [".concat(x.id,"] score");re.a.sendQueryRequestToAPI("update","INSERT INTO scoretbl(user_seq, dispnam, data)\n                VALUES(".concat(x.seq,", '").concat(e,"', '").concat(re.a.gZip(JSON.stringify(d)),"')\n            ")).then((function(){w(j.length),E(e),N()}))}},children:"upload"}),Object(se.jsx)(pa,{isEnable:void 0!=x&&Q,onClick:function(){w(-1)},children:"release"})]}),Object(se.jsx)(xa,{isEnable:void 0!=x,children:J}),Object(se.jsxs)(ha,{children:[Object(se.jsx)(pa,{isEnable:void 0!=x&&Q&&G,onClick:function(){m(null),null!=W&&re.a.sendQueryRequestToAPI("update","\n                UPDATE scoretbl SET\n                dispnam = '".concat(A,"',\n                share = '").concat(M,"',\n                lastmod = datetime('now', 'localtime'),\n                data = '").concat(re.a.gZip(JSON.stringify(d)),"'\n                WHERE seq = ").concat(W.seq,"\n            ")).then((function(){N()}))},children:"overwrite"}),Object(se.jsx)(pa,{isEnable:void 0!=x&&Q&&!G,onClick:function(){void 0!=W&&re.a.findScore(W.seq).then((function(e){if(e.length>0){var n=e[0].data,t=re.a.unZip(n);U(JSON.parse(t))}}))},children:"download"}),Object(se.jsx)(pa,{isEnable:void 0!=x&&Q,onClick:function(){m(null),null!=W&&re.a.sendQueryRequestToAPI("update","DELETE FROM scoretbl WHERE seq = ".concat(W.seq,"\n            ")).then((function(){w(-1),N()}))},children:"delete"})]})]})}),Object(se.jsxs)(ta,{children:[Object(se.jsxs)(ha,{children:[Object(se.jsx)(pa,{isEnable:!H&&!G,onClick:function(){Object(p.a)(u.a.mark((function e(){var t,i,o,c,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker();case 2:return t=e.sent,i=Object(l.a)(t,1),o=i[0],e.next=7,o.getFile();case 7:return c=e.sent,e.next=10,c.text();case 10:a=e.sent,n.scoreState.fileHandle=o,r(c),s=re.a.unZip(a),console.log(s),U(JSON.parse(s));case 16:case"end":return e.stop()}}),e)})))()},children:"load file"}),Object(se.jsx)(pa,{isEnable:H,onClick:q,children:"disconnect"}),Object(se.jsx)(pa,{isEnable:G,onClick:function(){t.score.clearCache(),H&&q(),t.score.setScoreData({notesList:[],chordList:[]})},children:"clear"})]}),Object(se.jsxs)(ia,{isEnable:H,children:[Object(se.jsx)(aa,{children:"Local"}),V("file",z.name),V("size",z.size),V("last",z.modified)]}),Object(se.jsxs)(ia,{isEnable:-1!==S,children:[Object(se.jsx)(aa,{children:"Cloud"}),(B="name",P=null==W?"-":A,K=function(e){E(e.target.value)},Object(se.jsxs)(ra,{children:[Object(se.jsx)(sa,{children:B}),Object(se.jsx)(ba,{type:"text",value:P,isEnable:-1!==S,onChange:K})]})),Object(se.jsxs)(ra,{children:[Object(se.jsx)(sa,{children:"url"}),Object(se.jsx)(da,{onContextMenu:function(){navigator.clipboard.writeText(null==W?"-":W.url).then((function(){alert("Copied clipboad!")}))},children:null==W?"-":W.url})]}),Object(se.jsxs)(ra,{children:[Object(se.jsx)(sa,{children:"share"}),Object(se.jsxs)(ua,{isEnable:-1!==S,value:M,onChange:function(e){D(e.target.value)},children:[Object(se.jsx)("option",{value:"url",children:"URL only"}),Object(se.jsx)("option",{value:"free",children:"Home publish"}),Object(se.jsx)("option",{value:"dl",children:"Download OK"})]})]})]}),Object(se.jsxs)(oa,{isEnable:G,children:[Object(se.jsx)(aa,{children:"SCORE"}),V("key",R.key),V("tempo",R.tempo),V("rate",R.rate),V("section",R.section),V("chord",R.chord),V("bar",R.bar),V("time",R.time),V("notes",R.notes)]})]})]})]})},$c=d.b.div(wi||(wi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    background-color: #7e7e7e;\n    text-align: left;\n"]))),ea=d.b.div(Li||(Li=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: calc(100% - 40px);\n"]))),na=d.b.div(Ii||(Ii=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 50%;\n    height: 100%;\n    /* background-color: #8a6b6b; */\n    text-align: left;\n    vertical-align: top;\n"]))),ta=d.b.div(Ai||(Ai=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 50%;\n    height: 100%;\n    /* background-color: #969696; */\n    text-align: left;\n    vertical-align: top;\n"]))),ia=(d.b.div(Ei||(Ei=Object(s.a)(["\n    \n    display: inline-block;\n    width: calc(100% - 50px);\n    height: 50px;\n    margin: 20px 25px;\n    border: 2px solid #cacaca;\n    /* background: linear-gradient(to bottom, #585858, #a7a7a7, #585858); */\n    background-color: #000;\n    color: #ccc;\n    font-size: 30px;\n    font-weight: 600;\n    text-align: left;\n    box-sizing: border-box;\n    padding-left: 20px;\n    border-radius: 6px;\n\n    &:hover {\n        background-color: #616161;\n    }\n"]))),d.b.div(Ci||(Ci=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: calc(100% - 8px);\n    margin: 4px 0 4px 4px;\n    height: calc(100% - 48px);\n    background-color: #ffffff;\n    box-sizing: border-box;\n    color: #060053;\n"]))),d.b.div(Ti||(Ti=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: ","px;\n    margin: 4px 0 4px 4px;\n    background-color: #9da5af;\n    border: solid 1px #1b00b3;\n    ","\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: #060053;\n"])),180,(function(e){return e.isEnable?"":Object(d.a)(Mi||(Mi=Object(s.a)(["\n        opacity: 0.3;\n    "])))}))),oa=d.b.div(Di||(Di=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - ","px);\n    margin: 0 0 4px 4px;\n    background-color: #acacac;\n    border: solid 1px #1b00b3;\n    ","\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: #060053;\n    overflow: hidden;\n"])),420,(function(e){return e.isEnable?"":Object(d.a)(Ni||(Ni=Object(s.a)(["\n        opacity: 0.3;\n    "])))})),ca=d.b.div(Fi||(Fi=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    margin: 4px 0 4px 4px;\n    background-color: #acacac;\n    border: solid 1px #1b00b3;\n    ","\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: #060053;\n    overflow: hidden;\n"])),(function(e){return e.isEnable?"":Object(d.a)(_i||(_i=Object(s.a)(["\n        opacity: 0.3;\n    "])))})),aa=d.b.div(zi||(zi=Object(s.a)(["\n    display: inline-block;\n    height: 40px;\n    font-size: 30px;\n    font-weight: 600;\n    color: #1c2c95;\n    /* background-color: #3f80cf57; */\n    padding: 0 10px;\n"]))),ra=d.b.div(Ri||(Ri=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 35px;\n    /* background-color: #3fcf7b56; */\n    padding: 4px 0 0 10px;\n"]))),sa=d.b.div(Bi||(Bi=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: 140px;\n    font-size: 24px;\n    line-height: 24px;\n    font-weight: 600;\n    color: #08106e;\n    border: solid 1px #1b00b3;\n    box-sizing: border-box;\n    /* background-color: #85a2c5; */\n    background: linear-gradient(to bottom, #8a98a7, #a3bbd2, #8a98a7);\n    border-radius: 4px;\n    text-align: center;\n    vertical-align: top;\n"]))),la=d.b.div(Pi||(Pi=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #ffffff;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #808080;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n    white-space: nowrap;\n    overflow: hidden;\n"]))),da=d.b.div(Ki||(Ki=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 18px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #01f52a;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #808080;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n    white-space: nowrap;\n    overflow: hidden;\n"]))),ba=d.b.input(Ui||(Ui=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #1f1f1f;\n    border: solid 1px #000;\n    ","\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),ua=d.b.select(Vi||(Vi=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #1f1f1f;\n    border: solid 1px #000;\n    ","\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),ha=d.b.div(qi||(qi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    /* background-color: #888888; */\n    box-sizing: border-box;\n    text-align: left;\n    white-space: nowrap;\n"]))),pa=d.b.div(Hi||(Hi=Object(s.a)(["\n    ","\n    /* width: 160px; */\n    padding: 0 40px;\n    /* line-height: 25px; */\n    box-sizing: border-box;\n    background-color: #a8a8a8;\n    background: linear-gradient(to bottom, #787878, #b4b4b4, #787878);\n    border: 1px solid #1a2b3f;\n    color: #1a2b3f;\n    border-radius: 4px;\n    margin: 5px 0 0 4px;\n    ","\n    &:hover {\n        /* background-color: #98bfc2; */\n    background: linear-gradient(to bottom, #989898, #b4b4b4, #989898);\n    }\n"])),Ke,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),xa=d.b.div(Ji||(Ji=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - 92px);\n    margin: 4px 0 0 4px;\n    background-color: #d3d3c5;\n    border: 1px solid #e60000;\n    border-radius: 4px;\n    box-sizing: border-box;\n    ","\n"])),(function(e){return e.isEnable?"":Object(d.a)(Wi||(Wi=Object(s.a)(["\n        opacity: 0.3;\n        pointer-events: none;\n    "])))})),fa=d.b.div(Yi||(Yi=Object(s.a)(["\n    display: inline-block;\n    color: #d60000;\n    font-size: 24px;\n    /* font-weight: 600; */\n    /* background-color: white; */\n    margin: 0 0 0 4px;\n"]))),ga=d.b.div(Gi||(Gi=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    font-size: 28px;\n    font-weight: 600;\n    border-bottom: 1px solid #888888;\n    /* background-color: white; */\n    background: linear-gradient(to bottom, transparent, #b6b6b684);\n    ","\n    margin: 2px 0 0 0;\n    padding: 0 0 0 4px;\n    box-sizing: border-box;\n    padding-left: 4px;\n    overflow: hidden;\n    white-space: nowrap;\n    &:hover {\n        background: linear-gradient(to bottom, transparent, #ffffff5c);\n        ","\n    }\n"])),(function(e){return e.isActive?Object(d.a)(Qi||(Qi=Object(s.a)(["\n        background: linear-gradient(to bottom, transparent, #fdff8484);\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(Xi||(Xi=Object(s.a)(["\n            background: linear-gradient(to bottom, transparent, #feffcd99);\n        "]))):""})),ja=d.b.span(Zi||(Zi=Object(s.a)([" color: #00532c; "]))),va=d.b.span($i||($i=Object(s.a)([" color: #b9000042; "]))),ma=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=t.scoreState,a=t.scoreData.chordList[c.focusIndex].detail;Object(o.useEffect)((function(){var e=v.getSymbolFromKey(a.symbolKey),n=null==e.base?null:v.getSymbolFromKey(e.base),t=[],o=[],r=[],s=0;if(null==n)t.push("major"),t.push("minor"),t.push("suspend4th"),t.push("diminish"),t.push("augument"),t.push("minor-minus5");else{v.SYMBOL_LIST.forEach((function(e){e.key===n.key&&o.push(e.key)}));var l=v.getSymbolDerives(n.key);v.SYMBOL_LIST.forEach((function(e){l.includes(e.key)&&t.push(e.key)}))}t.forEach((function(e,n){e===a.symbolKey&&(s=n)}));var d=v.getSymbolDerives(e.key);v.SYMBOL_LIST.forEach((function(e){d.includes(e.key)&&r.push(e.key)})),c.symbolMng={index:s,curLine:t,parentLine:o,childrenLine:r},i.score.setScoreState(c)}),[a.symbolKey]);var r=c.symbolMng,s=[],l=[],d=[];return null!=r&&(s.push(Object(se.jsx)(ya,{children:"Base"},s.length)),r.parentLine.forEach((function(e,n){var t=v.getSymbolFromKey(e);s.push(Object(se.jsxs)(Sa,{isActive:!1,children:["[",null===t||void 0===t?void 0:t.name,"]"]},s.length))})),l.push(Object(se.jsx)(ya,{children:"Current"},l.length)),r.curLine.forEach((function(e,n){var t=v.getSymbolFromKey(e);l.push(Object(se.jsxs)(Sa,{isActive:r.index===n,children:["[",null===t||void 0===t?void 0:t.name,"]"]},l.length))})),d.push(Object(se.jsx)(ya,{children:"Derives"},d.length)),r.childrenLine.forEach((function(e,n){var t=v.getSymbolFromKey(e);d.push(Object(se.jsxs)(Sa,{isActive:!1,children:["[",null===t||void 0===t?void 0:t.name,"]"]},d.length))}))),Object(se.jsxs)(Oa,{children:[Object(se.jsx)(ka,{children:s}),Object(se.jsx)(ka,{children:l}),Object(se.jsx)(ka,{children:d})]})},Oa=d.b.div(eo||(eo=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 30;\n    top: 100px;\n    left: 0;\n    width: 250px;\n    height: 160px;\n    background-color: #a9cfd422;\n    border: 2px solid #000000ec;\n    box-sizing: border-box;\n    text-align: center;\n    opacity: 0.9;\n    box-shadow: 0 4px 16px 4px #000b3a48;\n    backdrop-filter: blur(6px);\n"]))),ka=d.b.div(no||(no=Object(s.a)(["\n    display: inline-block;\n    width: 80px;\n    height: 100%;\n    /* background-color: #e6e6e6; */\n    margin: 1px;\n    vertical-align: top;\n"]))),ya=d.b.div(to||(to=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 20px;\n    box-sizing: border-box;\n    /* background-color: #78dab4;\n    border: 1px solid #000000; */\n    background: linear-gradient(to bottom, #7a9ea3, #78cfda, #7a9ea3);\n    /* background: linear-gradient(to bottom, #a37a7a, #da7878, #a37a7a); */\n    margin: 1px;\n\n    font-size: 16px;\n    font-weight: 600;\n    color: #f3f3f3;\n    line-height: 17px;\n"]))),Sa=d.b.div(io||(io=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 2px);\n    height: 20px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    ","\n    border: 1px solid #000000;\n    margin: 1px;\n\n    font-size: 16px;\n    font-weight: 600;\n    color: #000000;\n    line-height: 16px;\n"])),(function(e){return e.isActive?Object(d.a)(oo||(oo=Object(s.a)(["background-color: #ffef64;"]))):""})),wa=function(e){var n,t=Object(o.useContext)(gS),i=t.store,c=(t.dispatcher,i.scoreState),a=(i.scoreData.chordList[e.index],c.elementCacheList[e.index]),r=null===(n=v.getSymbolFromKey(e.detail.symbolKey))||void 0===n?void 0:n.name,s=null,l=null;null!=e.detail.root&&(v.getDegreeRoot({index:e.detail.root.index,isFlat:e.detail.root.isFlat}),s=v.getRootName({index:e.detail.root.index,isFlat:v.isFlat(a.keyIndex,a.scale)},a.keyIndex),null!=e.detail.on&&(v.getDegreeRoot({index:e.detail.on.index,isFlat:e.detail.on.isFlat}),l=v.getRootName({index:e.detail.on.index,isFlat:e.detail.on.isFlat},a.keyIndex)));var d=-1,b=c.elementCacheList[e.index-1];3!==e.index&&b.bar===a.bar||(d=a.bar+1);var u=-1!==d&&0!==a.surplusBeat,h="-";null!=s&&(h="".concat(s).concat(r),null!=l&&(h+="/".concat(l)));var p="";if(0!==a.minute)switch(a.minute){case 1:p="\u2192/16";break;case 2:p="\u2192/8";break;case-1:p="\u2190/16";break;case-2:p="\u2190/8"}return Object(se.jsxs)(Ea,{children:[Object(se.jsx)(Ca,{children:h}),Object(se.jsxs)(Ta,{children:[Object(se.jsx)(La,{isError:u,children:-1===d?Object(se.jsx)(se.Fragment,{children:"\xa0"}):d}),Object(se.jsxs)(Aa,{children:[Object(se.jsx)("span",{children:0===a.surplusBeat?Object(se.jsx)(se.Fragment,{children:"\xa0"}):a.surplusBeat}),0===a.minute?"":p]}),Object(se.jsxs)(Ia,{children:[Math.round(a.pastSecond/100)/10,"s"]})]})]})},La=d.b.div(co||(co=Object(s.a)(["\n    font-size: 12px;\n    font-weight: 600;\n    color: #c72929;\n    ","\n    box-sizing: border-box;\n"])),(function(e){return e.isError?Object(d.a)(ao||(ao=Object(s.a)(["\n        background-color: #ee5959;\n        color: #ffffff;\n        /* border: 2px solid #c72929; */\n        border-radius: 2px;\n    "]))):""})),Ia=d.b.div(ro||(ro=Object(s.a)(["\n    font-size: 12px;\n    font-weight: 600;\n    color: #000000a0;\n    box-sizing: border-box;\n"]))),Aa=d.b.div(so||(so=Object(s.a)([""]))),Ea=d.b.div(lo||(lo=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 4;\n    width: 100%;\n    height: 50px;\n    // background-color: #00ff2a11;\n    bottom: 0;\n    left: 0;\n    box-sizing: border-box;\n    text-align: center;\n    box-sizing: border-box;\n"]))),Ca=d.b.div(bo||(bo=Object(s.a)(["\n    display: inline-block;\n    // width: calc(100% - ","px);\n    width: 100%;\n    height: 18px;\n    // background-color: #ffc4001c;\n    font-size: 12px;\n    font-weight: 600;\n    color: #2b2b2b;\n"])),60),Ta=(d.b.div(uo||(uo=Object(s.a)(["\n    display: inline-block;\n    width: 56px;\n    height: 30px;\n    background-color: #1100ff1c;\n"]))),d.b.div(ho||(ho=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 5;\n    width: ","px;\n    height: 100%;\n    // background-color: #0000ff11;\n    top: 0;\n    left: -","px;\n    box-sizing: border-box;\n    text-align: center;\n    \n    & "," {\n    }\n    & "," {\n        font-size: 12px;\n        color: #333;\n        & span {\n            color: #00a;\n            font-weight: 600;\n        }\n    }\n"])),50,25,La,Aa)),Ma=function(e){var n=Object(o.useContext)(gS),t=n.store,i=(n.dispatcher,t.scoreState),c=i.elementCacheList[e.index].sectionNo,a=i.sectionCacheList[c],r=Math.floor(a.beatSum/4),s=a.beatSum%4;return Object(se.jsxs)(Da,{children:[Object(se.jsxs)(Na,{children:[r,0===s?"":" (".concat(s,")")]}),Object(se.jsx)(Fa,{})]})},Da=d.b.div(po||(po=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 4;\n    width: 100%;\n    height: 50px;\n    /* background-color: #ff000011; */\n    bottom: 0;\n    left: 0;\n    box-sizing: border-box;\n    text-align: center;\n    box-sizing: border-box;\n"]))),Na=d.b.div(xo||(xo=Object(s.a)(["\n    display: block;\n    position: relative;\n    /* min-width: 80px; */\n    height: 16px;\n    font-size: 14px;\n    font-weight: 600;\n    color: #474386cf;\n    text-align: center;\n    line-height: 16px;\n    /* background-color: #00000042; */\n"]))),Fa=d.b.div(fo||(fo=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 8px;\n    height: calc(100% - 16px);\n    background-color: #db0000cf;\n    border-radius: 4px 4px 0 0;\n"]))),_a=function(e){var n=e.detail.alterType;return Object(se.jsxs)(za,{children:[Object(se.jsx)(Ba,{children:null==n?"alter":n}),Object(se.jsx)(Pa,{children:function(){var t="-";if(null!=n)switch(n){case"modulate":var i=e.detail.modRel;if(null!=i)switch(i){case"domm":var o=e.detail.dommVal,c=o>0?"+":"";t="".concat(i,": ").concat(c).concat(o);break;case"relative":case"parallel":t=i;break;case"key":var a=e.detail.keyAdj,r=a>0?"+":"";t="".concat(i,": ").concat(r).concat(a)}break;case"tempo":var s=e.detail.tempoRel;switch(s){case"diff":var l=e.detail.tempoDiff,d=l>0?"+":"";t="".concat(s,": ").concat(d).concat(l);break;case"rate":t="".concat(s,": ").concat(e.detail.tempoRate,"%");break;case"abs":t="".concat(s,": ").concat(e.detail.tempoAbs)}}return t}()})]})},za=d.b.div(go||(go=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    /* background-color: red; */\n"]))),Ra=d.b.div(jo||(jo=Object(s.a)(["\n    display: block;\n    position: relative;\n    min-width: 100px;\n    height: 20px;\n    font-size: 16px;\n    font-weight: 600;\n    text-align: center;\n    line-height: 20px;\n    /* background-color: #1000eb42; */\n    margin-top: 3px;\n"]))),Ba=Object(d.b)(Ra)(vo||(vo=Object(s.a)(["\n    color: #0014cc;\n"]))),Pa=Object(d.b)(Ra)(mo||(mo=Object(s.a)(["\n    color: #5e5e5e;\n"]))),Ka=function(e){var n,t,i=e.detail.minute,c=v.getSymbolFromKey(e.detail.symbolKey).name,a=e.detail.backing,r=e.cache,s=e.chordCacheList[r.chordBlockNo],l=void 0!=s&&s.backingError;return Object(o.useMemo)((function(){var n=null,t=null;null!=e.detail.root&&(n=v.getDegreeRoot({index:e.detail.root.index,isFlat:e.detail.root.isFlat}),v.getRootName({index:e.detail.root.index,isFlat:e.detail.root.isFlat},e.keyIndex),null!=e.detail.on&&(t=v.getDegreeRoot({index:e.detail.on.index,isFlat:e.detail.on.isFlat}),v.getRootName({index:e.detail.on.index,isFlat:e.detail.root.isFlat},e.keyIndex)));var o=v.getDiatonicDegreeList(e.scale).includes(n+c);return Object(se.jsxs)(Ua,{children:[Object(se.jsx)(Ja,{isSwitch:e.isSustainMode,scaleRelation:null!=n&&o?"diatonic":"none",isOnChordScale:null!=e.detail.on&&[0,2,4,5,7,9,11].includes(e.detail.on.index),children:null==n?"none":Object(se.jsx)(se.Fragment,{children:Object(se.jsxs)(Va,{children:[n,c,null==t?"":"/".concat(t)]})})}),Object(se.jsx)(Wa,{isSwitch:e.isSustainMode,children:function(){for(var n=[],t=0;t<e.detail.beatLen;t++){var o="normal",c=0;if([0,e.detail.beatLen-1].includes(t)){var a=0===t?i.head:i.tail;0!==a&&(o=a>0?"long":"short",c=Math.abs(a))}n.push(Object(se.jsx)(Ya,{lenType:o,valueType:c},t))}return n}()}),Object(se.jsx)(Ga,{children:l?Object(se.jsx)(Qa,{}):Object(se.jsxs)(se.Fragment,{children:[0===a.voicingList.length?"":Object(se.jsx)(Xa,{}),0===a.voicingList.length||null==a.pattern?"":Object(se.jsx)(Za,{})]})})]})}),[e.scale,e.isCurrent,e.detail.beatLen,null===(n=e.detail.root)||void 0===n?void 0:n.index,null===(t=e.detail.on)||void 0===t?void 0:t.index,e.detail.symbolKey,e.isSustainMode,e.keyIndex,e.detail.minute.head,e.detail.minute.tail,e.detail.backing,l])},Ua=d.b.div(Oo||(Oo=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    /* border: 1px solid #c5c5cc; */\n    /* padding: 4px; */\n    box-sizing: border-box;\n    /* background-color: #00000013; */\n"]))),Va=d.b.div(ko||(ko=Object(s.a)([""]))),qa=d.b.div(yo||(yo=Object(s.a)([""]))),Ha=d.b.div(So||(So=Object(s.a)([""]))),Ja=d.b.div(wo||(wo=Object(s.a)(["\n    display: block;\n    /* width: 100%; */\n    height: 25px;\n    /* background-color: #f700d616; */\n    ","\n    font-size: 18px;\n    /* color: #4e516394; */\n    text-align: center;\n\n    & * {\n        display: inline-block;\n    }\n\n    & "," {\n        color: #4e5163cc;\n        ","\n        font-weight: 600;\n    }\n    & "," {\n        color: #4e5163cc;\n        ","\n    }\n    & "," {\n        color: #4e5163cc;\n        ","\n        font-weight: 600;\n    }\n"])),(function(e){return e.isSwitch?Object(d.a)(Lo||(Lo=Object(s.a)(["background-color: #0004f729;"]))):""}),Va,(function(e){return"diatonic"===e.scaleRelation?Object(d.a)(Io||(Io=Object(s.a)(["color: #4e516394;"]))):"secondaly"===e.scaleRelation?Object(d.a)(Ao||(Ao=Object(s.a)(["color: #00116e93;"]))):Object(d.a)(Eo||(Eo=Object(s.a)(["color: #70000093;"])))}),qa,(function(e){return"diatonic"===e.scaleRelation?Object(d.a)(Co||(Co=Object(s.a)(["color: #4e516394;"]))):"secondaly"===e.scaleRelation?Object(d.a)(To||(To=Object(s.a)(["color: #00116e93;"]))):Object(d.a)(Mo||(Mo=Object(s.a)(["color: #70000093;"])))}),Ha,(function(e){return e.isOnChordScale?"":Object(d.a)(Do||(Do=Object(s.a)(["color: #70000093;"])))})),Wa=(d.b.div(No||(No=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 22px;\n    /* background-color: #d37979b2; */\n    font-size: 14px;\n    /* font-weight: 600; */\n    color: #9c5f74;\n    text-align: center;\n"]))),d.b.div(Fo||(Fo=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 18px;\n    ","\n    /* background-color: #d8ccccb1; */\n    text-align: center;\n"])),(function(e){return e.isSwitch?Object(d.a)(_o||(_o=Object(s.a)(["background-color: #0004f729;"]))):""}))),Ya=d.b.div(zo||(zo=Object(s.a)(["\n    display: inline-block;\n    width: 8px;\n    ","\n    height: calc(100% - 4px);\n    margin: 2px 2px 0 2px;\n    background-color: #e0e0e088;\n    ","\n    /* background: linear-gradient(to bottom, #9b9b9bc3, #85858514); */\n    border: solid 1px #0000004e;\n    /* border-radius: 2px; */\n    box-sizing: border-box;\n"])),(function(e){return"short"===e.lenType?Object(d.a)(Ro||(Ro=Object(s.a)(["\n        width: 4px;\n    "]))):"long"===e.lenType?Object(d.a)(Bo||(Bo=Object(s.a)(["\n        width: 12px;\n    "]))):""}),(function(e){return 2===e.valueType?Object(d.a)(Po||(Po=Object(s.a)(["\n        background-color: #db828287;\n    "]))):1===e.valueType?Object(d.a)(Ko||(Ko=Object(s.a)(["\n        background-color: #9394dd87;\n    "]))):""})),Ga=d.b.div(Uo||(Uo=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 6px;\n    /* background-color: #00a048; */\n    text-align: center;\n"]))),Qa=d.b.div(Vo||(Vo=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    margin-top: 2px;\n    height: 4px;\n    border-radius: 4px;\n    background-color: #af3838;\n"]))),Xa=d.b.div(qo||(qo=Object(s.a)(["\n    display: inline-block;\n    width: 40%;\n    margin: 2px 2px 0 0;\n    height: 4px;\n    border-radius: 4px 0 0 4px;\n    border: solid 1px #0000004e;\n    background-color: #acb6ca;\n"]))),Za=d.b.div(Ho||(Ho=Object(s.a)(["\n    display: inline-block;\n    width: 40%;\n    margin: 2px 0 0 2px;\n    height: 4px;\n    border-radius: 0 4px 4px 0;\n    border: solid 1px #0000004e;\n    background-color: #accab3;\n"]))),$a=function(e){var n=e.detail.fixed;return Object(se.jsx)(er,{isStart:"Start"===n,children:Object(se.jsx)(nr,{children:n})})},er=d.b.div(Jo||(Jo=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 80px;\n    height: calc(100% - ","px);\n    border-left: 1px solid #00000083;\n    border-top: 1px solid #00000083;\n    border-right: 1px solid #00000083;\n    /* border: 1px solid #00000083; */\n    box-sizing: border-box;\n    background-color: #9b9b9b1f;\n    ","\n"])),15,(function(e){return e.isStart?Object(d.a)(Wo||(Wo=Object(s.a)(["\n        border-radius: 0 35px 0 0;\n    "]))):Object(d.a)(Yo||(Yo=Object(s.a)(["\n        border-radius: 35px 0 0 0;\n    "])))})),nr=d.b.div(Go||(Go=Object(s.a)(["\n    display: inline-block;\n    /* width: calc(100% - 10px); */\n    width: 100%;\n    height: 48px;\n    /* background-color: #47438678; */\n    font-size: 26px;\n    font-weight: 600;\n    font-style: italic;\n    line-height: 46px;\n    color: #960000b0;\n    text-align: center;\n    margin-top: 30px;\n    /* vertical-align: middle; */\n"]))),tr=function(e){return Object(se.jsxs)(ir,{children:[Object(se.jsxs)(or,{children:[Object(se.jsx)(cr,{children:"Scale:"}),Object(se.jsx)(ar,{children:e.detail.scale})]}),Object(se.jsxs)(or,{children:[Object(se.jsx)(cr,{children:"Key:"}),Object(se.jsx)(ar,{children:v.KEY12_MAJOR_SCALE_LIST[e.detail.keyIndex]})]}),Object(se.jsxs)(or,{children:[Object(se.jsx)(cr,{children:"tempo:"}),Object(se.jsx)(ar,{children:e.detail.bpm})]}),Object(se.jsxs)(or,{children:[Object(se.jsx)(cr,{children:"Rate:"}),Object(se.jsx)(ar,{children:e.detail.beatSignature})]})]})},ir=d.b.div(Qo||(Qo=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100px;\n"]))),or=d.b.div(Xo||(Xo=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100px;\n    height: 16px;\n    margin: 1px 0;\n    /* background-color: #0066ff16; */\n    /* border-bottom: 1px solid #000; */\n    font-size: 12px;\n    font-weight: 600;\n    color: #2a2a2c;\n    line-height: 16px;\n"]))),cr=d.b.div(Zo||(Zo=Object(s.a)(["\n    display: inline-block;\n    margin: 0 2px;\n    width: 50px;\n    height: 100%;\n    color: #14a800;\n    /* background-color: #ff00b329; */\n"]))),ar=d.b.div($o||($o=Object(s.a)(["\n    display: inline-block;\n    margin: 0 2px;\n    width: 40px;\n    height: 100%;\n    color: #000000;\n    /* background-color: #ff00b329; */\n"]))),rr=function(e){return Object(se.jsx)(sr,{children:Object(se.jsx)(lr,{children:e.detail.labelName})})},sr=d.b.div(ec||(ec=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    position: relative;\n    /* width: 100px; */\n    text-align: center;\n    border: 1px;\n    /* border: 1px solid #c5c5cc; */\n"]))),lr=d.b.div(nc||(nc=Object(s.a)(["\n    display: block;\n    position: relative;\n    min-width: 80px;\n    height: 20px;\n    font-size: 18px;\n    font-weight: 600;\n    color: #c00;\n    text-align: center;\n    line-height: 20px;\n    /* background-color: #1000eb42; */\n    margin-top: 13px;\n"]))),dr=function(e){return Object(se.jsxs)(br,{children:[Object(se.jsx)(hr,{children:function(){switch(e.detail.alterType){case"modulate":return"Key";case"tempo":return"Tempo";case"beat":return"Beat"}}()}),Object(se.jsx)(pr,{children:function(){switch(e.detail.alterType){case"modulate":var n=v.KEY12_SHARP_LIST[e.prevCache.keyIndex]+("major"===e.prevCache.scale?"":"m"),t=v.KEY12_SHARP_LIST[e.curCache.keyIndex]+("major"===e.curCache.scale?"":"m");return"".concat(n,"\u2192").concat(t);case"tempo":var i=e.prevCache.bpm,o=e.curCache.bpm;return"".concat(i,"\u2192").concat(o);case"beat":var c=e.prevCache.beatSignature,a=e.curCache.beatSignature;return"".concat(c,"\u2192").concat(a)}}()})]})},br=d.b.div(tc||(tc=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 4;\n    width: 100%;\n    height: 50px;\n    /* background-color: #ff000011; */\n    bottom: 0;\n    left: 0;\n    box-sizing: border-box;\n    text-align: center;\n    box-sizing: border-box;\n"]))),ur=d.b.div(ic||(ic=Object(s.a)(["\n    display: block;\n    position: relative;\n    /* min-width: 80px; */\n    height: 16px;\n    font-size: 14px;\n    font-weight: 600;\n    text-align: center;\n    line-height: 16px;\n    /* background-color: #00000042; */\n"]))),hr=Object(d.b)(ur)(oc||(oc=Object(s.a)(["\n    color: #0b00a8cf;\n"]))),pr=Object(d.b)(ur)(cc||(cc=Object(s.a)(["\n    color: #050505cf;\n"]))),xr=function(e){var n=Object(o.useContext)(gS),t=n.store,i=(n.dispatcher,t.scoreState),c=t.scoreData.chordList[i.focusIndex].detail;Object(o.useEffect)((function(){}),[c.root,c.symbolKey]);var a=function(e,n,t){return{root:{index:e,isFlat:n},symbolKey:t}},r=function(e,n){var t=[];return t.push(Object(se.jsx)(jr,{children:e},t.length)),n.forEach((function(e){var n=v.getDegreeRoot(e.root),i=v.getSymbolFromKey(e.symbolKey).name;t.push(Object(se.jsx)(vr,{isActive:!1,children:n+i},t.length))})),Object(se.jsx)(gr,{children:t})};return Object(se.jsxs)(fr,{children:[r(Object(se.jsx)(se.Fragment,{children:"triad"}),[a(0,!1,"major"),a(2,!1,"minor"),a(4,!1,"minor"),a(5,!1,"major"),a(7,!1,"major"),a(9,!1,"minor"),a(11,!1,"minor-minus5")]),r(Object(se.jsx)(se.Fragment,{children:"domm"}),[a(9,!1,"major-min7th"),a(11,!1,"major-min7th"),a(0,!1,"major-min7th"),a(2,!1,"major-min7th"),a(4,!1,"major-min7th")]),r(Object(se.jsx)(se.Fragment,{children:"domm*"}),[a(1,!1,"diminish"),a(3,!1,"diminish"),a(4,!1,"diminish"),a(6,!1,"diminish"),a(8,!1,"diminish")])]})},fr=d.b.div(ac||(ac=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 30;\n    top: 100px;\n    left: 0;\n    width: 250px;\n    /* height: 160px; */\n    background-color: #a9cfd422;\n    border: 2px solid #000000ec;\n    box-sizing: border-box;\n    text-align: center;\n    opacity: 0.9;\n    box-shadow: 0 4px 16px 4px #000b3a48;\n    backdrop-filter: blur(6px);\n"]))),gr=d.b.div(rc||(rc=Object(s.a)(["\n    display: inline-block;\n    width: 80px;\n    /* height: 100%; */\n    /* background-color: #e6e6e6; */\n    margin: 1px;\n    vertical-align: top;\n"]))),jr=d.b.div(sc||(sc=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 20px;\n    box-sizing: border-box;\n    /* background-color: #78dab4;\n    border: 1px solid #000000; */\n    background: linear-gradient(to bottom, #7a9ea3, #78cfda, #7a9ea3);\n    /* background: linear-gradient(to bottom, #a37a7a, #da7878, #a37a7a); */\n    margin: 1px;\n\n    font-size: 16px;\n    font-weight: 600;\n    color: #f3f3f3;\n    line-height: 17px;\n"]))),vr=d.b.div(lc||(lc=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 2px);\n    height: 20px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    ","\n    border: 1px solid #000000;\n    margin: 1px;\n\n    font-size: 16px;\n    font-weight: 600;\n    color: #000000;\n    line-height: 16px;\n"])),(function(e){return e.isActive?Object(d.a)(dc||(dc=Object(s.a)(["background-color: #ffef64;"]))):""})),mr=function(e){var n=Object(o.useRef)({}),t=Object(o.useRef)({}),i=e.state,c=i.keySwitch,a=i.focusIndex==e.index,r=e.element,s=i.elementCacheList[e.index],l=i.focusIndex<i.distIndex?i.focusIndex:i.distIndex,d=i.focusIndex>i.distIndex?i.focusIndex:i.distIndex,b=e.index>=l&&e.index<=d,u=b&&l!=d,h=b||i.elementCacheList[i.focusIndex].sectionNo===s.sectionNo;Object(o.useEffect)((function(){s.reffers.wrap=n.current,s.reffers.body=t.current,e.setState(i)}),[i.elementCacheList.length]);var p=JSON.stringify(r);return Object(o.useMemo)((function(){var o="chord"!==r.type?null:r.detail,c=!(h||"init"===r.type);return Object(se.jsxs)(Sr,{ref:n,isSelectable:"fixed"!==r.type,isActive:b,isInactive:c,isAdditional:["chord","section","alter","init"].includes(r.type),children:[Object(se.jsx)(Lr,{children:"chord"!==r.type?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(wr,{children:v.getDisplayKeyScaleName(s.keyIndex,s.scale)})}),["init","chord","section","alter"].includes(r.type)?Object(se.jsx)(Or,{ref:t,isActive:b,isRange:u,isInactive:c,type:r.type,isAnytime:["fixed","init"].includes(r.type)||0===i.focusIndex,onClick:function(){"fixed"!==r.type&&(i.keySwitch.distMode?i.distIndex=e.index:i.focusIndex=i.distIndex=e.index,e.setState(i))},children:function(){switch(r.type){case"init":var e=r.detail;return Object(se.jsx)(tr,{detail:e});case"section":var n=r.detail;return Object(se.jsx)(rr,{detail:n});case"chord":var t=r.detail;return Object(se.jsx)(Ka,{detail:t,isCurrent:b,cache:s,chordCacheList:i.chordCacheList,keyIndex:s.keyIndex,isSustainMode:b&&i.keySwitch.sustainMode,scale:s.scale});case"alter":var o=r.detail;return Object(se.jsx)(_a,{detail:o})}}()}):Object(se.jsx)($a,{detail:r.detail}),"chord"===r.type?Object(se.jsx)(wa,{index:e.index,detail:o}):"section"===r.type?Object(se.jsx)(Ma,{index:e.index}):"alter"===r.type?Object(se.jsx)(dr,{detail:r.detail,prevCache:i.elementCacheList[e.index-1],curCache:s}):Object(se.jsx)(se.Fragment,{}),Object(se.jsx)(se.Fragment,{children:a&&null!=o&&i.keySwitch.chordMode?Object(se.jsx)(xr,{}):""}),Object(se.jsx)(se.Fragment,{children:a&&null!=o&&null!=o.root&&i.keySwitch.symbolMode?Object(se.jsx)(ma,{}):""}),["fixed","init"].includes(r.type)?Object(se.jsx)(se.Fragment,{}):Object(se.jsxs)(kr,{children:[Object(se.jsx)(yr,{children:"-"}),Object(se.jsx)(yr,{children:"+"})]})]})}),[p,h,u,b,c.chordMode,c.symbolMode,c.sustainMode,function(){var e=!1;"chord"===r.type&&(e=i.chordCacheList[s.chordBlockNo].backingError);return e}(),s.keyIndex,s.scale])},Or=(d.b.div(bc||(bc=Object(s.a)(["\n    display: block;\n    width: 1px;\n    height: 10px;\n    background-color: #ad0c0c;\n"]))),d.b.div(uc||(uc=Object(s.a)(["\n    display: inline-block;\n    /* position: relative; */\n    min-width: 80px;\n    height: calc(100% - ","px);\n    /* border: solid 1px #00000049; */\n    ","\n    ","\n    ","\n\n    opacity: 0.4;\n    border-radius: 4px;\n    ","\n    ","\n    box-sizing: border-box;\n    padding: 4px;\n    transition: background-color 100ms;\n    ","\n    ","\n"])),75,(function(e){return"section"!==e.type?"":Object(d.a)(hc||(hc=Object(s.a)(["\n        border: solid 1px #df8484;\n    "])))}),(function(e){return"init"!==e.type?"":Object(d.a)(pc||(pc=Object(s.a)(["\n        border: solid 1px #44b168;\n        height: 85px;\n    "])))}),(function(e){return"alter"!==e.type?"":Object(d.a)(xc||(xc=Object(s.a)(["\n        border: solid 1px #604fc0;\n    "])))}),(function(e){return e.isInactive?"":Object(d.a)(fc||(fc=Object(s.a)(["\n        /* background-color: #ebf1e2; */\n        opacity: 1;\n    "])))}),(function(e){return e.isAnytime?Object(d.a)(gc||(gc=Object(s.a)(["\n        opacity: 1;\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(jc||(jc=Object(s.a)(["\n        background-color: #e4c9df;\n        border: solid 1px #00000049;\n        box-shadow: 0 0 8px 0 #000b3a48;\n    "]))):""}),(function(e){return e.isRange?Object(d.a)(vc||(vc=Object(s.a)(["\n        background-color: #80d4e2;\n        box-shadow: 0 0 8px 0 #000b3a48;\n    "]))):""}))),kr=d.b.div(mc||(mc=Object(s.a)([""]))),yr=d.b.div(Oc||(Oc=Object(s.a)([""]))),Sr=d.b.div(kc||(kc=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    height: ","px;\n    padding: 0 ","px;\n    box-sizing: border-box;\n    /* margin: 10px 5px 5px 5px; */\n    border-bottom: 1px solid #47438678;\n    margin-bottom: 4px;\n    vertical-align: top;\n    /* width: 1px; */\n    transition: width 500ms, opacity 300ms;\n    /* border: 1px solid #00000015; */\n    ","\n\n    & "," {\n        display: none;\n        position: absolute;\n        z-index: 5;\n        width: ","px;\n        height: 44px;\n        /* background-color: #0000ff11; */\n        top: ","px;\n        right: -","px;\n\n        /* background-color: #0400d84e; */\n        & "," {\n            display: inline-block;\n            width: ","px;\n            height: ","px;\n            background-color: #ebebeb6e;\n            border: 1px solid #818181;\n            margin: 1px 0;\n            font-size: 15px;\n            font-weight: 600;\n            text-align: center;\n            color: #818181;\n            box-sizing: border-box;\n            line-height: 15px;\n\n            &:hover {\n                background-color: #fffb0b9d\n            }\n        }\n    }\n\n    &:hover {\n        ","\n    }\n"])),134,8,(function(e){return e.isInactive||!e.isAdditional?"":Object(d.a)(yc||(yc=Object(s.a)(["\n        /* background-color: #e8ff9549; */\n        background: linear-gradient(to bottom, transparent,transparent,transparent, #ffffff9e);\n    "])))}),kr,20,35,10,yr,20,20,(function(e){return e.isSelectable?Object(d.a)(Sc||(Sc=Object(s.a)(["\n            & "," {\n                ","\n                opacity: 1;\n            }\n            & "," {\n                display: inline-block;\n            }\n        "])),Or,(function(e){return e.isActive?"":Object(d.a)(wc||(wc=Object(s.a)(["background-color: #ffffff9b;"])))}),kr):""})),wr=d.b.div(Lc||(Lc=Object(s.a)([""]))),Lr=d.b.div(Ic||(Ic=Object(s.a)(["\n    display: inline-block;\n    /* position: relative; */\n    width: 100%;\n    height: ","px;\n    /* background-color: #eca8813b; */\n\n    & "," {\n        display: inline-block;\n        position: absolute;\n        top: -2px;\n        left: 10px;\n        width: 50px;\n        font-size: 12px;\n        color: #ca0000;\n        /* background-color: #fff; */\n    }\n"])),15,wr),Ir=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.scoreState,c=n.scoreData.chordList,a=i.elementCacheList,r=[];if(a.length===c.length)for(var s=0;s<a.length;s++)r.push(Object(se.jsx)(mr,{index:s,element:c[s],state:n.scoreState,setState:t.score.setScoreState},r.length));return Object(se.jsx)(Ar,{children:r})},Ar=d.b.div(Ac||(Ac=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin: 4px 0 0 4px;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    /* background-color: #e7dddd; */\n    background-color: #e9e9e9;\n    border: 1px solid #b3b3b3;\n    border-radius: 2px;\n    padding: 15px;\n    box-sizing: border-box;\n    text-align: left;\n    /* overflow: auto; */\n"]))),Er=(d.b.div(Ec||(Ec=Object(s.a)(["\n    transform-origin: top left;\n    /* width: 100%;\n    height: 100%; */\n    transform: scale(1);\n"]))),d.b.div(Cc||(Cc=Object(s.a)(["\n    display: inline-block;\n    /* position: relative; */\n    padding: ","px ","px;\n    width: ","px;\n    height: ","px;\n    background-color: #d8d8d8;\n    /* overflow: hidden; */\n    margin: 10px 0 0 10px;\n    box-shadow: 0 0 18px 0 #000b3a48;\n"])),10,30,891,1260),function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.scoreState,c=i.sectionCacheList;if(-1===i.focusIndex||i.focusIndex>i.elementCacheList.length)return Object(se.jsx)(se.Fragment,{});var a=i.elementCacheList[i.focusIndex].sectionNo,r=[];return c.forEach((function(e,n){var o=Math.floor(e.beatSum/4),c=e.beatSum%4,s=n===a;r.push(Object(se.jsxs)(Mr,{isActive:s,onClick:function(){i.focusIndex=e.rangeIndexStart,i.distIndex=i.focusIndex,t.score.setScoreState(i)},children:[Object(se.jsx)(Cr,{children:e.labelName}),Object(se.jsxs)(Tr,{children:[o,0===c?"":" (".concat(c,")")]})]},n))})),Object(se.jsx)(se.Fragment,{children:r})}),Cr=d.b.div(Tc||(Tc=Object(s.a)([""]))),Tr=d.b.div(Mc||(Mc=Object(s.a)([""]))),Mr=d.b.div(Dc||(Dc=Object(s.a)(["\n    display: inline-block;\n    margin: 4px 4px 0 4px;\n    width: calc(100% - 8px);\n    height: 46px;\n    background-color: "," ;\n    border: 1px solid #929292;\n    /* border-radius: 20px 20px 20px 20px; */\n    border-radius: 2px;\n\n    text-align: center;\n\n    & "," {\n        display: inline-block;\n        width: 100%;\n        height: 25px;\n        font-size: 18px;\n        /* font-weight: 600; */\n        color: #4d4d4d;\n        /* background-color: #0000003a; */\n        line-height: 22px;\n    }\n    & "," {\n        display: inline-block;\n        width: 100%;\n        height: 21px;\n        font-size: 14px;\n        font-weight: 600;\n        color: #003eb3;\n        /* background-color: #adadad39; */\n        line-height: 20px;\n    }\n"])),(function(e){return e.isActive?Object(d.a)(Nc||(Nc=Object(s.a)(["\n        #97cce0dd;\n        box-shadow: 0 0 8px 0 #000b3a48;\n    "]))):Object(d.a)(Fc||(Fc=Object(s.a)(["\n        #c4c4c42b;\n    "])))}),Cr,Tr);!function(e){e.previewStart=function(e,t){for(var i=e.scoreState,o=i.elementCacheList,c=e.scoreData.chordList,a=e.reserveTasks,r=-1,s=function(){t.score.setScoreState(i)},l=function(n){var l=o[n],d=e.scoreState.chordCacheList[l.chordBlockNo],b=c[n],u=function(e){a.push(setTimeout((function(){e()}),l.pastSecond-r-0))};if("chord"===b.type){var h=b.detail;if(-1===r&&(r=l.pastSecond),null==h.root&&u((function(){i.focusIndex=n,i.distIndex=i.focusIndex,s()})),d.backingError)a.push(setTimeout((function(){_c.stopPreview(e,t,a)}),l.pastSecond-r-0));else{var p=h.backing,x=O.getPitchListFromVoicing(p.voicingList,d.structList),f=h.minute.head+h.minute.tail,g=v.calcSustainMsec(h.beatLen,f,l.bpm,l.beatSignature);u((function(){O.playBacking(e,a,l,p,x,g),i.focusIndex=n,i.distIndex=i.focusIndex,setTimeout((function(){s()}),0)}))}}n===c.length-1&&u((function(){_c.stopPreview(e,t,a)}))},d=i.focusIndex;d<c.length;d++)l(d);i.isSolo||n(r/1e3,e,t,a),i.isPreview=!0,s()};var n=function(e,n,t,i){for(var o=n.melodyState,c=n.scoreState,a=n.scoreData,r=n.instruments.melodyFont,s=n.invalidate.melody,d=-1,b=function(n){var b=a.notesList[n],u=w(b.pos),h=w(b.len),p=y.getTimeInfoFromNotesPos(u,h,c.tempoCacheList),x=Object(l.a)(p,2),f=x[0],g=x[1];if(f<e)return"continue";-1===d&&(d=-1===o.focusIndex?0:f);var j=b.pitchIndex,m=S(j),O=v.KEY12_SHARP_LIST[m%12],k=Math.floor((59-j+9)/12)+1;i.push(setTimeout((function(){t.melody.adjustScrollX(),null!=r&&(r.stop(),r.play(O+k,0,{duration:g})),setTimeout((function(){o.focusIndex=n,o.destIndex=o.focusIndex,s()}),0)}),1e3*(f-e)))},u=0;u<a.notesList.length;u++)b(u)};e.stopPreview=function(e,n,t){var i,o=e.scoreState;o.isPreview=!1,t.forEach((function(e){return clearTimeout(e)})),n.system.setReserveTasks([]),n.score.setScoreState(o),null===(i=e.instruments.harmonyFont)||void 0===i||i.stop()},e.previewCurHarmony=function(e,n){var t=e.scoreState,i=e.reserveTasks,o=t.elementCacheList[t.focusIndex],c=e.scoreState.chordCacheList[o.chordBlockNo],a=e.scoreData.chordList[t.focusIndex];if(null!=a){var r=a.detail;if(null==r.root)return;var s=r.backing,l=O.getPitchListFromVoicing(s.voicingList,c.structList),d=r.minute.head+r.minute.tail,b=v.calcSustainMsec(r.beatLen,d,o.bpm,o.beatSignature);O.playBacking(e,e.reserveTasks,o,s,l,b),i.push(setTimeout((function(){t.isPreview=!1,n.score.setScoreState(t)}),b)),t.isPreview=!0,n.score.setScoreState(t)}}}(_c||(_c={}));var Dr,Nr=_c;!function(e){e.main=function(e,t,i){t.userEnv.keyConfig.note;var o=t.scoreState.keySwitch,c=(t.scoreData,t.backingState);if(null!=c&&1!==c.tabIndex)if(c.isPreview)switch(e.key){case" ":O.stopPreview(t,c,i,t.reserveTasks)}else n(e,c,o,i)};var n=function(e,n,c,a){var r=n.pattern;t(e,n,a),null!=r&&(-1===r.channelIndex?i(e,n,r,a):o(e,n,r,c.sustainMode,a))},t=function(e,n,t){switch(e.key){case"b":n.closeAction(n,!1);break;case"z":var i=O.getVoicingListFromTable(n.voicingTable),o=null==n.pattern?null:O.buildPatternProps(n.pattern),c={voicingList:i,pattern:o};console.log("voicingList: "+re.a.gZip(JSON.stringify(i))),console.log("pattern: "+re.a.gZip(JSON.stringify(o))),console.log("source: "+re.a.gZip(JSON.stringify(c))),console.log("source: "+JSON.stringify(c));break;case" ":n.hasError||t.backing.testBacking();break;case"Enter":n.closeAction(n,!0)}},i=function(e,n,t,i){switch(e.key){case"ArrowLeft":i.backing.movePatternColumn(!1);break;case"ArrowRight":i.backing.movePatternColumn(!0);break;case"ArrowUp":i.backing.incrementVel(1);break;case"ArrowDown":i.backing.incrementVel(-1);break;case"a":i.backing.addPatternColumn();break;case"w":i.backing.switchLayer();break;case"e":i.backing.switchMode();break;case"1":i.backing.setCurrentDivRate(16);break;case"2":i.backing.setCurrentDivRate(8);break;case"3":i.backing.setCurrentDivRate(4);break;case"4":i.backing.setCurrentDivRate(2);break;case"5":i.backing.setCurrentDivRate(1);break;case".":i.backing.toggleCurrentDivHalf();break;case"Delete":i.backing.deleteColumn();break;case"s":t.channelIndex=0,i.backing.setState(n)}},o=function(e,n,t,i,o){var c=function(){return o.backing.setState(n)};if(i){var a=t.layers[t.layerIndex],r=a.velocityList[t.lenIndex],s=t.channels.length-1-t.channelIndex,l=a.table[s][t.lenIndex];if(null!=l){var d=void 0==l.timing?0:l.timing,b=void 0==l.velAdj?0:l.velAdj,u=r+b;switch(e.key){case"ArrowUp":u<10&&b++;break;case"ArrowDown":u>1&&b--;break;case"ArrowLeft":d>-10&&d--;break;case"ArrowRight":d<10&&d++}0!==b?l.velAdj=b:delete l.velAdj,0!=d?l.timing=d:delete l.timing,c()}}else switch(e.key){case"ArrowLeft":o.backing.movePatternColumn(!1);break;case"ArrowRight":o.backing.movePatternColumn(!0);break;case"ArrowUp":o.backing.moveChannelIndex(!1);break;case"ArrowDown":o.backing.moveChannelIndex(!0);break;case"s":t.channelIndex=-1,c();break;case"a":var h=o.backing.getNotes(),p=void 0==t.layers[t.layerIndex].table.find((function(e){var n=e[t.lenIndex];if(null!=n&&"s"===n.signal)return n}))?"n":"s",x=null==h?{signal:p,timing:0,velAdj:0}:null;o.backing.setNotes(x),o.backing.updateErrorState()}}}(Dr||(Dr={}));var Fr,_r=Dr;(Fr||(Fr={})).main=function(e,n,t){n.userEnv.keyConfig.note,n.scoreState.keySwitch;var i=n.systemState.cache,o=function(){i.invalidate()},c=i.field,a=function(e){!e&&c.listIndex>=1?(c.listIndex--,o()):e&&c.listIndex<i.presetList.length-1&&(c.listIndex++,o())};switch(e.key){case"Enter":i.applyAction();break;case"e":t.score.closeLibraryWnd();break;case"ArrowUp":a(!1);break;case"ArrowDown":a(!0)}};var zr,Rr=Fr;(zr||(zr={})).main=function(e,n,t){n.userEnv.keyConfig.note,n.scoreState.keySwitch;var i=n.systemState.cache,o=function(){i.invalidate()},c=i.field,a=function(e){if(0===c.focusSide)!e&&c.pattIndex>=1?(c.pattIndex--,c.voicIndex=0,o()):e&&c.pattIndex<i.patternList.length-1&&(c.pattIndex++,c.voicIndex=0,o());else{var n=i.patternList,t=i.voicingList.filter((function(e){return Pn.acceptVoic(e,n,c.pattIndex)}));!e&&c.voicIndex>=1?(c.voicIndex--,o()):e&&c.voicIndex<t.length-1&&(c.voicIndex++,o())}},r=function(e){e?0===c.focusSide&&(c.focusSide=1,o()):1===c.focusSide&&(c.focusSide=0,o())};if(!i.isPreview)switch(e.key){case"e":t.score.closeLibraryWnd();break;case"Enter":var s=i.patternList[c.pattIndex],l=i.voicingList.filter((function(e){return Pn.acceptVoic(e,i.patternList,c.pattIndex)}))[c.voicIndex];t.thema.mappingSelectorToScore(l.source,s.source),t.score.closeLibraryWnd();break;case"ArrowLeft":r(!1);break;case"ArrowRight":r(!0);break;case"ArrowUp":a(!1);break;case"ArrowDown":a(!0)}switch(e.key){case" ":i.isPermitTest()&&i.testBacking()}};var Br,Pr,Kr,Ur,Vr,qr,Hr,Jr,Wr,Yr,Gr,Qr,Xr,Zr,$r,es,ns=zr,ts=function(e,n,t){var i=n.userEnv.keyConfig.note,o=n.scoreState.keySwitch,c=n.scoreData,a=n.scoreState,r="init"!==c.chordList[a.focusIndex].type;if(a.isPreview)switch(e.key){case" ":Nr.stopPreview(n,t,n.reserveTasks)}else switch(n.scoreState.hideMenu){case"none":if(r)if(o.control)switch(e.key){case"c":var s=c.chordList[a.focusIndex];if("chord"===s.type)null!=s.detail.root&&t.score.cloneBacking();break;case"x":t.score.copyElementList();break;case"v":if(null!=a.copiedElementList)t.score.pasteElementList();else if(null!=a.cloneBacking){var l=c.chordList[a.focusIndex];if("chord"===l.type)null!=l.detail.root&&t.score.pastBacking()}break;case"s":t.score.saveFile()}else if(o.distMode)switch(e.key){case"ArrowLeft":t.score.moveDist(!1);break;case"ArrowRight":t.score.moveDist(!0)}else if(o.sustainMode)switch(e.key){case i.decRoot:t.score.incrementDegreeRoot(!1);break;case i.incRoot:t.score.incrementDegreeRoot(!0);break;case i.decBeat:t.score.incrementBeatLen(!1);break;case i.incBeat:t.score.incrementBeatLen(!0)}else if(o.minHeadMode)switch(e.key){case"ArrowLeft":t.score.incrementMinuteValRelation(!1,1);break;case"ArrowRight":t.score.incrementMinuteValRelation(!1,-1)}else if(o.minTailMode)switch(e.key){case"ArrowLeft":t.score.incrementMinuteValRelation(!0,-1);break;case"ArrowRight":t.score.incrementMinuteValRelation(!0,1)}else if(o.chordMode);else if(o.symbolMode)switch(e.key){case"ArrowUp":t.symbol.toNext(!1);break;case"ArrowDown":t.symbol.toNext(!0);break;case"ArrowLeft":t.symbol.toBase();break;case"ArrowRight":t.symbol.toDerive()}else!function(e,n,t){var i=n.userEnv.keyConfig.note,o=(n.scoreState.keySwitch,n.scoreData),c=n.scoreState,a=o.chordList[c.focusIndex],r=c.elementCacheList[c.focusIndex],s=(c.chordCacheList[r.chordBlockNo],a.type),l=Pn.getEnableState(n);switch(s){case"chord":n.scoreState.hideMenu;var d=o.chordList[c.focusIndex].detail,b=c.elementCacheList[c.focusIndex];switch(e.key){case"z":Nr.previewCurHarmony(n,t);break;case"e":l.isUseLib&&l.isChordElement&&!l.isRangeSelect&&t.score.openLibraryWnd(!1);break;case"b":null!=d.root&&t.backing.openBackingEditor();break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":t.score.setDiatonicChord(b.scale,Number(e.key)-1)}}switch(e.key){case i.left:c.focusIndex===c.distIndex?t.score.moveElement(!1):t.score.releaseRange(!1);break;case i.right:c.focusIndex===c.distIndex?t.score.moveElement(!0):t.score.releaseRange(!0);break;case i.up:t.score.moveSection(!1);break;case i.down:t.score.moveSection(!0);break;case i.addChord:t.score.addChordElement();break;case i.addSection:t.score.addSectionElement();break;case"m":t.score.addAlterElement();break;case i.deleteCur:t.score.removeElement();break;case"e":l.isUseLib&&l.isRangeSelect&&t.score.openLibraryWnd(!0);break;case"n":t.score.removeBacking();break;case" ":Nr.previewStart(n,t)}}(e,n,t);break;case"backing":_r.main(e,n,t);break;case"library":ns.main(e,n,t);break;case"preset":Rr.main(e,n,t)}},is=function(e,n,t,i){if(!n.scoreState.isPreview){var o=n.userEnv.keyConfig.note,c=n.scoreState.keySwitch;switch(e.key){case"Control":c.control=i,t.score.setKeySwitch(c);break;case o.distMode:c.control||(c.distMode=i,t.score.setKeySwitch(c));break;case o.edit1:c.control||c.distMode||(c.sustainMode=i,t.score.setKeySwitch(c));break;case"v":c.control||c.distMode||c.sustainMode||(c.chordMode=i,t.score.setKeySwitch(c));break;case o.edit2:c.control||c.distMode||c.sustainMode||c.chordMode||(c.symbolMode=i,t.score.setKeySwitch(c));break;case"d":c.control||c.distMode||c.sustainMode||c.chordMode||c.symbolMode||(c.minHeadMode=i,t.score.setKeySwitch(c));break;case"g":c.control||c.distMode||c.sustainMode||c.chordMode||c.symbolMode||c.minHeadMode||(c.minTailMode=i,t.score.setKeySwitch(c))}}i&&ts(e,n,t)};!function(e){e.___CSS_FORM=Object(d.a)(Br||(Br=Object(s.a)(["\n        display: inline-block;\n        /* width: 100px; */\n        height: 25px;\n        background-color: #bdbdbd;\n        border: 1px solid #000;\n        border-radius: 2px;\n        box-sizing: border-box;\n        color: #303030;\n        font-size: 16px;\n        font-weight: 600;\n        line-height: 20px;\n        text-align: center;\n    "]))),e.___CSS_TITLE=Object(d.a)(Pr||(Pr=Object(s.a)(["\n        display: inline-block;\n        width: 100%;\n        height: 26px;\n        /* background-color: #f0f0f0; */\n        background: linear-gradient(to bottom, #707070, #b3b3b3, #707070);\n        border: 1px solid #222222;\n        font-size: 20px;\n        color: #ffffff;\n        font-weight: 600;\n        line-height: 20px;\n        box-sizing: border-box;\n        /* border: 1px solid #c50000; */\n        text-align: center;\n    "]))),e.createNumberForm=function(e,t,i,o,c,a){return Object(se.jsxs)(n,{isEnable:t,children:[Object(se.jsx)("input",{type:"number",min:o,max:c,step:a,value:e,onChange:i}),Object(se.jsx)("input",{type:"range",min:o,max:c,step:a,value:e,onChange:i})]})};var n=d.b.div(Kr||(Kr=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 24px;\n    /* margin: 5px 0 0 0; */\n    text-align: left;\n    ","\n    background-color: #ececec;\n\n    & * {\n        display: inline-block;\n        box-sizing: border-box;\n        vertical-align: top;\n    }\n    & input:nth-child(1) {\n        background-color: #dddddd;\n        width: 55px;\n        height: calc(100% - 4px);\n        margin: 2px 0 0 5px;\n        border: 1px solid #9b9b9b;\n        border-radius: 4px;\n    }\n    & input:nth-child(2) {\n        margin-left: 5px;\n        background-color: #f00;\n        width: calc(100% - 70px);\n        height: 100%;\n    }\n    "])),(function(e){return e.isEnable?"":Object(d.a)(Ur||(Ur=Object(s.a)(["\n        pointer-events: none;\n        opacity: 0.5;\n    "])))}))}(Vr||(Vr={}));var os,cs,as,rs,ss,ls,ds,bs,us,hs,ps,xs,fs,gs,js,vs,ms,Os,ks,ys,Ss,ws,Ls,Is,As,Es,Cs,Ts,Ms,Ds,Ns,Fs,_s,zs,Rs,Bs,Ps,Ks,Us,Vs,qs,Hs,Js,Ws,Ys,Gs,Qs,Xs,Zs,$s,el,nl,tl,il,ol,cl,al=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.scoreState,c=n.scoreData.chordList[i.focusIndex].detail,a=c.alterType,r=function(){t.score.setScoreData(n.scoreData),y.updateHarmonizeCache(n,t)},s=function(e,n){var t="-"===e?null:e;return Object(se.jsxs)(dl,{isActive:n,onClick:function(){c.alterType!==t&&(c.alterType=t,c.modRel=null,c.dommVal=0,c.keyAdj=0,c.tempoRel=null,c.tempoDiff=0,c.tempoRate=100,c.tempoAbs=100,c.beatSignature="4/4",r())},children:[" ",e]})},l=function(e){var n="-"===e?null:e;return Object(se.jsx)(dl,{isActive:"modulate"===c.alterType&&n==c.modRel,onClick:function(){c.modRel!==n&&(c.modRel=n,c.dommVal=0,c.keyAdj=0,r())},children:e})},d=function(e){var n="-"===e?null:e;return Object(se.jsx)(dl,{isActive:"tempo"===c.alterType&&n==c.tempoRel,onClick:function(){c.tempoRel!==n&&(c.tempoRel=n,c.tempoDiff=0,c.tempoRate=100,c.tempoAbs=100,r())},children:e})},b=function(e){return Object(se.jsx)(dl,{isActive:"beat"===c.alterType&&c.beatSignature===e,onClick:function(){c.beatSignature!==e&&(c.beatSignature=e,r())},children:e})},u=Object(se.jsx)(bl,{isEnable:"domm"===c.modRel,children:[-3,-2,-1,0,1,2,3].map((function(e,n){var t=e>0?"+":"";return Object(se.jsx)(ul,{isActive:"modulate"===c.alterType&&"domm"===c.modRel&&e==c.dommVal,onClick:function(){c.dommVal=e,r()},children:"".concat(t).concat(e)},n)}))}),h=Object(se.jsx)(bl,{isEnable:"key"===c.modRel,children:[-3,-2,-1,0,1,2,3].map((function(e,n){var t=e>0?"+":"";return Object(se.jsx)(ul,{isActive:"modulate"===c.alterType&&"key"===c.modRel&&e==c.keyAdj,onClick:function(){c.keyAdj=e,r()},children:"".concat(t).concat(e)},n)}))});return Object(se.jsxs)(rl,{children:[Object(se.jsxs)(sl,{isEnable:!0,children:[Object(se.jsx)(ll,{children:"Type"}),s("-",null==a),s("modulate","modulate"===a),s("tempo","tempo"===a),s("beat","beat"===a)]}),Object(se.jsxs)(sl,{isEnable:"modulate"===c.alterType,children:[Object(se.jsx)(ll,{children:"Modulate"}),l("-"),l("domm"),u,l("parallel"),l("relative"),l("key"),h]}),Object(se.jsxs)(sl,{isEnable:"tempo"===c.alterType,children:[Object(se.jsx)(ll,{children:"Tempo"}),d("-"),d("diff"),Vr.createNumberForm(c.tempoDiff,"tempo"===c.alterType&&"diff"===c.tempoRel,(function(e){c.tempoDiff=e.currentTarget.valueAsNumber,r()}),-100,100,1),d("rate"),Vr.createNumberForm(c.tempoRate,"tempo"===c.alterType&&"rate"===c.tempoRel,(function(e){c.tempoRate=e.currentTarget.valueAsNumber,r()}),10,200,1),d("abs"),Vr.createNumberForm(c.tempoAbs,"tempo"===c.alterType&&"abs"===c.tempoRel,(function(e){c.tempoAbs=e.currentTarget.valueAsNumber,r()}),10,200,1)]}),Object(se.jsxs)(sl,{isEnable:"beat"===c.alterType,children:[Object(se.jsx)(ll,{children:"Beat"}),b("2/4"),b("4/4"),b("3/4"),b("6/8"),b("9/8"),b("12/8")]})]})},rl=d.b.div(qr||(qr=Object(s.a)(["\n        display: inline-block;\n        width: 100%;\n        height: 100%;\n        text-align: left;\n        background-color: #b3b5c5;\n        "]))),sl=d.b.div(Hr||(Hr=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    margin: 0 0 0 4px;\n    ","\n        "])),(function(e){return e.isEnable?"":Object(d.a)(Jr||(Jr=Object(s.a)(["\n    pointer-events: none;\n    opacity: 0.5;\n"])))})),ll=d.b.div(Wr||(Wr=Object(s.a)(["\n    ","\n    margin-top: 4px;\n"])),Vr.___CSS_TITLE),dl=d.b.div(Yr||(Yr=Object(s.a)(["\n        ","\n        margin-top: 1px;\n        width: 100%;\n        background-color: #c1cdd4;\n        ","\n        "])),Vr.___CSS_FORM,(function(e){return e.isActive?Object(d.a)(Gr||(Gr=Object(s.a)(["\n        background-color: #e0c83e;\n    "]))):""})),bl=d.b.div(Qr||(Qr=Object(s.a)(["\n        margin: 1px;\n        background-color: #070707;\n        ","\n        "])),(function(e){return e.isEnable?"":Object(d.a)(Xr||(Xr=Object(s.a)(["\n        pointer-events: none;\n        opacity: 0.5;\n    "])))})),ul=d.b.div(Zr||(Zr=Object(s.a)(["\n        ","\n        width: 29px;\n        background-color: #dddddd;\n        ","\n        "])),Vr.___CSS_FORM,(function(e){return e.isActive?Object(d.a)($r||($r=Object(s.a)(["\n        background-color: #e0c83e;\n    "]))):""})),hl=(d.b.div(es||(es=Object(s.a)(["\n        display: inline-block;\n        width: 100%;\n        height: 24px;\n        /* margin: 5px 0 0 0; */\n        text-align: left;\n        background-color: #ececec;\n\n        & * {\n            display: inline-block;\n            box-sizing: border-box;\n            vertical-align: top;\n    }\n        & input:nth-child(1) {\n            background-color: #dddddd;\n            width: 60px;\n            height: calc(100% - 4px);\n            margin: 2px 0 0 0;\n            border: 1px solid #9b9b9b;\n            border-radius: 4px;\n    }\n        & input:nth-child(2) {\n            margin-left: 5px;\n            background-color: #f00;\n            width: calc(100% - 70px);\n            height: 100%;\n    }\n        "]))),[{value:-2,label:"-/8"},{value:-1,label:"-/16"},{value:0,label:"\xb10"},{value:1,label:"+/16"},{value:2,label:"+/8"}]),pl=function(e){var n=e.value>=0?0:50*Math.abs(e.value),t=e.value<=0?0:50*Math.abs(e.value),i=1===Math.abs(e.value),o=hl.map((function(n,t){return function(n,t,i){var o=e.value===t;return Object(se.jsx)(gl,{isActive:o,onClick:function(){return e.setValue(t)},children:o?i:""},n)}(t,n.value,n.label)}));return Object(se.jsxs)(xl,{isHead:e.isHead,children:[Object(se.jsxs)(jl,{children:[Object(se.jsx)(vl,{isLeft:!0,isRed:i,rate:e.isHead?t:n,children:Object(se.jsx)("div",{})}),Object(se.jsx)(vl,{isLeft:!1,isRed:i,rate:e.isHead?n:t,children:Object(se.jsx)("div",{})})]}),Object(se.jsx)(fl,{children:e.isHead?o.reverse():o})]})},xl=d.b.div(os||(os=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: 30px;\n    background-color: #bfd380;\n    text-align: left;\n"]))),fl=d.b.div(cs||(cs=Object(s.a)(["\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 9;\n"]))),gl=d.b.div(as||(as=Object(s.a)(["\n    display: inline-block;\n    width: calc(20% - 8px);\n    height: calc(100% - 8px);\n    margin: 4px;\n    text-align: left;\n    vertical-align: top;\n    background-color: #0000001a;\n    /* border: 1px solid #4d4d4d91; */\n    border-radius: 4px;\n    ","\n    font-size: 12px;\n    line-height: 18px;\n    font-weight: 600;\n    color: #ffffff;\n    box-sizing: border-box;\n    text-align: center;\n    /* opacity: 0.15; */\n    &:hover {\n        background-color: #ffffff24;\n    }\n"])),(function(e){return e.isActive?Object(d.a)(rs||(rs=Object(s.a)(["\n        border: 1px solid #c00000c5;\n    "]))):""})),jl=d.b.div(ss||(ss=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    /* position: absolute;\n    top: 0;\n    left: 0; */\n    z-index: 8;\n    text-align: center;\n"]))),vl=d.b.div(ls||(ls=Object(s.a)(["\n    display: inline-block;\n    width: 50%;\n    height: 16px;\n    margin-top: 7px;\n    text-align: left;\n    box-sizing: border-box;\n    position: relative;\n\n    & div {\n        position: absolute;\n        top: 0;\n        height: 100%;\n        width: ","%;\n        ","\n        ","\n    }\n"])),(function(e){return e.rate}),(function(e){return e.isRed?Object(d.a)(ds||(ds=Object(s.a)(["\n            background: linear-gradient(to right, #0066ff, #7691a3);\n        "]))):Object(d.a)(bs||(bs=Object(s.a)(["\n            background: linear-gradient(to left, #ff0000, #a37676);\n        "])))}),(function(e){return e.isLeft?Object(d.a)(us||(us=Object(s.a)(["\n            right: 0;\n            border-radius: 10px 0 0 10px;\n        "]))):Object(d.a)(hs||(hs=Object(s.a)(["\n            left: 0;\n            border-radius: 0 10px 10px 0;\n        "])))})),ml=function(e){for(var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=t.scoreState,a=t.scoreData.chordList[c.focusIndex].detail,r=c.elementCacheList[c.focusIndex],s=c.chordCacheList[r.chordBlockNo],d=[],b=function(e){var n=a.beatLen>=e+1;d.push(Object(se.jsx)(wl,{isExist:n,isActive:a.beatLen===e+1,onClick:function(){var n=t.scoreData;n.chordList=n.chordList.slice(),a.beatLen=e+1,n.chordList[t.scoreState.focusIndex].detail=a,i.score.setScoreData(n)},children:Object(se.jsx)("span",{})},e))},u=0;u<4;u++)b(u);var p=[];v.DEGREE_ALL.forEach((function(e,n){var o=JSON.stringify(a.root)===JSON.stringify(e),d=null!=a.on&&JSON.stringify(a.on)===JSON.stringify(e),b="major"===r.scale?v.MAJOR_SCALE_INTERVALS:v.MINOR_SCALE_INTERVALS,u=null!=e&&b.includes(e.index);p.push(Object(se.jsx)(El,{isRootActive:o,isOnActive:d,isDiatonic:u,onClick:function(){var n=t.scoreData;(d||null==e)&&(a.on=null),a.root=null==e?null:Object(h.a)({},e),null==e&&(a.symbolKey="major"),n.chordList[t.scoreState.focusIndex].detail=a,i.score.setScoreData(n);var o=a.root,b=v.getSymbolFromKey(a.symbolKey),u=O.getChordDetails(o,r.keyIndex,a.on,b),p=Object(l.a)(u,2);s.chordFullName=p[0],s.structList=p[1],i.score.setScoreState(c)},onContextMenu:function(){var n=t.scoreData;if(null!=a.root&&!o){a.on=d||null==e?null:Object(h.a)({},e),n.chordList[t.scoreState.focusIndex].detail=a,i.score.setScoreData(n);var b=a.root,u=v.getSymbolFromKey(a.symbolKey),p=O.getChordDetails(b,r.keyIndex,a.on,u),x=Object(l.a)(p,2);s.chordFullName=x[0],s.structList=x[1],i.score.setScoreState(c)}},children:null==e?"-":Object(se.jsxs)(se.Fragment,{children:[v.getDegreeRoot(e)," (",v.getRootName(e,r.keyIndex),")"]})},n))}));var x=[];v.SYMBOL_LIST.forEach((function(e,n){var o=null!=a.root&&e.key===a.symbolKey;x.push(Object(se.jsxs)(Tl,{isActive:o,isDiatonic:!0,onClick:function(){var n=t.scoreData;a.symbolKey=e.key,n.chordList[t.scoreState.focusIndex].detail=a,i.score.setScoreData(n);var o=a.root,d=O.getChordDetails(o,r.keyIndex,a.on,e),b=Object(l.a)(d,2);s.chordFullName=b[0],s.structList=b[1],i.score.setScoreState(c)},children:["[",e.name,"]"]},n))}));var f=function(e){var n=a.minute,t=e?[n.head,function(e){var t=e-n.head;i.score.incrementMinuteValRelation(!1,t)}]:[n.tail,function(e){var t=e-n.tail;i.score.incrementMinuteValRelation(!0,t)}],o=Object(l.a)(t,2),c=o[0],r=o[1];return Object(se.jsx)(pl,{value:c,setValue:r,isHead:e})};return Object(se.jsxs)(kl,{children:[Object(se.jsxs)(yl,{children:[Object(se.jsx)(Ol,{children:"Beat length"}),Object(se.jsx)(Sl,{children:d}),Object(se.jsxs)(Ll,{children:[Object(se.jsx)(Ol,{children:"Minute head"}),f(!0),Object(se.jsx)(Ol,{children:"Minute tail"}),f(!1)]})]}),Object(se.jsxs)(Il,{children:[Object(se.jsx)(Al,{children:p}),Object(se.jsx)(Cl,{isDisable:null==a.root,children:x})]})]})},Ol=d.b.div(ps||(ps=Object(s.a)(["\n    ","\n    margin-top: 4px;\n"])),Vr.___CSS_TITLE),kl=d.b.div(xs||(xs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    text-align: left;\n    background-color: #8a8a8a;\n"]))),yl=d.b.div(fs||(fs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    /* height: 100px; */\n    text-align: left;\n    background-color: #979797;\n"]))),Sl=d.b.div(gs||(gs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 25px;\n    text-align: left;\n    background-color: #afafaf;\n"]))),wl=d.b.div(js||(js=Object(s.a)(["\n    display: inline-block;\n    width: 25%;\n    height: 20px;\n    text-align: left;\n    background-color: #696969;\n\n    & span{\n        display: inline-block;\n        margin: 2px 0 0 3px;\n        width: calc(100% - 6px);\n        height: calc(100% - 4px);\n        background-color: #9b8585;\n        ","\n        box-sizing: border-box;\n        border-radius: 6px;\n        ","\n    }\n"])),(function(e){return e.isActive?Object(d.a)(vs||(vs=Object(s.a)(["\n            /* border: solid 1px #fff; */\n        "]))):""}),(function(e){return e.isExist?Object(d.a)(ms||(ms=Object(s.a)(["\n            /* background-color: #ebf37eb7; */\n            background: linear-gradient(to bottom, #c5c5c5d2, #f3f3f3d2, #c5c5c5d2);\n        "]))):""})),Ll=d.b.div(Os||(Os=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    text-align: left;\n    background-color: #cecece;\n"]))),Il=d.b.div(ks||(ks=Object(s.a)(["\n    display: inline-block;\n    margin-top: 5px;\n    width: 100%;\n    /* height: 360px; */\n    text-align: left;\n    /* background-color: #000000; */\n    & * {\n        vertical-align: top;\n    }\n"]))),Al=d.b.div(ys||(ys=Object(s.a)(["\n    display: inline-block;\n    width: 90px;\n    margin: 0 0 0 1px;\n    height: 100%;\n    text-align: left;\n    /* background-color: #e6e6e6; */\n"]))),El=d.b.div(Ss||(Ss=Object(s.a)(["\n    display: inline-block;\n    margin: 1px 0 0 0;\n    width: 100%;\n    height: 25px;\n    text-align: left;\n    background-color: #90bbcc;\n    ","\n    ","\n    border: 1px solid #000;\n    border-radius: 2px;\n    box-sizing: border-box;\n    color: #616161;\n    ","\n    font-size: 16px;\n    font-weight: 600;\n    line-height: 20px;\n    text-align: center;\n    & span {\n        color: #9e9e9e;\n    }\n    &:hover {\n        background-color: #99999940;\n        ","\n        ","\n    }\n"])),(function(e){return e.isRootActive?Object(d.a)(ws||(ws=Object(s.a)(["background-color: #d1c521b8;"]))):""}),(function(e){return e.isOnActive?Object(d.a)(Ls||(Ls=Object(s.a)(["background-color: #6070ffbc;"]))):""}),(function(e){return e.isDiatonic?Object(d.a)(Is||(Is=Object(s.a)(["color: #ffffff;"]))):""}),(function(e){return e.isRootActive?Object(d.a)(As||(As=Object(s.a)(["background-color: #cc6363b8;"]))):""}),(function(e){return e.isOnActive?Object(d.a)(Es||(Es=Object(s.a)(["background-color: #6374ccb8;"]))):""})),Cl=d.b.div(Cs||(Cs=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 93px);\n    margin: 0 1px 0 1px;\n    height: 100%;\n    text-align: left;\n    ","\n"])),(function(e){return e.isDisable?Object(d.a)(Ts||(Ts=Object(s.a)(["\n        opacity: 0.3;\n        pointer-events: none;\n    "]))):""})),Tl=d.b.div(Ms||(Ms=Object(s.a)(["\n    ","\n    margin: 1px 0 0 0;\n    width: 100%;\n    background-color: #a1cc90;\n    ","\n    color: #fff;\n    ","\n    /* & span {\n        color: #f000;\n    } */\n    &:hover {\n        background-color: #dddddd40;\n        ","\n    }\n"])),Vr.___CSS_FORM,(function(e){return e.isActive?Object(d.a)(Ds||(Ds=Object(s.a)(["background-color: #d1c521b8;"]))):""}),(function(e){return e.isDiatonic?Object(d.a)(Ns||(Ns=Object(s.a)(["color: #fff;"]))):""}),(function(e){return e.isActive?Object(d.a)(Fs||(Fs=Object(s.a)(["background-color: #cc6363b8;"]))):""})),Ml=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.scoreData,c=i.chordList[0].detail,a=function(){i.chordList=i.chordList.slice(),t.score.setScoreData(i),y.updateHarmonizeCache(n,t)},r=v.SCALE_DEF_LIST.map((function(e,n){return Object(se.jsx)(_l,{isActive:c.scale===e,onClick:function(){c.scale=e,a()},children:e},n)})),s=("major"===c.scale?v.KEY12_MAJOR_SCALE_LIST:v.KEY12_MINOR_SCALE_LIST).map((function(e,n){var t=c.scale;return Object(se.jsx)(Rl,{isActive:c.keyIndex===n,onClick:function(){c.keyIndex=n,a()},children:"".concat(e," ").concat(t)},n)})),l=v.BEAT_DEF_LIST.map((function(e,n){return Object(se.jsx)(Pl,{isActive:c.beatSignature===e,onClick:function(){c.beatSignature=e,a()},children:e},n)}));return Object(se.jsxs)(Dl,{children:[Object(se.jsx)(Nl,{children:"Scale"}),Object(se.jsx)(Fl,{children:r}),Object(se.jsx)(Nl,{children:"Key"}),Object(se.jsx)(zl,{children:s}),Object(se.jsx)(Nl,{children:"Tempo"}),Vr.createNumberForm(c.bpm,!0,(function(e){c.bpm=e.currentTarget.valueAsNumber,a()}),30,220,1),Object(se.jsx)(Nl,{children:"Rate"}),Object(se.jsx)(Bl,{children:l})]})},Dl=d.b.div(_s||(_s=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    text-align: left;\n    background-color: #9b9eb8;\n"]))),Nl=d.b.div(zs||(zs=Object(s.a)(["\n    ","\n    margin-top: 4px;\n"])),Vr.___CSS_TITLE),Fl=d.b.div(Rs||(Rs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 24px;\n    /* margin: 5px 0 0 0; */\n    text-align: left;\n    /* background-color: #ececec; */\n"]))),_l=d.b.div(Bs||(Bs=Object(s.a)(["\n    ","\n    border: solid 1px #fff;\n    color: #fff;\n    width: 50%;\n    margin: 1px 0 0 0;\n\n    background-color: #61b47d;\n    ","\n"])),Vr.___CSS_FORM,(function(e){return e.isActive?Object(d.a)(Ps||(Ps=Object(s.a)(["\n        background-color: #da909082;\n    "]))):""})),zl=d.b.div(Ks||(Ks=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    /* height: 24px; */\n    /* margin: 5px 0 0 0; */\n    text-align: left;\n    /* background-color: #ececec; */\n"]))),Rl=d.b.div(Us||(Us=Object(s.a)(["\n    ","\n    border: solid 1px #fff;\n    color: #fff;\n    width: 100%;\n    margin: 1px 0 0 0;\n    \n    /* margin: 5px 0 0 0; */\n    background-color: #61b47d;\n    ","\n"])),Vr.___CSS_FORM,(function(e){return e.isActive?Object(d.a)(Vs||(Vs=Object(s.a)(["\n        background-color: #da909082;\n    "]))):""})),Bl=(d.b.div(qs||(qs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 24px;\n    /* margin: 5px 0 0 0; */\n    text-align: left;\n    background-color: #ececec;\n\n    & * {\n        display: inline-block;\n        box-sizing: border-box;\n        vertical-align: top;\n    }\n    & input:nth-child(1) {\n        background-color: #dddddd;\n        width: 60px;\n        height: calc(100% - 4px);\n        margin: 2px 0 0 0;\n        border: 1px solid #9b9b9b;\n        border-radius: 4px;\n    }\n    & input:nth-child(2) {\n        margin-left: 5px;\n        background-color: #f00;\n        width: calc(100% - 70px);\n        height: 100%;\n    }\n"]))),d.b.div(Hs||(Hs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    /* height: 24px; */\n    /* margin: 5px 0 0 0; */\n    text-align: left;\n    /* background-color: #ececec; */\n"])))),Pl=d.b.div(Js||(Js=Object(s.a)(["\n    ","\n    width: 100%;\n    border: solid 1px #fff;\n    color: #fff;\n    margin: 1px 0 0 0;\n    /* margin: 5px 0 0 0; */\n    background-color: #61b47d;\n    ","\n\n"])),Vr.___CSS_FORM,(function(e){return e.isActive?Object(d.a)(Ws||(Ws=Object(s.a)(["\n        background-color: #da909082;\n    "]))):""})),Kl=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=t.scoreState,a=t.scoreData.chordList[c.focusIndex].detail,r=function(e){a.labelName=e,t.scoreData.chordList=t.scoreData.chordList.slice(),i.score.setScoreData(t.scoreData)},s=Object(o.useMemo)((function(){var e=[];return Qt.SECTION_CATEGORY.forEach((function(n){var t=0===a.labelName.indexOf(n);e.push(Object(se.jsx)(Yl,{isActive:t,onClick:function(){r(n)},children:n},e.length))})),e}),[a.labelName]),l=Object(o.useMemo)((function(){var e=[],n=a.labelName.split(" ");return Qt.SECTION_NO.forEach((function(t){var i=n[n.length-1]===t.toString();e.push(Object(se.jsx)(Gl,{isActive:i,onClick:function(){r("".concat(n[0]," ").concat(t))},children:t},e.length))})),e}),[a.labelName]);return Object(se.jsxs)(Ul,{children:[Object(se.jsx)(Vl,{type:"text",value:a.labelName,onChange:function(e){r(e.target.value)}}),Object(se.jsxs)(Hl,{children:[Object(se.jsx)(Jl,{children:s}),Object(se.jsx)(Wl,{children:l})]})]})},Ul=d.b.div(Ys||(Ys=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    text-align: left;\n    /* background-color: #b89b9b; */\n"]))),Vl=d.b.input(Gs||(Gs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 30px;\n    text-align: left;\n    background-color: #bbbbbb;\n    font-size: 22px;\n    font-weight: 600;\n    color: #a30000;\n    box-sizing: border-box;\n    outline: none;\n    border: 1px solid black;\n    border-radius: 4px;\n"]))),ql=d.b.div(Qs||(Qs=Object(s.a)(["\n    ","\n    width: 100%;\n    vertical-align: top;\n"])),Vr.___CSS_FORM),Hl=d.b.div(Xs||(Xs=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    padding: 2px;\n    box-sizing: border-box;\n    background-color: #acacac;\n"]))),Jl=d.b.div(Zs||(Zs=Object(s.a)(["\n    display: inline-block;\n    width: calc(60% - 4px);\n    margin: 0 2px 0 2px;\n    text-align: center;\n    background-color: #dac3d8;\n    vertical-align: top;\n"]))),Wl=d.b.div($s||($s=Object(s.a)(["\n    display: inline-block;\n    width: calc(40% - 2px);\n    margin: 0 2px 0 0;\n    text-align: center;\n    background-color: #dac3d8;\n    vertical-align: top;\n"]))),Yl=Object(d.b)(ql)(el||(el=Object(s.a)(["\n    /* background-color: #6182b4; */\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(nl||(nl=Object(s.a)(["\n        background-color: #ad993fe6;\n    "]))):""})),Gl=Object(d.b)(ql)(tl||(tl=Object(s.a)(["\n    /* background-color: #61b4b0; */\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(il||(il=Object(s.a)(["\n        background-color: #ad993fe6;\n    "]))):""})),Ql=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,n.scoreState),i=n.scoreData.chordList;if(-1===t.focusIndex||t.focusIndex>i.length-1)return Object(se.jsx)(se.Fragment,{});var c=i[t.focusIndex];return Object(se.jsx)(Xl,{children:function(){switch(c.type){case"init":return Object(se.jsx)(Ml,{});case"section":return Object(se.jsx)(Kl,{});case"chord":return Object(se.jsx)(ml,{});case"alter":return Object(se.jsx)(al,{})}}()})},Xl=d.b.div(ol||(ol=Object(s.a)(["\n    display: inline-block;\n    margin: 3px 0 0 3px;\n    width: calc(100% - 6px);\n    height: calc(100% - 6px);\n    text-align: left;\n    background-color: #8a8a8a;\n"])));(cl||(cl={})).Component=function(e){var n,t,i,c,a,r=Object(o.useRef)(null),s=null!==(n=e.uiParam.sideMargin)&&void 0!==n?n:8,l=null!==(t=e.uiParam.topMargin)&&void 0!==t?t:4,d=null!==(i=e.uiParam.bottomMargin)&&void 0!==i?i:4,b=null!==(c=e.uiParam.scaleColor)&&void 0!==c?c:"#fc5e5e88",u=null!==(a=e.uiParam.scaleColor)&&void 0!==a?a:"#fcd75e87";return Object(o.useEffect)((function(){var n=r.current.getContext("2d"),t=function(e,t,i,o,c){var a=n.createLinearGradient(e,t,i,o);c.forEach((function(e){a.addColorStop(e.offset,e.color)})),n.fillStyle=a};t(0,0,0,e.uiParam.height,[{offset:0,color:"#727272"},{offset:.5,color:"#000000"},{offset:1,color:"#727272"}]),n.fillRect(0,0,e.uiParam.width,e.uiParam.height);var i=e.uiParam.width-2*s,o=e.uiParam.height-(l+d),c=i/e.uiParam.wKeyNum,a=function(n){for(var t=0,i=0;i<e.uiParam.wKeyNum;i++)n(i,t,s+i*c,l,c-2,.9*o),t++,[0,1,3,4,5].includes(i%7)&&t++};a((function(i,c,a,r,s,l){t(a,r,a,r+l,[{offset:0,color:"#c0c0c0"},{offset:.4,color:"#e2e2e2"},{offset:1,color:"#ffffff"}]),n.fillRect(a,r,s,l),n.fillStyle="#c7c7c7",n.fillRect(a,r+l,s,.1*o),e.uses.includes(c)&&(n.fillStyle=e.scaleList.includes(c%12)?b:u,n.fillRect(a,r,s,l+.1*o))})),a((function(i,o,a,r,s,l){if([0,1,3,4,5].includes(i%7)){var d=r,h=.6*c,p=a+c-1-h/2,x=.7*l,f=.9*x,g=.1*x;t(p,d,p+h,d,[{offset:0,color:"#030303"},{offset:.5,color:"#adadad"},{offset:1,color:"#030303"}]),n.fillRect(p,d,h,f),t(p,d,p,d+f,[{offset:0,color:"#03030334"},{offset:.4,color:"#03030361"},{offset:1,color:"#000000"}]),n.fillRect(p,d,h,f),t(p,d+f,p,d+x,[{offset:0,color:"#727272"},{offset:1,color:"#000000"}]),n.fillRect(p,d+f,h,g),e.uses.includes(o+1)&&(n.fillStyle=e.scaleList.includes((o+1)%12)?b:u,n.fillRect(p,d,h,x)),t(p,d+x,p,d+x+.2*x,[{offset:0,color:"#0000004e"},{offset:1,color:"#00000001"}]),n.fillRect(p,d+x,h,.2*x)}})),n.save()}),[e.uses]),Object(se.jsx)("canvas",{ref:r,width:e.uiParam.width,height:e.uiParam.height})};var Zl,$l,ed,nd,td,id,od,cd,ad,rd,sd,ld,dd,bd,ud,hd,pd,xd,fd,gd,jd,vd,md,Od,kd,yd,Sd,wd,Ld,Id,Ad,Ed,Cd,Td,Md,Dd,Nd,Fd,_d,zd,Rd,Bd,Pd,Kd,Ud,Vd,qd,Hd,Jd,Wd,Yd,Gd,Qd,Xd,Zd,$d,eb,nb,tb,ib,ob,cb,ab,rb,sb,lb,db,bb,ub,hb,pb,xb,fb,gb,jb,vb,mb,Ob,kb,yb,Sb,wb,Lb,Ib,Ab,Eb,Cb,Tb,Mb,Db,Nb,Fb,_b,zb,Rb,Bb,Pb,Kb,Ub,Vb,qb,Hb,Jb,Wb,Yb,Gb,Qb,Xb,Zb,$b,eu,nu,tu,iu,ou,cu,au,ru,su,lu,du,bu,uu,hu,pu,xu,fu,gu,ju,vu,mu,Ou,ku,yu=cl,Su=function(e){var n=e.cache,t=e.structList.map((function(e){return e.soundIndex+12*e.adjustOctave})),i=("major"===n.scale?v.MAJOR_SCALE_INTERVALS:v.MINOR_SCALE_INTERVALS).map((function(e){return(n.keyIndex+e)%12}));return Object(o.useEffect)((function(){}),[]),Object(se.jsx)(wu,{isUse:t.length>0,children:Object(se.jsx)(yu.Component,{uiParam:{width:380,height:80,wKeyNum:14},uses:t,scaleList:i})})},wu=d.b.div(Zl||(Zl=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    ","\n    & * {\n        vertical-align: top;\n    }\n"])),(function(e){return e.isUse?"":Object(d.a)($l||($l=Object(s.a)(["\n        opacity: 0.5;\n    "])))})),Lu=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.pattern,a=c.layers[c.layerIndex],r=c.channels.length-1-c.channelIndex,s=a.table[r][c.lenIndex],l=a.velocityList[c.lenIndex],d=null==s||void 0==s.timing?0:s.timing,b=null==s||void 0==s.velAdj?0:s.velAdj;return Object(se.jsx)(Iu,{children:null==s?Object(se.jsx)(se.Fragment,{}):Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(Eu,{children:[Object(se.jsx)(Au,{children:"delay"}),Object(se.jsx)(Cu,{type:"range",min:-10,max:10,step:1,value:d,onChange:function(e){s.timing=Number(e.target.value),t.backing.setState(i)}})]}),Object(se.jsxs)(Tu,{children:[Object(se.jsx)(Au,{children:"velocity"}),Object(se.jsx)(Mu,{isFocus:!1,children:Object(se.jsx)(Du,{value:l,isEdit:!1})}),Object(se.jsx)(Mu,{isFocus:n.scoreState.keySwitch.sustainMode,children:Object(se.jsx)(Du,{value:l+b,isEdit:0!=b})})]})]})})},Iu=d.b.div(ed||(ed=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    /* white-space: nowrap; */\n"]))),Au=d.b.div(nd||(nd=Object(s.a)(["\n    ","\n    line-height: 18px;\n    margin-top: 14px;\n    margin-left: 5px;\n    width: 80px;\n    background-color: #868686;\n    color: #e7e7e7;\n    border: 1px solid #616161;\n    border-radius: 4px;\n"])),Be.CSS_LABEL_SMALL),Eu=d.b.div(td||(td=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - ","px);\n    height: 100%;\n    background-color: #9c9c9c;\n"])),181),Cu=d.b.input(id||(id=Object(s.a)(["\n    display: inline-block;\n    outline: none;\n    margin: 20px 0 0 8px;\n    width: calc(100% - 100px);\n    height: 10px;\n    box-sizing: border-box;\n"]))),Tu=d.b.div(od||(od=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: ","px;\n    height: 100%;\n    margin-left: 1px;\n    /* background-color: #9a2020; */\n"])),180),Mu=d.b.div(cd||(cd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 46px;\n    height: 100%;\n    ","\n    /* background-color: #63a0a1;\n    border-radius: 20px; */\n"])),(function(e){return e.isFocus?Object(d.a)(ad||(ad=Object(s.a)(["\n        background-color: #ffffff17;\n    "]))):""})),Du=d.b.div(rd||(rd=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    bottom: 0;\n    left: calc(50% - 5px);\n    width: 10px;\n    height: ","%;\n    background-color: #5cceddaf;\n    ","\n"])),(function(e){return 10*e.value}),(function(e){return e.isEdit?Object(d.a)(sd||(sd=Object(s.a)(["\n        background-color: #ddc35cae;\n    "]))):""})),Nu=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.chordInfo,a=[],r=i.pattern,s=r.layers[r.layerIndex],l=4===v.getBeatProps(c.init.beatSignature).beatMemoriCount?1:1.5;return s.noteDivList.forEach((function(e,n){var o=r.lenIndex===n,c=o&&-1!==r.channelIndex,s=e.rate;e.isDot&&(s/=1.5),0!==e.div3&&(s/=e.div3/3),a.push(Object(se.jsxs)(_u,{rate:s*l,isActive:o,isEdit:c,onClick:function(){r.channelIndex=-1,r.lenIndex=n,t.backing.setState(i)},children:[e.rate,e.isDot?".":"",0===e.div3?"":"/"]},n))})),Object(se.jsx)(Fu,{children:a})},Fu=d.b.div(ld||(ld=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    white-space: nowrap;\n"]))),_u=d.b.div(dd||(dd=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: calc(100% - 4px);\n    margin: 2px 0 0 1px;\n    background-color: #1616beb0;\n    ","\n    ","\n    box-sizing: border-box;\n\n    font-size: 14px;\n    font-weight: 600;\n    color: #ffffffba;\n    text-align: center;\n"])),(function(e){return ae/e.rate-1}),(function(e){return e.isActive?Object(d.a)(bd||(bd=Object(s.a)(["\n        background-color: #6363eeaf;\n    "]))):""}),(function(e){return e.isEdit?Object(d.a)(ud||(ud=Object(s.a)(["\n        background-color: #b40000af;\n    "]))):""})),zu=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.chordInfo,a=[],r=i.pattern,s=r.layers[0],l=4===v.getBeatProps(c.init.beatSignature).beatMemoriCount?1:1.5,d="off";return r.pedalActs.forEach((function(e,n){var o=0===r.layerIndex&&r.lenIndex===n,c=s.noteDivList[n],b=c.rate*l;c.isDot&&(b/=1.5),0!==c.div3&&(b/=c.div3/3);var u=!1,h=d;"change"===h&&(d="on"),null!=e&&(u=!0,d=e),a.push(Object(se.jsx)(Bu,{rate:b,isActive:o,isUse:u,onClick:function(){if("off"===h)switch(e){case null:r.pedalActs[n]="on";break;case"on":r.pedalActs[n]=null}else if("on"===h)switch(e){case null:r.pedalActs[n]="off";break;case"off":r.pedalActs[n]="change";break;case"change":r.pedalActs[n]=null}else if("change"===h)switch(e){case null:r.pedalActs[n]="off";break;case"off":r.pedalActs[n]=null}if(n<r.pedalActs.length-1)for(var o=n+1;o<r.pedalActs.length;o++)r.pedalActs[o]=null;t.backing.setState(i)},children:Object(se.jsx)("div",{children:Object(se.jsx)(Pu,{action:d})})},n))})),Object(se.jsx)(Ru,{children:a})},Ru=d.b.div(hd||(hd=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    white-space: nowrap;\n    /* background-color: #4e4e4e; */\n"]))),Bu=d.b.div(pd||(pd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: ","px;\n    height: calc(100% - 4px);\n    margin: 2px 0 0 1px;\n    background-color: #00635eac;\n    ","\n    box-sizing: border-box;\n    text-align: center;\n    white-space: normal;\n\n    &>div {\n        display: inline-block;\n        width: 10px;\n        height: calc(100% - 2px);\n        background-color: #ffffffa0;\n        border-radius: 6px;\n        margin: 1px 0;\n        ","\n    }\n"])),(function(e){return ae/e.rate-1}),(function(e){return e.isActive?Object(d.a)(xd||(xd=Object(s.a)(["\n        background-color: #179483ac;\n    "]))):""}),(function(e){return e.isUse?"":Object(d.a)(fd||(fd=Object(s.a)(["\n            background-color: #ffffff2f;\n        "])))})),Pu=d.b.div(gd||(gd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: 14px;\n    border: 1px solid #9c9c9c;\n    ","\n    box-sizing: border-box;\n    border-radius: 6px;\n"])),(function(e){switch(e.action){case"off":return Object(d.a)(jd||(jd=Object(s.a)(["\n                margin-top: 0;\n                background-color: #271db8;\n            "])));case"change":return Object(d.a)(vd||(vd=Object(s.a)(["\n                margin-top: 15px;\n                background-color: #f3d631;\n            "])));case"on":return Object(d.a)(md||(md=Object(s.a)(["\n                margin-top: 30px;\n                background-color: #e03030;\n            "])))}})),Ku=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.chordInfo,a=i.pattern,r=a.channels.length,s=a.layers[a.layerIndex],l=function(){return t.backing.setState(i)},d=4===v.getBeatProps(c.init.beatSignature).beatMemoriCount?1:1.5,b=Object(o.useMemo)((function(){var e=Array(2);return a.layers.forEach((function(n,i){for(var o=[],c=function(e){var c=[];n.noteDivList.forEach((function(o,b){var u=r-1-e,h=a.layerIndex===i&&a.lenIndex===b,p=n.table[u][b],x=function(e){return n.table[u][b]=e},f=null!=p,g=a.layerIndex===i&&(f&&O.checkOverlapBackLayer(a.layers,i,u,b)),j=h&&a.channelIndex===e,v=o.rate*d;o.isDot&&(v/=1.5),0!==o.div3&&(v/=o.div3/3);var m=null;if(null!=p&&(m=p.signal,b>0)){var k=n.table[u][b-1];null!=k&&"t"===k.signal&&(m="t")}c.push(Object(se.jsx)(qu,{rate:v,isActive:h,isEdit:j,isBack:a.layerIndex!==i,children:Object(se.jsx)(Hu,{isError:g,signal:m,isBack:a.layerIndex!==i,onClick:function(){if(null==p){var e=void 0==n.table.find((function(e){var n=e[b];if(null!=n&&"s"===n.signal)return n}))?"n":"s";x({signal:e,timing:0,velAdj:0})}else x(null);s.table=s.table.slice(),l(),t.backing.updateErrorState()},onContextMenu:function(){a.channelIndex=e,a.lenIndex=b,l()}})},b))})),o.push(Object(se.jsx)(Vu,{isEven:e%2==0,isFront:!0,children:c},e))},b=0;b<r;b++)c(b);e[i]=o})),e}),[a.channels,a.layerIndex,a.lenIndex,s.noteDivList,s.table,a.channelIndex]),u=0===a.layerIndex?b:b.reverse();return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Uu,{zIndex:2,children:u[1]}),Object(se.jsx)(Uu,{zIndex:1,children:u[0]})]})},Uu=d.b.div(Od||(Od=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    /* background-color: #000000f; */\n"]))),Vu=d.b.div(kd||(kd=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 20px;\n    overflow: hidden;\n    white-space: nowrap;\n    ","\n"])),(function(e){return e.isFront?Object(d.a)(yd||(yd=Object(s.a)(["\n        ","\n    "])),(function(e){return e.isEven?Object(d.a)(wd||(wd=Object(s.a)(["\n            background-color: #42425542;\n        "]))):Object(d.a)(Sd||(Sd=Object(s.a)(["\n            background-color: #3a3a502f;\n        "])))})):""})),qu=d.b.div(Ld||(Ld=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: calc(100% - 1px);\n    margin: 1px 0 0 1px;\n    ","\n    ","\n    box-sizing: border-box;\n\n    &:hover {\n        background-color: #82f7ff57;\n    }\n"])),(function(e){return ae/e.rate-1}),(function(e){return e.isBack?"":Object(d.a)(Id||(Id=Object(s.a)(["\n        background-color: #00000013;\n        ","\n    "])),(function(e){return e.isActive?Object(d.a)(Ad||(Ad=Object(s.a)(["\n            background-color: #9b9b9b1d;\n        "]))):""}))}),(function(e){return e.isEdit?Object(d.a)(Ed||(Ed=Object(s.a)(["\n        border: 2px solid #d80000ba;\n    "]))):""})),Hu=d.b.div(Cd||(Cd=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 2px);\n    height: calc(100% - 2px);\n    margin: 1px 0 0 1px;\n    background-color: #a7a7a754;\n    ","\n    box-sizing: border-box;\n    &:hover {\n        background-color: #ffffff63;\n        ","\n    }\n"])),(function(e){return null==e.signal?"":Object(d.a)(Td||(Td=Object(s.a)(["\n        /* background-color: #f8fc029b; */\n        background: linear-gradient(to bottom, #9b9e00, #f8fc02, #9b9e00);\n        ","\n        ","\n        // \u30a8\u30e9\u30fc\u3042\u308a\n        ","\n        // \u88cf\u9762\u306e\u30ec\u30a4\u30e4\u30fc\n        ","\n    "])),(function(e){return"s"!==e.signal?"":Object(d.a)(Md||(Md=Object(s.a)(["\n            border-radius: 8px;\n            background: linear-gradient(to bottom, #009e0d, #02fc49, #009e0d);\n        "])))}),(function(e){return"t"!==e.signal?"":Object(d.a)(Dd||(Dd=Object(s.a)(["\n            height: calc(100% - 8px);\n            margin: 4px 0 0 1px;\n            background: linear-gradient(to bottom, #9e4c00, #fc6a02, #9e4c00);\n        "])))}),(function(e){return e.isError?Object(d.a)(Nd||(Nd=Object(s.a)(["\n            opacity: 0.5;\n        "]))):""}),(function(e){return e.isBack?Object(d.a)(Fd||(Fd=Object(s.a)(["\n            background: linear-gradient(to bottom, #9e0000, #fc0202, #9e0000);\n            opacity: 0.5;\n        "]))):""}))}),(function(e){return null==e.signal?"":Object(d.a)(_d||(_d=Object(s.a)(["\n            background-color: #fdff719b;\n        "])))})),Ju=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,n.backingState),i=t.chordInfo,c=[],a=t.pattern,r=a.layers[a.layerIndex],s=4===v.getBeatProps(i.init.beatSignature).beatMemoriCount?1:1.5;return r.velocityList.forEach((function(e,n){var t=a.lenIndex===n,i=r.noteDivList[n],o=i.rate*s;i.isDot&&(o/=1.5),0!==i.div3&&(o/=i.div3/3),c.push(Object(se.jsx)(Yu,{rate:o,isActive:t,children:Object(se.jsx)(Gu,{value:e})},n))})),Object(se.jsx)(Wu,{children:c})},Wu=d.b.div(zd||(zd=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    white-space: nowrap;\n"]))),Yu=d.b.div(Rd||(Rd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: ","px;\n    height: calc(100% - 4px);\n    margin: 2px 0 0 1px;\n    background-color: #001763ac;\n    ","\n    box-sizing: border-box;\n    /* text-align: center; */\n"])),(function(e){return ae/e.rate-1}),(function(e){return e.isActive?Object(d.a)(Bd||(Bd=Object(s.a)(["\n        background-color: #173494ac;\n    "]))):""})),Gu=d.b.div(Pd||(Pd=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    bottom: 0;\n    left: calc(50% - 6px);\n    width: 10px;\n    height: ","%;\n    /* background-color: #5cceddaf; */\n    background: linear-gradient(to right, #00949e, #26dcf4, #00949e);\n"])),(function(e){return 10*e.value})),Qu=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,n.backingState),i=t.chordInfo,c=t.pattern,a=c.layers[c.layerIndex].noteDivList,r=O.getLimitLen(i.beatLen,i.minute,i.init.beatSignature),s=O.getUsingLenFromDivs(a,i.init.beatSignature),l=0<=r-s,d=v.getBeatProps(i.init.beatSignature),b=i.beatLen*d.beatMemoriCount;b+=i.minute.head+i.minute.tail;for(var u=4===d.beatMemoriCount?16:24,h=ae/u,p=[],x=0;x<b+1;x++){var f=x,g={thickness:1,height:10,color:"#555"};if(4===d.beatMemoriCount)switch(!0){case f%16===0:g={thickness:2,height:22,color:"#747474"};break;case f%4===0:g={thickness:2,height:18,color:"#646464"};break;case f%2===0:g={thickness:1,height:14,color:"#7a7a7a"}}else switch(!0){case f%24===0:g={thickness:2,height:22,color:"#747474"};break;case f%6===0:g={thickness:2,height:18,color:"#646464"};break;case f%2===0:g={thickness:1,height:14,color:"#7a7a7a"}}p.push(Object(se.jsx)(nh,{width:h,height:g.height,color:g.color,thickness:g.thickness},p.length))}return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(Xu,{children:[Object(se.jsx)(Zu,{children:Object(se.jsx)(Nu,{})}),Object(se.jsxs)($u,{children:[Object(se.jsx)(eh,{children:p}),l?Object(se.jsx)(ch,{pos:120*r}):Object(se.jsx)(th,{pos:120*r,width:120*(s-r)})]})]}),Object(se.jsx)(ih,{children:Object(se.jsx)(Ku,{})}),Object(se.jsx)(oh,{children:-1===c.channelIndex?"velocity"===c.mode?Object(se.jsx)(Ju,{}):Object(se.jsx)(zu,{}):Object(se.jsx)(Lu,{})})]})},Xu=d.b.div(Kd||(Kd=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #9292bdd6;\n"])),oe),Zu=d.b.div(Ud||(Ud=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #9292bdd6;\n"])),25),$u=d.b.div(Vd||(Vd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: ","px;\n    background-color: #b492bdd5;\n    background: linear-gradient(to bottom, rgb(255, 255, 255), rgb(98, 97, 114));\n"])),25),eh=d.b.div(qd||(qd=Object(s.a)(["\n    position: absolute;\n    width: 100%;\n    height: 100%;\n"]))),nh=d.b.div(Hd||(Hd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: ","px;\n    height: ","px;\n    border-left: solid ","px ",";\n    box-sizing: border-box;\n"])),(function(e){return e.width}),(function(e){return e.height}),(function(e){return e.thickness}),(function(e){return e.color})),th=d.b.div(Jd||(Jd=Object(s.a)(["\n    position: absolute;\n    z-index: 10;\n    left: ","px;\n    width: ","px;\n    height: ","px;\n    background-color: #f8000053;\n    pointer-events: none;\n"])),(function(e){return e.pos}),(function(e){return e.width}),265),ih=d.b.div(Wd||(Wd=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: ","px;\n    background-color: #97d3cec8;\n"])),ce),oh=d.b.div(Yd||(Yd=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #898997cc;\n"])),50),ch=d.b.div(Gd||(Gd=Object(s.a)(["\n    position: absolute;\n    z-index: 10;\n    left: ","px;\n    width: 4px;\n    height: ","px;\n    background-color: #ffffffc7;\n"])),(function(e){return e.pos}),265),ah=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=t.backingState,a=c.pattern,r=a.channels.length-1-e.index,s=a.channels.length,l=function(){i.backing.setState(c),i.backing.updateErrorState()};return Object(se.jsx)(se.Fragment,{children:Object(se.jsxs)(rh,{isError:"-"===e.soundFullName,children:[Object(se.jsx)(lh,{onClick:function(){null!=e.soundfont&&e.soundfont.play(e.soundFullName,0,{duration:1})},children:e.soundFullName}),Object(se.jsx)(dh,{isEnable:s>1,onClick:function(){a.layers.forEach((function(e){e.table.splice(r,1)}));var e=O.buildVoicsFromTable(c.voicingTable);a.channels=O.getChannels(e,a.channels.length-1),a.channelIndex=-1,l()},children:"-"}),Object(se.jsx)(dh,{isEnable:s<O.CHANNEL_MAX,onClick:function(){a.layers.forEach((function(e){var n=O.getInitialRecord(e.noteDivList.length);e.table.splice(r,0,n)}));var e=O.buildVoicsFromTable(c.voicingTable);a.channels=O.getChannels(e,a.channels.length+1),a.channelIndex=-1,l()},children:"+"})]})})},rh=d.b.div(Qd||(Qd=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 19px;\n    background-color: #b4b3b36f;\n    ","\n    margin: 0 0 1px 0;\n"])),(function(e){return e.isError?Object(d.a)(Xd||(Xd=Object(s.a)(["\n        background-color: #ff0000c3;\n    "]))):""})),sh=d.b.div(Zd||(Zd=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    margin: 0 1px 0 0;\n    border: 1px solid #322e4292;\n    border-radius: 4px;\n    box-sizing: border-box;\n    font-size: 12px;\n    font-weight: 600;\n    color: #ffffff;\n    text-align: center;\n    &:hover {\n        background-color: #f1ef866c;\n    }\n"]))),lh=Object(d.b)(sh)($d||($d=Object(s.a)(["\n    width: 47px;\n\n"]))),dh=Object(d.b)(sh)(eb||(eb=Object(s.a)(["\n    width: 25px;\n    &:hover {\n        background-color: #f1ef866c;\n    }\n    ","\n    \n"])),(function(e){return e.isEnable?"":Ue})),bh=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.chordInfo,a=[],r=[];if(null==i.pattern)return Object(se.jsx)(se.Fragment,{});var s=i.pattern;return s.channels.forEach((function(e,t){var i="-";if(-1!==e.octave){var o=c.structList[e.structIndex],r=o.soundIndex,s=e.octave+o.adjustOctave;i=(o.isFlat?v.KEY12_FLAT_LIST:v.KEY12_SHARP_LIST)[r%12]+s}a.push(Object(se.jsx)(ah,{soundfont:n.instruments.harmonyFont,index:t,soundFullName:i},t))})),s.layers.forEach((function(e,n){var i=0===n?"L-HAND":"R-HAND";r.push(Object(se.jsx)(hh,{isActive:s.layerIndex===n,onClick:function(){n!==s.layerIndex&&t.backing.switchLayer()},children:i},n))})),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(uh,{children:r}),Object(se.jsx)(ph,{children:a}),Object(se.jsxs)(xh,{children:[Object(se.jsx)(fh,{isActive:"velocity"===s.mode,onClick:function(){s.mode="velocity",t.backing.setState(i)},children:"Velocity"}),Object(se.jsx)(fh,{isActive:"pedal"===s.mode,onClick:function(){s.mode="pedal",t.backing.setState(i)},children:"Pedal"})]})]})},uh=d.b.div(nb||(nb=Object(s.a)(["\n    /* display: inline-block; */\n    width: 100%;\n    height: ","px;\n    background-color: #929292;\n"])),oe),hh=d.b.div(tb||(tb=Object(s.a)(["\n    display: inline-block;\n    height: 22px;\n    width: calc(100% - 4px);\n    margin: 2px 0 0 2px;\n    box-sizing: border-box;\n    text-align: center;\n    \n    font-size: 14px;\n    font-weight: 600;\n    color: #3b3b3b;\n    line-height: 20px;\n    background-color: #b8b8b8;\n    border: 1px solid #7a7a7a;\n    border-radius: 2px;\n\n    ","\n\n    &:hover {\n        background-color: #d4d4d4;\n    }\n"])),(function(e){return e.isActive?Object(d.a)(ib||(ib=Object(s.a)(["\n        background-color: #dad600;\n        color: #c40000;\n    "]))):""})),ph=d.b.div(ob||(ob=Object(s.a)(["\n/* display: inline-block; */\n    width: 100%;\n    height: ","px;\n    background-color: #97d3cec8;\n"])),ce),xh=d.b.div(cb||(cb=Object(s.a)(["\n/* display: inline-block; */\n    width: 100%;\n    height: ","px;\n    background-color: #898997;\n"])),50),fh=d.b.div(ab||(ab=Object(s.a)(["\n    display: inline-block;\n    height: 22px;\n    width: calc(100% - 4px);\n    margin: 2px 0 0 2px;\n    box-sizing: border-box;\n    text-align: center;\n    \n    font-size: 14px;\n    font-weight: 600;\n    color: #3b3b3b;\n    line-height: 20px;\n    background-color: #b8b8b8;\n    border: 1px solid #7a7a7a;\n    border-radius: 2px;\n\n    ","\n\n    &:hover {\n        background-color: #d4d4d4;\n    }\n"])),(function(e){return e.isActive?Object(d.a)(rb||(rb=Object(s.a)(["\n        background-color: #4fe419;\n        color: #c40000;\n    "]))):""})),gh=function(){for(var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.pattern,a=c.layers[c.layerIndex],r=c.channels.length-1-c.channelIndex,s=a.noteDivList[c.lenIndex],l=i.chordInfo,d=function(){a.noteDivList=a.noteDivList.slice(),t.backing.setState(i),t.backing.updateErrorState()},b=function(e,n,t,i){return Object(se.jsx)(kh,{isEnable:t,isActive:n,onClick:i,children:e})},u=function(e){return b(String(e),s.rate===e,!0,(function(){return function(e){s.rate=e,d()}(e)}))},h=[],p=0;p<O.CHANNEL_MAX;p++){var x=p+1;h.push(Object(se.jsx)(Oh,{value:x,children:x},p))}var f=["2/4","4/4","4/3"].includes(l.init.beatSignature),g=O.isPermitDot(s),j=Object(se.jsxs)(jh,{children:[Object(se.jsx)(mh,{value:c.channels.length,onChange:function(e){var n=c.channels.length,t=Number(e.target.value),o=O.buildVoicsFromTable(i.voicingTable);c.channels=O.getChannels(o,t);var a=Number(e.target.value)-n;c.layers.forEach((function(e,n){if(a>0)for(var t=new Array(e.noteDivList.length).fill(null),i=0;i<a;i++)e.table.push(JSON.parse(JSON.stringify(t)));else{var o=Math.abs(a);e.table.splice(-o,o)}})),d()},children:h}),u(16),u(8),u(4),u(2),u(1),b(".",s.isDot,g,(function(){s.isDot=!s.isDot,d()})),b("1/3",1===s.div3,f,(function(){1===s.div3?s.div3=0:s.div3=1,d()})),b("2/3",2===s.div3,f,(function(){2===s.div3?s.div3=0:s.div3=2,d()}))]}),v=a.table[r],m=-1===c.channelIndex?null:v[c.lenIndex],k=function(e){a.table.forEach((function(n){var t=n[c.lenIndex];null!=t&&(t.signal=e?"s":"n")}))},y=Object(se.jsxs)(vh,{children:[b("-",null==m,!0,(function(){v[c.lenIndex]=null,d()})),b("\u25a1",null!=m&&"n"===m.signal,!0,(function(){null!=m?"s"===m.signal?k(!1):m.signal="n":v[c.lenIndex]={signal:"n",timing:0,velAdj:0},d()})),b("\u30fb",null!=m&&"s"===m.signal,null!=m&&void 0==a.table.find((function(e){var n=e[c.lenIndex];if(null!=n&&"t"===n.signal)return n})),(function(){k(!0),d()})),b("\u2040",null!=m&&"t"===m.signal,function(){if(null==v)return!1;var e=void 0!=a.table.find((function(e){var n=e[c.lenIndex];if(null!=n&&"s"===n.signal)return n})),n=!1;return c.lenIndex<v.length-1&&null!=v[c.lenIndex+1]&&(n=!0),!e&&n}(),(function(){m.signal="t",d()}))]});return-1===c.channelIndex?j:y},jh=d.b.div(sb||(sb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    background-color: #86c5b2;\n"]))),vh=d.b.div(lb||(lb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    background-color: #86b8c5;\n"]))),mh=d.b.select(db||(db=Object(s.a)(["\n    display: inline-block;\n    width: 50px;\n    height: 26px;\n    margin: 2px 2px 0 0;\n    color: #eeff00;\n    font-size: 20px;\n    font-weight: 600;\n    background-color: #d4d4d422;\n    border: solid 1px #555;\n    border-radius: 4px;\n    box-sizing: border-box;\n    line-height: 20px;\n    text-align: center;\n    outline: none;\n"]))),Oh=d.b.option(bb||(bb=Object(s.a)(["\n    background-color: black;\n    color: white;\n    font-size: 16px;\n    font-weight: 600;\n"]))),kh=d.b.div(ub||(ub=Object(s.a)(["\n    display: inline-block;\n    width: 50px;\n    height: 26px;\n    margin: 2px 2px 0 0;\n    font-size: 20px;\n    color: white;\n    font-weight: 600;\n    background-color: #ff008023;\n    border: solid 1px #555;\n    border-radius: 4px;\n    box-sizing: border-box;\n    line-height: 20px;\n    text-align: center;\n\n    ","\n\n    ","\n\n    &:hover {\n        background-color: #ff008039;\n        ","\n    }\n"])),(function(e){return e.isEnable?"":Object(d.a)(hb||(hb=Object(s.a)(["\n        opacity: 0.5;\n        pointer-events: none;\n    "])))}),(function(e){return e.isActive?Object(d.a)(pb||(pb=Object(s.a)(["\n        background-color: #fbff0050;\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(xb||(xb=Object(s.a)(["\n            background-color: #dfe07850;\n        "]))):""})),yh=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=(i.chordInfo,null!=i.pattern),a=function(){t.backing.setState(i)};return Object(se.jsxs)(Sh,{children:[Object(se.jsx)(wh,{children:Object(se.jsxs)(Ih,{children:[Object(se.jsx)(Lh,{children:"Pattern"}),Object(se.jsx)(Ah,{isActive:c,onClick:function(){if(c)i.pattern=null,a();else{var e=i.voicingTable,n=O.buildVoicsFromTable(e),o=O.getChannels(n,1);i.pattern={layerIndex:0,lenIndex:0,channelIndex:-1,channels:o,isUsePedal:!1,mode:"velocity",pedalActs:[null],layers:[t.backing.getInitialLayer(),t.backing.getInitialLayer()]},a()}},children:"Use"})]})}),Object(se.jsx)(Eh,{isActive:c,children:c?Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Ch,{children:Object(se.jsx)(gh,{})}),Object(se.jsxs)(Th,{children:[Object(se.jsx)(Mh,{children:Object(se.jsx)(bh,{})}),Object(se.jsx)(Dh,{children:Object(se.jsx)(Qu,{})})]})]}):Object(se.jsx)(se.Fragment,{})})]})},Sh=d.b.div(fb||(fb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    /* height: 300px; */\n    background-color: #001279;\n\n    & *{\n        /* display: inline-block;\n        width: 100%; */\n    }\n"]))),wh=d.b.div(gb||(gb=Object(s.a)(["\n    height: 30px;\n    background-color: #a5d1c3;\n"]))),Lh=d.b.div(jb||(jb=Object(s.a)([""]))),Ih=d.b.div(vb||(vb=Object(s.a)(["\n    display: inline-block;\n    width: 200px;\n    height: 100%;\n    /* background-color: #7986d1; */\n\n    & * {\n        display: inline-block;\n        height: calc(100% - 4px);\n        margin-top: 2px;\n        box-sizing: border-box;        \n    }\n\n    & "," {\n        width: 80px;\n        font-size: 20px;\n        color: #f1fffb;\n        font-weight: 600;\n        /* background-color: #00000028; */\n        margin: 2px 2px 0 2px;\n        line-height: 22px;\n        text-align: center;\n    }\n"])),Lh),Ah=d.b.div(mb||(mb=Object(s.a)(["\n    width: 100px;\n    font-size: 20px;\n    color: white;\n    font-weight: 600;\n    background-color: #ff008023;\n    border: solid 1px #555;\n    border-radius: 4px;\n    line-height: 20px;\n    text-align: center;\n\n    ","\n\n    &:hover {\n        background-color: #ff008039;\n    }\n"])),(function(e){return e.isActive?Object(d.a)(Ob||(Ob=Object(s.a)(["\n        /* background-color: #b1dfc979; */\n        color: #e00000;\n    "]))):""})),Eh=d.b.div(kb||(kb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    overflow: hidden;\n    height: ","px;\n    ","\n    transition: height 100ms;\n"])),370,(function(e){return e.isActive?"":Object(d.a)(yb||(yb=Object(s.a)(["\n        height: 0;\n    "])))})),Ch=d.b.div(Sb||(Sb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #8d98d4;\n    text-align: left;\n"])),30),Th=d.b.div(wb||(wb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    background-color: #d48d8d;\n\n    /* & *{\n        display: inline-block;\n        height: 100%;\n    } */\n"]))),Mh=d.b.div(Lb||(Lb=Object(s.a)(["\n    display: inline-block;\n    width: 100px;\n    background-color: #ff0000;\n    vertical-align: top;\n"]))),Dh=d.b.div(Ib||(Ib=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 100px);\n    background-color: #76af90;\n    vertical-align: top;\n"]))),Nh=function(){for(var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=i.voicingTable,a=i.pattern,r=null==a?O.OCTAVE_NUM*O.STRUCT_NUM:a.channels.length,s=i.chordInfo,l=s.structList,d=[],b=0,u=function(e){for(var o=[],s=function(s){var d=l.length>s,u=c[e][s];u&&b++;var p=function(){if(!d)return"";var n=l[s],t=e+n.adjustOctave,i=n.isFlat?v.KEY12_FLAT_LIST:v.KEY12_SHARP_LIST;return"".concat(i[n.soundIndex]).concat(t)}();o.push(Object(se.jsx)(Hh,{isEnable:d,isSelected:u,isOver:u&&b>r,onClick:function(){if(c[e][s]=!u,null!=a){var n=O.buildVoicsFromTable(c);a.channels=O.getChannels(n,a.channels.length)}t.backing.setState(Object(h.a)(Object(h.a)({},i),{},{voicingTable:c,pattern:a})),t.backing.updateErrorState()},onContextMenu:function(){var e=n.instruments.harmonyFont;null!=e&&e.play(p,0,{duration:1})},children:p},s))},u=0;u<O.STRUCT_NUM;u++)s(u);d.push(Object(se.jsx)(qh,{children:o},e))},p=0;p<O.OCTAVE_NUM;p++)u(p);var x=l.map((function(e,n){var t=e.isFlat?v.KEY12_FLAT_LIST:v.KEY12_SHARP_LIST;return Object(se.jsxs)(Uh,{isOnChord:null==e.relation,children:[null==e.relation?"On":"p1"===e.relation?"Root":e.relation," [",t[e.soundIndex],"]"]},n)}));return Object(se.jsxs)(Fh,{children:[Object(se.jsxs)(_h,{children:[Object(se.jsxs)(zh,{children:[Object(se.jsx)(Rh,{children:"Chord"}),Object(se.jsx)(Bh,{children:s.chordFullName})]}),Object(se.jsxs)(zh,{children:[Object(se.jsx)(Rh,{children:"Attr"}),Object(se.jsx)(Bh,{children:s.symbolAttr})]})]}),Object(se.jsxs)(Ph,{children:[Object(se.jsx)(Kh,{children:x}),Object(se.jsx)(Vh,{children:d})]})]})},Fh=d.b.div(Ab||(Ab=Object(s.a)(["\n    display: inline-block;\n    width: 600px;\n"]))),_h=d.b.div(Eb||(Eb=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 30px;\n    background-color: #338f8f;\n"]))),zh=d.b.div(Cb||(Cb=Object(s.a)(["\n    display: inline-block;\n    width: 50%;\n    height: 100%;\n    /* background-color: #89dada; */\n"]))),Rh=d.b.div(Tb||(Tb=Object(s.a)(["\n    display: inline-block;\n    margin-top: 4px;\n    margin-left: 5px;\n    height: calc(100% - 8px);\n    width: 80px;\n    background-color: #69bcdd;\n    font-size: 18px;\n    line-height: 18px;\n    font-weight: 600;\n    color: #026c86;\n    border: 1px solid #303030;\n    border-radius: 2px;\n    box-sizing: border-box;\n    text-align: center;\n"]))),Bh=d.b.div(Mb||(Mb=Object(s.a)(["\n    display: inline-block;\n    margin-top: 4px;\n    margin-left: 6px;\n    height: calc(100% - 8px);\n    /* background-color: #cccccc; */\n    font-size: 18px;\n    line-height: 18px;\n    font-weight: 600;\n    color: #ffffff;\n"]))),Ph=d.b.div(Db||(Db=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #c09e05;\n    border: solid 1px #888;\n    border-radius: 5px;\n    box-sizing: border-box;\n\n    & *{\n        vertical-align: top;\n        height: 100%;\n    }\n"])),142),Kh=d.b.div(Nb||(Nb=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - ","px);\n    /* width: 100px; */\n    background-color: #8fb5bc;\n"])),480),Uh=d.b.div(Fb||(Fb=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 2px);\n    height: ","px;\n    margin-top: 1px;\n    /* width: 100px; */\n    /* background-color: #8fb5bc; */\n    color: white;\n    background: linear-gradient(to bottom, #10828a, #76d5db, #10828a);\n    ","\n    font-size: 16px;\n    font-weight: 600;\n    padding-left: 5px;\n    box-sizing: border-box;\n"])),22,(function(e){return e.isOnChord?Object(d.a)(_b||(_b=Object(s.a)(["\n        /* color: #e00000; */\n        background: linear-gradient(to bottom, #104f8a, #7699db, #104f8a);\n    "]))):""})),Vh=d.b.div(zb||(zb=Object(s.a)(["\n    display: inline-block;\n    background-color: #a7acd8;\n"]))),qh=d.b.div(Rb||(Rb=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: 100%;\n    /* margin-left: 1px; */\n    background-color: #a7d8c4;\n    padding-bottom: 2px;\n    box-sizing: border-box;\n"])),60),Hh=d.b.div(Bb||(Bb=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 1px);\n    height: ","px;\n    margin: 1px 0 0 1px;\n    background-color: #409ca3;\n    border: 1px solid #215e53;\n    border-radius: 4px;\n    color: #01004e;\n    ","\n    ","\n    ","\n    /* border: 1px solid #ffffff; */\n    box-sizing: border-box;\n\n    font-size: 16px;\n    line-height: 20px;\n    font-weight: 600;\n    text-align: center;\n\n    &:hover {\n        background-color: #117dbb;\n        ","\n        ","\n    }\n"])),22,(function(e){return e.isSelected?Object(d.a)(Pb||(Pb=Object(s.a)(["\n        background-color: #e5e747;\n    "]))):""}),(function(e){return e.isOver?Object(d.a)(Kb||(Kb=Object(s.a)(["\n        background-color: #c40000;\n        color: #ffffff;\n    "]))):""}),(function(e){return e.isEnable?"":Object(d.a)(Ub||(Ub=Object(s.a)(["\n        opacity: 0.5;\n        pointer-events: none;\n    "])))}),(function(e){return e.isSelected?Object(d.a)(Vb||(Vb=Object(s.a)(["\n            background-color: #b9bb3f;\n        "]))):""}),(function(e){return e.isOver?Object(d.a)(qb||(qb=Object(s.a)(["\n            background-color: #bb3f3f;\n        "]))):""})),Jh=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=Object(o.useState)(""),a=Object(l.a)(c,2),r=a[0],s=a[1];Object(o.useEffect)((function(){console.log("backing start")}),[]);var d=function(){var e={voicingList:O.getVoicingListFromTable(i.voicingTable),pattern:null==i.pattern?null:O.buildPatternProps(i.pattern)};s(JSON.stringify(e))};return Object(se.jsxs)(Wh,{children:[Object(se.jsxs)(Yh,{children:[Object(se.jsx)(Gh,{isActive:0===i.tabIndex,onClick:function(){t.backing.setState(Object(h.a)(Object(h.a)({},i),{},{tabIndex:0}))},children:Object(se.jsx)("div",{children:"Editor"})}),Object(se.jsx)(Gh,{isActive:1===i.tabIndex,onClick:function(){d(),t.backing.setState(Object(h.a)(Object(h.a)({},i),{},{tabIndex:1}))},children:Object(se.jsx)("div",{children:"Source"})})]}),Object(se.jsx)(Qh,{children:0===i.tabIndex?Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)($h,{isUse:i.isPreview}),Object(se.jsx)(Nh,{}),Object(se.jsx)(yh,{}),Object(se.jsxs)(Xh,{children:[Object(se.jsx)(Zh,{isEnable:!i.hasError,onClick:function(){i.isPreview?O.stopPreview(n,i,t,n.reserveTasks):t.backing.testBacking()},children:i.isPreview?"Stop":"Test"}),Object(se.jsx)(Zh,{isEnable:!i.isPreview,onClick:function(){i.closeAction(i,!1)},children:"Cancel"}),Object(se.jsx)(Zh,{isEnable:!i.isPreview,onClick:function(){i.closeAction(i,!0)},children:"Update"})]})]}):Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(ep,{children:Object(se.jsx)(np,{value:r,onChange:function(e){s(e.target.value)}})}),Object(se.jsxs)(Xh,{children:[Object(se.jsx)(Zh,{isEnable:!0,onClick:function(){d()},children:"Reset"}),Object(se.jsx)(Zh,{isEnable:!0,onClick:function(){try{var e=JSON.parse(r),n=O.getInitVoicingTable(e.voicingList,i.chordInfo.structList.length),o=O.getEditorPatternFromChordBacking(n,e.pattern);t.backing.setState(Object(h.a)(Object(h.a)({},i),{},{voicingTable:n,pattern:o,tabIndex:0}))}catch(c){alert("error"),t.backing.setState(Object(h.a)(Object(h.a)({},i),{},{tabIndex:0}))}},children:"Aplly"})]})]})})]})},Wh=d.b.div(Hb||(Hb=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 630px;\n    background-color: #a1a1a1;\n"]))),Yh=d.b.div(Jb||(Jb=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 30px;\n    padding: 2px 0 0 2px;\n    box-sizing: border-box;\n    vertical-align: top;\n    /* background-color: #f17379; */\n"]))),Gh=d.b.div(Wb||(Wb=Object(s.a)(["\n    display: block;\n    width: 25px;\n    height: 100px;\n    background-color: #99afb3;\n    ","\n    border-left: 1px solid #5a5a5a;\n    border-top: 1px solid #5a5a5a;\n    border-bottom: 1px solid #5a5a5a;\n    margin: 2px 0 0 2px;\n    border-radius: 8px 0 0 8px;\n    font-size: 16px;\n    font-weight: 600;\n    color: #5a5a5a;\n    text-align: center;\n    line-height: 16px;\n    box-sizing: border-box;\n    \n    & div {\n        width: 100px;\n        transform-origin: top left;\n        transform: rotate(-90deg) translateX(-100%);\n        /* background-color: #fff; */\n    }\n\n    &:hover {\n        background-color: #b2bcbe;\n        ","\n    }\n"])),(function(e){return e.isActive?Object(d.a)(Yb||(Yb=Object(s.a)(["\n        background-color: #b8dae0;\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(Gb||(Gb=Object(s.a)(["\n            background-color: #b8dae0;\n        "]))):""})),Qh=d.b.div(Qb||(Qb=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 600px;\n    /* background-color: #bd4646; */\n"]))),Xh=d.b.div(Xb||(Xb=Object(s.a)(["\n    display: inline-block;\n    height: 30px;\n    width: 100%;\n    /* background-color: #bd4646; */\n    text-align: right;\n"]))),Zh=d.b.div(Zb||(Zb=Object(s.a)(["\n    display: inline-block;\n    width: 100px;\n    height: 26px;\n    margin: 2px 2px 0 0;\n    font-size: 20px;\n    color: white;\n    font-weight: 600;\n    background-color: #0051ff21;\n    border: solid 1px #555;\n    border-radius: 4px;\n    box-sizing: border-box;\n    line-height: 20px;\n    text-align: center;\n\n    ","\n\n    &:hover {\n        background-color: #ff008039;\n    }\n"])),(function(e){return e.isEnable?"":Object(d.a)($b||($b=Object(s.a)(["\n        opacity: 0.5;\n        pointer-events: none;\n    "])))})),$h=d.b.div(eu||(eu=Object(s.a)(["\n    position: absolute;\n    display: ",";\n    z-index: 80;\n    width: 100%;\n    height: calc(100% - 30px);\n    background-color: #7a270028;\n"])),(function(e){return e.isUse?"block":"none"})),ep=d.b.div(nu||(nu=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 600px;\n    height: 400px;\n    background-color: #b4aeae;\n"]))),np=d.b.textarea(tu||(tu=Object(s.a)(["\n    display: inline-block;\n    font-size: ","px;\n    color: #0a0038;\n    background-color: #b7bcd3;\n    resize: none;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    box-sizing: border-box;\n    margin: 4px 0 0 4px;\n    outline: none;\n"])),Be.FONT_SMALL);(ku||(ku={})).Component=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.backingState,c=Object(o.useState)({listIndex:0}),a=Object(l.a)(c,2),r=a[0],s=a[1],d=n.scoreData.chordList,b=n.scoreState,u=b.focusIndex<b.distIndex?[b.focusIndex,b.distIndex]:[b.distIndex,b.focusIndex],p=Object(l.a)(u,2),x=p[0],f=p[1],g=n.systemState,j=g.themaList[g.activeThemaIndex];Object(o.useEffect)((function(){return console.log("preset start"),function(){console.log("preset end"),t.system.setState(Object(h.a)(Object(h.a)({},n.systemState),{},{cache:null}))}}),[]),Object(o.useEffect)((function(){var e={field:r,presetList:w,applyAction:T,invalidate:m};t.system.setState(Object(h.a)(Object(h.a)({},n.systemState),{},{cache:e}))}),[]);var m=function(){s(Object(h.a)({},r))},k=Object(o.useMemo)((function(){var e=[],n=[];return d.forEach((function(t,i){if(i>=x&&i<=f&&"chord"===t.type){var o=t.detail;if(null==o.root)return 1;var c=b.elementCacheList[i],a=(o.root.index+c.keyIndex)%12,r={beatLen:o.beatLen,head:o.minute.head,tail:o.minute.tail,rootIndex:a,symbolKey:o.symbolKey};void 0==n.find((function(e){return e.beatLen===r.beatLen&&e.head===r.head&&e.tail===r.tail&&e.rootIndex===r.rootIndex&&e.symbolKey===r.symbolKey}))&&n.push(r),e.push({index:i,condition:r})}})),[e,Pn.getPresetList(j,n)]}),[]),y=Object(l.a)(k,2),S=y[0],w=y[1],L=Object(o.useMemo)((function(){if(0===w.length)return[[],[],0];var e=w[r.listIndex];return[w.map((function(e,n){return Object(se.jsxs)(yp,{isFocus:r.listIndex===n,onClick:function(){r.listIndex=n,m()},children:[Object(se.jsx)(wp,{children:e.dispName})," ",Object(se.jsxs)(Sp,{children:["[",e.method,"]"]})]},n)})),e.applyList.map((function(e,o){var c,a=e.condition,s="[".concat(a.beatLen,"* ").concat(a.tail,",").concat(a.tail,"]"),l=v.KEY12_SHARP_LIST[a.rootIndex]+(null===(c=v.getSymbolFromKey(a.symbolKey))||void 0===c?void 0:c.name),d=null!=e.backing;return Object(se.jsxs)(Lp,{isMatch:d,onClick:function(){d&&function(e){if(console.log(i.isPreview),i.isPreview)O.stopPreview(n,i,t,n.reserveTasks);else{var o=w[r.listIndex].applyList[e],c=o.backing,a=v.getSymbolFromKey(o.condition.symbolKey);i.chordInfo=Object(h.a)(Object(h.a)({},i.chordInfo),{},{beatLen:o.condition.beatLen,minute:{head:o.condition.head,tail:o.condition.tail}});var s=O.getInitVoicingTable(c.voicingList,a.structs.length),l=O.getEditorPatternFromChordBacking(s,c.pattern);t.backing.setState(Object(h.a)(Object(h.a)({},i),{},{voicingTable:s,pattern:l})),t.backing.testBacking()}}(o)},children:[Object(se.jsx)(Ip,{isMatch:d,children:d?"OK":"NG"})," ",s," ",l]},o)})),e.applyList.filter((function(e){return null!=e.backing})).length/e.applyList.length]}),[r.listIndex]),I=Object(l.a)(L,3),A=I[0],E=I[1],C=I[2],T=Object(o.useCallback)((function(){var e=w[r.listIndex].applyList;S.forEach((function(n){var t=d[n.index].detail,i=e.find((function(e){return Pn.matchCondition(e.condition,n.condition)}));void 0!=i&&null!=i.backing&&(t.backing=i.backing)})),t.score.closeLibraryWnd()}),[r.listIndex]);return Object(se.jsxs)(gp,{children:[Object(se.jsx)(jp,{children:0===w.length?Object(se.jsx)(Tp,{children:"Preset does not exist..."}):Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(mp,{children:[Object(se.jsx)(Op,{children:"Preset"}),A]}),Object(se.jsxs)(mp,{children:[Object(se.jsx)(Op,{children:"Apply"}),Object(se.jsxs)(Ap,{children:["Matching Rate: ",Object(se.jsxs)(Ep,{children:[(100*C).toFixed(1),"%"]})]}),E]})]})}),Object(se.jsxs)(vp,{children:[Object(se.jsx)(Cp,{isEnable:!0,onClick:function(){t.score.closeLibraryWnd()},children:"Cancel"}),Object(se.jsx)(Cp,{isEnable:w.length>0,onClick:T,children:"Apply"})]})]})};var tp,ip,op,cp,ap,rp,sp,lp,dp,bp,up,hp,pp,xp,fp=ku,gp=d.b.div(iu||(iu=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 630px;\n    height: 400px;\n    background-color: #d4d5ca;\n    border: 1px solid #121212;\n    box-sizing: border-box;\n"]))),jp=d.b.div(ou||(ou=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: calc(100% - ","px);\n    /* background-color: #4d5e53; */\n"])),30),vp=d.b.div(cu||(cu=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: ","px;\n    background-color: #c7c7c7;\n    text-align: right;\n"])),30),mp=d.b.div(au||(au=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 50%;\n    height: 100%;\n    /* background-color: #4d5e53; */\n    /* border: 1px solid #121212; */\n    box-sizing: border-box;\n"]))),Op=d.b.div(ru||(ru=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    ","\n    background-color: #3c4a99c3;\n    box-sizing: border-box;\n    border: 1px solid #f0f0f0;\n    color: #ffffff;\n    text-align: center;\n"])),Be.CSS_LABEL_SMALL),kp=d.b.div(su||(su=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    ","\n    background-color: #d1dad4c8;\n    box-sizing: border-box;\n    border: 1px solid #676767;\n    color: #000786;\n    text-align: left;\n    padding-left: 4px;\n"])),Be.CSS_LABEL_SMALL),yp=Object(d.b)(kp)(lu||(lu=Object(s.a)(["\n    ","\n"])),(function(e){return e.isFocus?Object(d.a)(du||(du=Object(s.a)(["\n        background-color: #e6dd5bc5;\n    "]))):""})),Sp=d.b.span(bu||(bu=Object(s.a)(["\n    color: #00054b86;\n"]))),wp=d.b.span(uu||(uu=Object(s.a)(["\n    color: #b90000;\n"]))),Lp=Object(d.b)(kp)(hu||(hu=Object(s.a)(["\n    background-color: #79b98f;\n    ","\n\n    \n"])),(function(e){return e.isMatch?Object(d.a)(pu||(pu=Object(s.a)(["\n        background-color: #7eda5a;\n        &:hover {\n            background-color: #abeb92da;\n        }\n    "]))):""})),Ip=d.b.span(xu||(xu=Object(s.a)(["\n    ","\n"])),(function(e){return e.isMatch?Object(d.a)(fu||(fu=Object(s.a)(["\n        color: #e61426;\n    "]))):""})),Ap=d.b.div(gu||(gu=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    ","\n    width: 100%;\n    /* height: 32px; */\n    background-color: #eaecca;\n    box-sizing: border-box;\n    border: 1px solid #676767;\n    color: #6e6f91;\n    text-align: left;\n    padding-left: 4px;\n"])),Be.CSS_LABEL_SMALL),Ep=d.b.span(ju||(ju=Object(s.a)(["\n    color: #be003f;\n"]))),Cp=d.b.div(vu||(vu=Object(s.a)(["\n    display: inline-block;\n    width: 100px;\n    height: 26px;\n    margin: 2px 2px 0 0;\n    font-size: 20px;\n    color: white;\n    font-weight: 600;\n    background-color: #0051ff21;\n    border: solid 1px #555;\n    border-radius: 4px;\n    box-sizing: border-box;\n    line-height: 20px;\n    text-align: center;\n\n    ","\n\n    &:hover {\n        background-color: #ff008039;\n    }\n"])),(function(e){return e.isEnable?"":Object(d.a)(mu||(mu=Object(s.a)(["\n        opacity: 0.5;\n        pointer-events: none;\n    "])))})),Tp=d.b.div(Ou||(Ou=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    ","\n    /* background-color: #d1dad4c8; */\n    color: #a10000;\n    text-align: left;\n    padding-left: 4px;\n"])),Be.CSS_LABEL_MIDIUM);(xp||(xp={})).Component=function(){var e,n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=Object(o.useState)({focusSide:0,pattIndex:0,voicIndex:0}),a=Object(l.a)(c,2),r=a[0],s=a[1],d=function(){s(Object(h.a)({},r))},b=t.scoreData.chordList,u=t.systemState,p=b[t.scoreState.focusIndex].detail,x=t.scoreState,f=x.elementCacheList[x.focusIndex],g=x.chordCacheList[f.chordBlockNo].structList,j=((null===(e=p.root)||void 0===e?void 0:e.index)+f.keyIndex)%12,m=t.backingState,k=u.themaList[u.activeThemaIndex];Object(o.useEffect)((function(){return console.log("thema start"),console.log(k),function(){console.log("thema end"),i.system.setState(Object(h.a)(Object(h.a)({},t.systemState),{},{cache:null}))}}),[]),Object(o.useEffect)((function(){var e={patternList:A,voicingList:E,field:r,invalidate:d,testBacking:S,isPermitTest:w,isPreview:!1};i.system.setState(Object(h.a)(Object(h.a)({},t.systemState),{},{cache:e}))}),[]),Object(o.useEffect)((function(){y();var e=t.systemState.cache;null!=e&&(e.testBacking=S,e.isPermitTest=w,e.isPreview=m.isPreview)}),[r,m.isPreview]);var y=function(){if(w()){var e=A[r.pattIndex].source,n=E.filter((function(e){return Pn.acceptVoic(e,A,r.pattIndex)}))[r.voicIndex].source,t=O.getInitVoicingTable(n,g.length),o=O.getEditorPatternFromChordBacking(t,e);i.backing.setState(Object(h.a)(Object(h.a)({},m),{},{voicingTable:t,pattern:o}))}else i.backing.setState(Object(h.a)(Object(h.a)({},m),{},{voicingTable:[],pattern:null}))},S=Object(o.useCallback)((function(){console.log("test"),m.isPreview?O.stopPreview(t,m,i,t.reserveTasks):i.backing.testBacking()}),[t]),w=function(){return r.voicIndex>0},L=Object(o.useMemo)((function(){var e=[],n=[];n.push({pattIdx:-1,dispName:"none",source:[]});var t={symbolKey:p.symbolKey,rootIndex:j,beatLen:p.beatLen,head:p.minute.head,tail:p.minute.tail},i=k.meths[0];Pn.searchSustMeth(i,t,null,(function(t){var i=t.source.map((function(e){return"[".concat(e.octave,"-").concat(e.struct,"]")})).join(",");n.push({pattIdx:e.length,dispName:i,source:t.source})})),e.push({dispName:"none",source:null,key:-1,refer:-1});var o=k.meths[1];return Pn.searchPattMeth(o,t,null,(function(n){e.push({dispName:n.pattName,source:n.source,key:n.key,refer:n.refer})}),(function(t){var i=t.source.map((function(e){var n=g[e.struct];return v.KEY12_SHARP_LIST[n.soundIndex]+(e.octave+n.adjustOctave)}));n.push({pattIdx:e.length,dispName:i.join("-"),source:t.source})}),(function(){})),[e,n]}),[]),I=Object(l.a)(L,2),A=I[0],E=I[1],C=Object(o.useMemo)((function(){return[A.map((function(e,n){return Object(se.jsx)(Lx,{isFocus:r.pattIndex===n,isNone:0===n,onClick:function(){r.focusSide=0,r.pattIndex=n,r.pattIndex!==n&&(r.voicIndex=0),d(),y()},children:e.dispName},n)})),E.filter((function(e){return Pn.acceptVoic(e,A,r.pattIndex)})).map((function(e,n){var t=e.source.map((function(n,t){var i=g[n.struct],o=v.KEY12_SHARP_LIST[i.soundIndex]+(n.octave+i.adjustOctave);return Object(se.jsxs)("span",{children:[Object(se.jsx)(Ix,{interval:Pn.getDistinctionFromRelate(i),children:o}),t<e.source.length-1?"-":""]},t)})),i=0===n?Object(se.jsx)(se.Fragment,{children:"none"}):Object(se.jsx)(se.Fragment,{children:t});return Object(se.jsx)(Lx,{isFocus:r.voicIndex===n,isNone:0===n,onClick:function(){r.focusSide=1,r.voicIndex=n,d(),y()},children:i},n)}))]}),[r.pattIndex,r.voicIndex]),T=Object(l.a)(C,2),M=T[0],D=T[1];return Object(se.jsxs)(Ox,{children:[Object(se.jsx)(Ex,{isUse:m.isPreview}),Object(se.jsxs)(kx,{children:[Object(se.jsxs)(Sx,{isFocus:0===r.focusSide,children:[Object(se.jsx)(wx,{children:"Pattern"}),M]}),Object(se.jsxs)(Sx,{isFocus:1===r.focusSide,children:[Object(se.jsx)(wx,{children:"Voicing"}),D]})]}),Object(se.jsxs)(yx,{children:[Object(se.jsx)(Ax,{isEnable:w(),onClick:S,children:(null===m||void 0===m?void 0:m.isPreview)?"Stop":"Test"}),Object(se.jsx)(Ax,{isEnable:!m.isPreview,onClick:function(){i.score.closeLibraryWnd()},children:"Cancel"}),Object(se.jsx)(Ax,{isEnable:!m.isPreview,onClick:function(){var e=A[r.pattIndex],n=E.filter((function(e){return Pn.acceptVoic(e,A,r.pattIndex)}))[r.voicIndex];i.thema.mappingSelectorToScore(n.source,e.source),i.score.closeLibraryWnd()},children:"Apply"})]})]})};var Mp,Dp,Np,Fp,_p,zp,Rp,Bp,Pp,Kp,Up,Vp,qp,Hp,Jp,Wp,Yp,Gp,Qp,Xp,Zp,$p,ex,nx,tx,ix,ox,cx,ax,rx,sx,lx,dx,bx,ux,hx,px,xx,fx,gx,jx,vx,mx=xp,Ox=d.b.div(tp||(tp=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 630px;\n    height: 400px;\n    background-color: #d4d5ca;\n    border: 1px solid #121212;\n    box-sizing: border-box;\n"]))),kx=d.b.div(ip||(ip=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: calc(100% - ","px);\n    /* background-color: #4d5e53; */\n"])),30),yx=d.b.div(op||(op=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: ","px;\n    background-color: #c7c7c7;\n    text-align: right;\n"])),30),Sx=d.b.div(cp||(cp=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 50%;\n    height: 100%;\n    /* background-color: #4d5e53; */\n    /* border: 1px solid #121212; */\n    ","\n    box-sizing: border-box;\n"])),(function(e){return e.isFocus?Object(d.a)(ap||(ap=Object(s.a)(["\n        background-color: #ffffff45;\n        /* border: 1px solid #eb0000; */\n    "]))):""})),wx=d.b.div(rp||(rp=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    ","\n    background-color: #3c4a99c3;\n    box-sizing: border-box;\n    border: 1px solid #f0f0f0;\n    color: #ffffff;\n    text-align: center;\n"])),Be.CSS_LABEL_SMALL),Lx=d.b.div(sp||(sp=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    ","\n    background-color: #d1dad4c8;\n    ","\n    box-sizing: border-box;\n    border: 1px solid #676767;\n    color: #000786;\n    ","\n    text-align: left;\n    padding-left: 4px;\n"])),Be.CSS_LABEL_SMALL,(function(e){return e.isFocus?Object(d.a)(lp||(lp=Object(s.a)(["\n        background-color: #e6dd5bc5;\n    "]))):""}),(function(e){return e.isNone?Object(d.a)(dp||(dp=Object(s.a)(["\n        color: #850000;\n    "]))):""})),Ix=d.b.span(bp||(bp=Object(s.a)(["\n    color: ",";\n"])),(function(e){switch(e.interval){case 1:return"#960000";case 3:return"#000877";case 5:return"#007a06";case 7:return"#742e00";case 9:return"#005e5e"}})),Ax=d.b.div(up||(up=Object(s.a)(["\n    display: inline-block;\n    width: 100px;\n    height: 26px;\n    margin: 2px 2px 0 0;\n    font-size: 20px;\n    color: white;\n    font-weight: 600;\n    background-color: #0051ff21;\n    border: solid 1px #555;\n    border-radius: 4px;\n    box-sizing: border-box;\n    line-height: 20px;\n    text-align: center;\n\n    ","\n\n    &:hover {\n        background-color: #ff008039;\n    }\n"])),(function(e){return e.isEnable?"":Object(d.a)(hp||(hp=Object(s.a)(["\n        opacity: 0.5;\n        pointer-events: none;\n    "])))})),Ex=d.b.div(pp||(pp=Object(s.a)(["\n    position: absolute;\n    display: ",";\n    z-index: 80;\n    width: 100%;\n    height: calc(100% - 30px);\n    background-color: #7a270028;\n"])),(function(e){return e.isUse?"block":"none"})),Cx=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.scoreState,c="none"!==i.hideMenu,a=Pn.getEnableState(n);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Tx,{isOpen:c,onClick:function(){t.backing.closeBackingEditor()}}),Object(se.jsxs)(Mx,{children:[Object(se.jsx)(Dx,{isOpen:c,children:function(){switch(i.hideMenu){case"none":return Object(se.jsx)(se.Fragment,{});case"backing":return Object(se.jsx)(Jh,{});case"library":return Object(se.jsx)(mx.Component,{});case"preset":return Object(se.jsx)(fp.Component,{})}}()}),Object(se.jsxs)(Nx,{children:[Object(se.jsx)(Fx,{isEnable:a.isChordElement,isVisible:["backing","none"].includes(i.hideMenu),onClick:function(){"none"===i.hideMenu?t.backing.openBackingEditor():t.backing.closeBackingEditor()},children:Object(se.jsx)("div",{children:"Backing"})}),Object(se.jsx)(Fx,{isEnable:a.isUseLib&&a.isChordElement&&!a.isRangeSelect,isVisible:["library","none"].includes(i.hideMenu),onClick:function(){"none"===i.hideMenu?t.score.openLibraryWnd(!1):t.score.closeLibraryWnd()},children:Object(se.jsx)("div",{children:"Library"})}),Object(se.jsx)(Fx,{isEnable:a.isRangeSelect&&a.isUseLib,isVisible:["preset","none"].includes(i.hideMenu),onClick:function(){"none"===i.hideMenu?t.score.openLibraryWnd(!0):t.score.closeLibraryWnd()},children:Object(se.jsx)("div",{children:"Preset"})})]})]})]})},Tx=d.b.div(Mp||(Mp=Object(s.a)(["\n    display: ",";\n    position: absolute;\n    z-index: 7;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: #01004216;\n    backdrop-filter: blur(6px);\n"])),(function(e){return e.isOpen?"inline-block":"none"})),Mx=d.b.div(Dp||(Dp=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 8;\n    left: 0;\n    top: 0;\n    /* width: 525px; */\n\n    & * {\n        vertical-align: top;\n    }\n"]))),Dx=d.b.div(Np||(Np=Object(s.a)(["\n    display: inline-block;\n    width: ",";\n    /* height: 400px; */\n    background-color: #a3a3a3;\n    opacity: 0.9;\n    transition: width 0.1s;\n    overflow: hidden;\n"])),(function(e){return e.isOpen?"630px":0})),Nx=d.b.div(Fp||(Fp=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n"]))),Fx=d.b.div(_p||(_p=Object(s.a)(["\n    display: block;\n    width: 25px;\n    height: 110px;\n    margin-top: 4px;\n    background-color: #e4e4e4;\n    border-top: 1px solid #5a5a5a;\n    border-right: 1px solid #5a5a5a;\n    border-bottom: 1px solid #5a5a5a;\n    border-radius: 0 10px 10px 0;\n    font-size: 16px;\n    font-weight: 600;\n    color: #5a5a5a;\n    text-align: center;\n    line-height: 16px;\n    box-sizing: border-box;\n    ","\n    ","\n    \n    & div {\n        width: 110px;\n        transform-origin: top left;\n        transform: rotate(-90deg) translateX(-100%);\n        /* background-color: #fff; */\n    }\n\n    &:hover {\n        background-color: #d1e5eb;\n    }\n"])),(function(e){return e.isEnable?"":Object(d.a)(zp||(zp=Object(s.a)(["\n        opacity: 0.5;\n        pointer-events: none;\n    "])))}),(function(e){return e.isVisible?"":Object(d.a)(Rp||(Rp=Object(s.a)(["\n        opacity: 0;\n    "])))})),_x=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,n.scoreState);return Object(se.jsxs)(zx,{children:[Object(se.jsx)(Rx,{children:"clipboard"}),Object(se.jsxs)(Bx,{children:[Object(se.jsx)(Px,{isActive:null!=t.cloneBacking,children:"Backing"}),Object(se.jsx)(Px,{isActive:null!=t.copiedElementList,children:"Elements"})]})]})},zx=d.b.div(Bp||(Bp=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    margin-left: 20px;\n    /* background-color: red; */\n    & *{\n        vertical-align: top;\n    }\n"]))),Rx=d.b.div(Pp||(Pp=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    font-size: 18px;\n    font-weight: 600;\n    color: #979797;\n    margin-left: 4px;\n    font-style: italic;\n    line-height: 38px;\n    /* background-color: yellow; */\n"]))),Bx=d.b.div(Kp||(Kp=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    margin-left: 10px;\n    /* background-color: yellow; */\n"]))),Px=d.b.div(Up||(Up=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    width: 120px;\n    height: calc(100% - 8px);\n    /* background-color: #e0ff6f55; */\n    ","\n    margin: 4px 0 0 4px;\n\n    font-size: 18px;\n    font-weight: 600;\n    color: #8f8f8f;\n    border-radius: 2px;\n    border: 1px solid #969696;\n    box-sizing: border-box;\n    text-align: center;\n"])),(function(e){return e.isActive?Object(d.a)(Vp||(Vp=Object(s.a)(["\n        background-color: #a8dbb3;\n    "]))):""})),Kx=12,Ux=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,n.scoreState),i=n.scoreData.chordList,c=t.focusIndex,a=t.elementCacheList,r=Object(o.useMemo)((function(){var e=[];return e.push(Object(se.jsx)(Xx,{},e.length)),t.measureCacheList.forEach((function(n){var t={width:1,height:10,color:"#555"};switch(!0){case 4===n.rate:t={width:2,height:22,color:"#747474"};break;case 8===n.rate:t={width:1,height:18,color:"#646464"};break;case 16===n.rate:t={width:1,height:10,color:"#7a7a7a"}}e.push(Object(se.jsx)(Zx,{width:t.width,height:t.height,color:t.color,children:-1!==n.barCount?Object(se.jsx)($x,{children:n.barCount}):""},e.length))})),e.push(Object(se.jsx)(Xx,{},e.length)),e}),[t.beatCacheList]),s=Object(o.useMemo)((function(){var e=[],n=[],o="chord"===i[c].type,r=a[c].chordIndex;return i.forEach((function(i,c){var a=t.elementCacheList[c];if("chord"===i.type&&Math.abs(a.chordIndex-r)<=5){var s=i.detail,l=(s.beatLen,s.minute.head,s.minute.tail,""),d="ather";o?a.chordIndex===r?(l="cur",d="cur"):a.chordIndex===r-1?(l="prev",d="prev"):a.chordIndex===r+1&&(l="next",d="next"):a.chordIndex===r?(l="prev",d="prev"):a.chordIndex===r+1&&(l="next",d="next");var b=v.getBeatProps(a.beatSignature),u=s.minute.head+s.minute.tail,h=s.beatLen*b.beatMemoriCount,p=16+a.curTotalMemori;e.push(Object(se.jsx)(Yx,{type:d,pos:p,sustain:h+u,children:l},e.length)),n.push(Object(se.jsx)(Gx,{isActive:"cur"===d,pos:p+s.minute.head,sustain:h},e.length))}})),[e,n]}),[i.length,c,t.beatCacheList]),d=Object(l.a)(s,2),b=d[0],u=d[1],h=a[c].curTotalMemori*Kx;return Object(se.jsx)(Vx,{children:Object(se.jsxs)(qx,{pos:h,children:[Object(se.jsxs)(Hx,{children:[Object(se.jsx)(Jx,{children:b}),Object(se.jsx)(Wx,{children:u})]}),Object(se.jsx)(Qx,{children:r})]})})},Vx=d.b.div(qp||(qp=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    overflow: hidden;\n    height: 100%;\n    width: 100%;\n    text-align: left;\n    white-space: nowrap;  \n"]))),qx=d.b.div(Hp||(Hp=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: ","px;\n    position: absolute;\n    height: 100%;\n    /* width: 100px;\n    background-color: #000; */\n    transition: left 0.5s;\n"])),(function(e){return-e.pos})),Hx=d.b.div(Jp||(Jp=Object(s.a)(["\n    display: block;\n    /* position: relative; */\n    height: 40px;\n    /* width: 2200px; */\n    background-color: rgb(131, 131, 131);\n"]))),Jx=d.b.div(Wp||(Wp=Object(s.a)(["\n    display: block;\n    position: relative;\n    height: 30px;\n"]))),Wx=d.b.div(Yp||(Yp=Object(s.a)(["\n    display: block;\n    position: relative;\n    height: 10px;\n"]))),Yx=d.b.div(Gp||(Gp=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: ","px;\n    width: ","px;\n    height: 100%;\n\n    font-size: 16px;\n    font-weight: 600;\n    color: white;\n    text-align: center;\n    background-color: rgb(136, 163, 133);\n    ","\n    border-left: solid 1px #000;\n    border-top: solid 1px #000;\n    border-bottom: solid 1px #000;\n    box-sizing: border-box;\n"])),(function(e){return e.pos*Kx}),(function(e){return e.sustain*Kx}),(function(e){switch(e.type){case"cur":return Object(d.a)(Qp||(Qp=Object(s.a)(["\n                background-color: rgb(218, 107, 134);\n                /* color: #ffe551; */\n            "])));case"prev":return Object(d.a)(Xp||(Xp=Object(s.a)(["\n                opacity: 0.4;\n                background-color: rgb(163, 177, 221);\n            "])));case"next":return Object(d.a)(Zp||(Zp=Object(s.a)(["\n                opacity: 0.4;\n                background-color: rgb(163, 221, 171);\n            "])));case"ather":return Object(d.a)($p||($p=Object(s.a)(["\n                background-color: rgb(192, 192, 192);\n            "])))}})),Gx=d.b.div(ex||(ex=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: ","px;\n    width: ","px;\n    height: 100%;\n\n    font-size: 16px;\n    font-weight: 600;\n    color: white;\n    text-align: center;\n    background-color: rgb(224, 224, 224);\n    border-left: solid 1px #000;\n    ","\n"])),(function(e){return e.pos*Kx}),(function(e){return e.sustain*Kx}),(function(e){return e.isActive?Object(d.a)(nx||(nx=Object(s.a)(["\n        /* background-color: rgb(233, 180, 228); */\n        /* color: #ffe551; */\n    "]))):""})),Qx=d.b.div(tx||(tx=Object(s.a)(["\n    display: block;\n    position: relative;\n    height: 38px;\n    background-color: rgb(48, 48, 48);\n    border-top: solid 2px rgb(128, 128, 128);\n    background: linear-gradient(to bottom, rgb(255, 255, 255), rgb(98, 97, 114));\n"]))),Xx=d.b.div(ix||(ix=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: 100%;\n    background-color: #d9ebe7;\n    box-sizing: border-box;\n"])),192),Zx=d.b.div(ox||(ox=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: ","px;\n    height: ","px;\n    border-left: solid ","px ",";\n    box-sizing: border-box;\n"])),Kx,(function(e){return e.height}),(function(e){return e.width}),(function(e){return e.color})),$x=d.b.div(cx||(cx=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 10;\n    left: -5px;\n    top: 18px;\n    font-size: 16px;\n    font-weight: 600;\n    color: #dd0000;\n"]))),ef=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.systemState,c=n.systemState.themaList;return Object(se.jsxs)(nf,{children:[Object(se.jsx)(tf,{children:"backing-library"}),Object(se.jsx)(of,{value:i.activeThemaIndex,onChange:function(e){i.activeThemaIndex=Number(e.target.value),t.system.setState(i)},children:[Object(se.jsx)("option",{value:-1,children:""},-1)].concat(c.map((function(e,n){var t=e.themaName;return Object(se.jsx)("option",{value:n,children:t},n)})))})]})},nf=d.b.div(ax||(ax=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    margin-left: 20px;\n    /* background-color: red; */\n    & *{\n        vertical-align: top;\n    }\n"]))),tf=d.b.div(rx||(rx=Object(s.a)(["\n    display: inline-block;\n    height: 100%;\n    font-size: 18px;\n    font-weight: 600;\n    color: #979797;\n    margin-left: 4px;\n    font-style: italic;\n    line-height: 38px;\n    /* vertical-align: top; */\n    /* background-color: yellow; */\n"]))),of=d.b.select(sx||(sx=Object(s.a)(["\n    display: inline-block;\n    width: 320px;\n    height: calc(100% - 8px);\n    margin: 4px 0 0 8px;\n    font-size: 18px;\n    /* line-height: 32px; */\n    color: #1100d0;\n    border: solid 1px #000;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n"]))),cf=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=Object(o.useRef)({}),a=Object(o.useState)({}),r=Object(l.a)(a,2),s=(r[0],r[1],t.scoreState),d=t.scoreState.isMelody;Object(o.useEffect)((function(){i.system.setInvalidate(Object(h.a)(Object(h.a)({},t.invalidate),{},{harmonize:function(){i.system.setInvalidate(Object(h.a)(Object(h.a)({},t.invalidate),{},{harmoniizeInvalidate:{}}))}}))}),[]),Object(o.useEffect)((function(){d||c.current.focus()}),[d]);var b=s.elementCacheList[s.focusIndex],u=t.scoreData.chordList[s.focusIndex],p=0===s.elementCacheList.length?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(Ux,{}),x=Object(se.jsx)(se.Fragment,{});if(s.elementCacheList.length>0){var f=s.chordCacheList[b.chordBlockNo],g="chord"===u.type?f.structList:[];x=Object(se.jsx)(Su,{cache:b,structList:g})}var j=!s.isPreview&&"none"===s.hideMenu;return Object(se.jsxs)(af,{tabIndex:999,ref:c,isActive:e.isActive,onKeyDown:function(e){return is(e,t,i,!0)},onKeyUp:function(e){return is(e,t,i,!1)},children:[Object(se.jsx)(rf,{isEnable:j,children:Object(se.jsx)(Er,{})}),Object(se.jsxs)(sf,{children:[Object(se.jsxs)(df,{isEnable:!s.isPreview,children:[Object(se.jsx)(_x,{}),Object(se.jsx)(ef,{})]}),Object(se.jsxs)(bf,{children:[Object(se.jsx)(Cx,{}),Object(se.jsx)(uf,{children:Object(se.jsx)(Ir,{})}),Object(se.jsx)(ff,{isUse:s.isPreview})]}),Object(se.jsxs)(hf,{children:[Object(se.jsx)(pf,{children:p}),Object(se.jsx)(xf,{children:x})]})]}),Object(se.jsx)(lf,{isEnable:j,children:Object(se.jsx)(Ql,{})})]})},af=d.b.div(lx||(lx=Object(s.a)(["\n    display: ",";\n    width: 100%;\n    height: 100%;\n    outline: none;\n"])),(function(e){return e.isActive?"inline-block":"none"})),rf=d.b.div(dx||(dx=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: 100%;\n    background-color: #d8d8d8;\n    border-right: 1px solid #3e3f57;\n    box-sizing: border-box;\n    vertical-align: top;\n    ","\n"])),110,(function(e){return e.isEnable?"":Ue})),sf=d.b.div(bx||(bx=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - ","px);\n    height: 100%;\n    background-color: #c7c7c7;\n    vertical-align: top;\n"])),330),lf=d.b.div(ux||(ux=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: 100%;\n    background-color: #d6d6d6;\n    vertical-align: top;\n    ","\n"])),220,(function(e){return e.isEnable?"":Ue})),df=d.b.div(hx||(hx=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #d4d4d4;\n    ","\n"])),35,(function(e){return e.isEnable?"":Ue})),bf=d.b.div(px||(px=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: calc(100% - ","px);\n    background-color: #e0e0e0;\n    overflow: auto;\n    \n    &::-webkit-scrollbar {\n        width: 10px;\n        height: 10px;\n    }\n    &::-webkit-scrollbar-thumb {\n        border-radius: 5px;\n        background: #1959A8;\n    }\n    &::-webkit-scrollbar-track {\n        border-radius: 5px;\n        box-shadow: 0 0 4px #aaa inset;\n    }\n"])),115),uf=d.b.div(xx||(xx=Object(s.a)(["\n    position: absolute;\n    margin-left: 25px;\n    width: calc(100% - 25px);\n    min-height: 100%;\n    vertical-align: top;\n    /* overflow: auto; */\n"]))),hf=d.b.div(fx||(fx=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #cacaca;\n    & * {\n        vertical-align: top;\n    }\n"])),80),pf=d.b.div(gx||(gx=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - ","px);\n    height: 100%;\n    /* background-color: #ddc2c2; */\n"])),380),xf=d.b.div(jx||(jx=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: 100%;\n    background-color: #757575;\n"])),380),ff=d.b.div(vx||(vx=Object(s.a)(["\n    position: absolute;\n    display: ",";\n    z-index: 80;\n    width: 100%;\n    height: 100%;\n    background-color: #7a270028;\n"])),(function(e){return e.isUse?"block":"none"})),gf=t(34),jf=t.n(gf),vf=function e(){Object(x.a)(this,e)};vf.mouseDownEvent=function(e,n,t,i,o){if(0===e.button){var c=n.refs.melody;if(null!=c.table&&null!=c.measure&&null!=c.chord&&null!=c.pitch){var a=c.measure.getBoundingClientRect(),r=e.clientX-a.left;n.melodyState.timelineMouse.lock=r,o()}}},vf.mouseMoveEvent=function(e,n,t,i,o){var c=n.refs.melody;if(null!=c.table&&null!=c.measure&&null!=c.chord&&null!=c.pitch){var a=c.measure.getBoundingClientRect(),r=e.clientX-a.left,s=n.melodyState.timelineMouse;s.pos!==r&&(s.pos=r,o())}},vf.mouseUpEvent=function(e,n,t,i,o){if(0===e.button){var c=n.refs.melody;if(null!=c.table&&null!=c.measure&&null!=c.chord&&null!=c.pitch){for(var a=c.measure.getBoundingClientRect(),r=(e.clientX,a.left,n.melodyState),s=r.timelineMouse,d=s.lock+c.measure.scrollLeft,b=s.pos+c.measure.scrollLeft,u=n.scoreData.notesList,h=-1,p=-1,x=0;x<u.length;x++){var f=u[x],g=w(f.pos)*r.beatWidth,j=g+w(f.len)*r.beatWidth,v=d<b?[d,b]:[b,d],m=Object(l.a)(v,2),O=m[0],k=m[1];if(O<=g&&k>=j)-1===h&&(h=x);else if(-1!==h){p=x-1;break}}-1!==h&&-1===p&&(p=u.length-1),r.focusIndex=h,r.destIndex=p,s.lock=-1,t.melody.setState(r)}}};var mf,Of,kf,yf,Sf,wf,Lf,If,Af,Ef,Cf,Tf,Mf,Df,Nf,Ff,_f,zf,Rf,Bf,Pf,Kf,Uf,Vf,qf,Hf,Jf,Wf,Yf,Gf,Qf,Xf,Zf=vf,$f=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=Object(o.useRef)(null),a=Object(o.useRef)(null),r=t.scoreState,s=e.update,l=t.scoreData.chordList,d=e.barLength,b=e.beatWidth,u=e.curChord,h=e.timelineLength,p=e.mouseMeasurePos,x=1/t.melodyState.quantize,f=t.scoreData.chordList[0].detail;Object(o.useEffect)((function(){t.refs.melody.measure=c.current,t.refs.melody.chord=a.current}),[]);var g=Object(o.useMemo)((function(){var e=[];return r.measureCacheList.forEach((function(n){var t={width:1,height:10,color:"#555"};switch(!0){case 4===n.rate:t={width:2,height:22,color:"#747474"};break;case 8===n.rate:t={width:1,height:18,color:"#646464"};break;case 16===n.rate:t={width:1,height:10,color:"#7a7a7a"}}var i=n.barCount;e.push(Object(se.jsx)(sg,{beatWidth:b,width:t.width,height:t.height,color:t.color,children:-1!==i?Object(se.jsx)(lg,{children:i}):""},e.length))})),e}),[r.beatCacheList,d]),j=Object(o.useMemo)((function(){var e=[];if(0===r.elementCacheList.length)return e;var n=0;return l.forEach((function(o,c){if("chord"===o.type){var s=o.detail,l=r.elementCacheList[c],d=.25*(s.minute.head+s.minute.tail),h=v.getBeatProps(l.beatSignature).beatMemoriCount/4,p=b*(s.beatLen*h+d);if(null!=a.current){var x=a.current.scrollLeft;if(n+p-x>=0||n-x<=a.current.clientWidth){var g,j=null===(g=v.getSymbolFromKey(s.symbolKey))||void 0===g?void 0:g.name,m=null==s.root?"-":v.getDegreeRoot(s.root)+j,O=null==s.root?"-":v.getRootName(s.root,f.keyIndex)+j;e.push(Object(se.jsxs)(cg,{left:n,width:p,isActive:o==u,onClick:function(){r.isMelody=!1,r.focusIndex=r.distIndex=c,i.score.setScoreState(r)},onContextMenu:function(){N.previewCurHarmony(t,i)},children:[Object(se.jsx)(ag,{children:m}),Object(se.jsxs)(rg,{children:[" (",O,")"]})]},e.length))}}n+=p}})),e}),[l,u]);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(ig,{ref:a,children:Object(se.jsx)(og,{width:h,children:j})}),Object(se.jsx)(eg,{ref:c,children:Object(se.jsxs)(ng,{onMouseDown:function(e){return Zf.mouseDownEvent(e,t,i,h,s)},onMouseMove:function(e){return Zf.mouseMoveEvent(e,t,i,h,s)},onMouseUp:function(e){return Zf.mouseUpEvent(e,t,i,h,s)},onMouseLeave:function(){var e=t.melodyState.timelineMouse;e.pos=-1,e.lock=-1,s()},children:[g,Object(se.jsx)(tg,{left:p*b*x,width:b*x})]})})]})},eg=d.b.div(mf||(mf=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background: linear-gradient(to bottom, #ffffff, #808080);\n    width: 100%;\n    height: 40px;\n    text-align: left;\n    border-top: solid 2px #000;\n    white-space: nowrap;\n    overflow: hidden;\n"]))),ng=d.b.div(Of||(Of=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    /* width: 100%; */\n    left: 0;\n    top: 0;\n    width: 10000px;\n    height: 100%;\n    &:hover {\n        background-color: #ff00b347;\n    }\n"]))),tg=d.b.div(kf||(kf=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 10;\n    left: ","px;\n    top: 0px;\n    width: ","px;\n    height: 100%;\n    background-color: #ffff006c;\n"])),(function(e){return e.left}),(function(e){return e.width})),ig=d.b.div(yf||(yf=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #c0c0c0;\n    width: 100%;\n    height: calc(100% - 40px);\n    text-align: left;\n    white-space: nowrap;\n    overflow: hidden;\n"]))),og=d.b.div(Sf||(Sf=Object(s.a)(["\n    width: ","px;\n    height: 100%;\n    overflow: hidden;\n"])),(function(e){return e.width})),cg=d.b.div(wf||(wf=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: ","px;\n    width: ","px;\n    height: calc(100% - 2px);\n    box-sizing: border-box;\n    border: 1px solid #646464;\n    border-left: 4px solid #940000;\n    background-color: #ffffff22;\n    ","\n    margin: 1px 0 0 1px;\n    \n    font-size: 18px;\n    font-weight: 600;\n    text-align: center;\n\n    &:hover {\n        background-color: #fffb0037;\n    }\n"])),(function(e){return e.left}),(function(e){return e.width-1}),(function(e){return e.isActive?Object(d.a)(Lf||(Lf=Object(s.a)(["background-color: #ffce2c9b;"]))):""})),ag=d.b.span(If||(If=Object(s.a)(["\n    color: #d80000;\n"]))),rg=d.b.span(Af||(Af=Object(s.a)(["\n    color: #0000007d;\n"]))),sg=(d.b.div(Ef||(Ef=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    pointer-events: none;\n    /* background-color: #ffffffbe; */\n    width: ","px;\n    vertical-align: bottom;\n    margin-top: 25px;\n    height: ",";\n    box-sizing: border-box;\n    border-left: solid "," #000;\n"])),(function(e){return e.beatWidth/4}),(function(e){return e.isHead?"15px":"10px"}),(function(e){return e.isHead?"2px":"1px"})),d.b.div(Cf||(Cf=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: ","px;\n    height: ","px;\n    border-left: solid ","px ",";\n    box-sizing: border-box;\n    vertical-align: top;\n"])),(function(e){return e.beatWidth/4}),(function(e){return e.height}),(function(e){return e.width}),(function(e){return e.color}))),lg=d.b.div(Tf||(Tf=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 10;\n    left: -5px;\n    top: 18px;\n    font-size: 16px;\n    font-weight: 600;\n    color: #dd0000;\n"]))),dg=function(e){var n=Object(o.useContext)(gS),t=n.store,i=(n.dispatcher,t.scoreData.chordList[0].detail),c=Object(o.useMemo)((function(){var n=[];if(null!=e.curChord){var o=e.curChord.detail,c=v.getSymbolFromKey(o.symbolKey),a=o.root;null!=a&&null!=c&&c.structs.forEach((function(e){n.push((a.index+i.keyIndex+v.IntervalRelationProps[e])%12)}))}for(var r=[],s=function(i){var o=(59-i+9)%12,c=Math.floor((59-i+9)/12)+1,a=v.KEY12_SHARP_LIST[o%12];bg(c);r.push(Object(se.jsx)(xg,{isScale:[0,2,4,5,7,9,11].includes(o),isStruct:n.includes(o),isActive:i===e.mousePitchIndex,onClick:function(){var e=t.instruments.melodyFont;null!=e&&(e.stop(),e.play(a+c,0,{duration:1}))},children:a},i))},l=0;l<60;l++)s(l);return r}),[e.mousePitchIndex,e.curChord]);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(ug,{children:[Object(se.jsx)(pg,{isActive:!1,children:Object(se.jsx)("div",{children:"hihi"})}),Object(se.jsx)(pg,{isActive:!1,children:Object(se.jsx)("div",{children:"hi"})}),Object(se.jsx)(pg,{isActive:!1,children:Object(se.jsx)("div",{children:"mid2"})}),Object(se.jsx)(pg,{isActive:!1,children:Object(se.jsx)("div",{children:"mid1"})}),Object(se.jsx)(pg,{isActive:!1,children:Object(se.jsx)("div",{children:"low"})})]}),Object(se.jsx)(hg,{children:c})]})},bg=function(e){switch(e){case 0:return"low";case 1:return"mid1";case 2:return"mid2";case 3:return"hi";case 4:return"hihi";default:return""}},ug=d.b.div(Mf||(Mf=Object(s.a)(["\n    display: inline-block;\n    width: 30px;\n    height: 100%;\n    vertical-align: top;\n"]))),hg=d.b.div(Df||(Df=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 30px);\n    height: 100%;\n    vertical-align: top;\n"]))),pg=d.b.div(Nf||(Nf=Object(s.a)(["\n    display: inline-block;\n    border: 1px solid black;\n    width: 100%;\n    height: 360px;\n    background-color: #8f8f8f;\n    ","\n    box-sizing: border-box;\n\n    font-size: 18px;\n    color: #dfdfdf;\n    font-weight: 600;\n    & div {\n        width: 360px;\n        transform-origin: top left;\n        transform: rotate(-90deg) translateX(-50%);\n        /* background-color: #fff; */\n    }\n"])),(function(e){return e.isActive?Object(d.a)(Ff||(Ff=Object(s.a)(["background-color: #ffc40089;"]))):""})),xg=d.b.div(_f||(_f=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 20px);\n    border: 1px solid black;\n    ","\n    height: ","px;\n    background-color: #adadad;\n    ","\n    ","\n    box-sizing: border-box;\n\n    padding-left: 5px;\n    line-height: 28px;\n    font-size: 18px;\n    color: #3b3b3b;\n    font-weight: 600;\n"])),(function(e){return e.isScale?Object(d.a)(zf||(zf=Object(s.a)(["\n        width: 100%;\n    "]))):""}),ie,(function(e){return e.isStruct?Object(d.a)(Rf||(Rf=Object(s.a)(["background-color: #e25d5d;"]))):""}),(function(e){return e.isActive?Object(d.a)(Bf||(Bf=Object(s.a)(["\n        background-color: #cece60;\n        ","\n    "])),(function(e){return e.isStruct?Object(d.a)(Pf||(Pf=Object(s.a)(["background-color: #e28c45;"]))):""})):""})),fg=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=t.melodyState;return Object(se.jsxs)(gg,{isActive:e.soundfontInfo.name===c.soundfontInfo.name,onClick:function(){c.soundfontInfo=e.soundfontInfo,c.isPreview=!0,i.melody.setState(c);var n=e.soundfontInfo;jf.a.instrument(new AudioContext,n.name,{gain:n.gain,release:.5}).then((function(e){var n=t.instruments;n.melodyFont=e,i.score.setInstruments(n)})).then((function(){c.isPreview=!1,i.melody.setState(c)}))},children:[Object(se.jsx)(jg,{children:e.icon}),Object(se.jsx)(vg,{children:e.labelName})]})},gg=d.b.div(Kf||(Kf=Object(s.a)(["\n    display: inline-block;\n    width: 85px;\n    height: 40px;\n    text-align: center;\n    border: 1px solid #4b4b4b;\n    background-color: #cacacada;\n    ","\n    border-radius: 6px;\n    margin-left: 4px;\n    box-sizing: border-box;\n\n    &:hover {\n        background-color: #e4e4e4da;\n        ","\n    }\n"])),(function(e){return e.isActive?Object(d.a)(Uf||(Uf=Object(s.a)(["\n        background-color: #f7f7f7da;\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(Vf||(Vf=Object(s.a)(["\n            background-color: #f7f7f7da;\n        "]))):""})),jg=d.b.div(qf||(qf=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 30px;\n    /* background-color: #ff0000da; */\n    font-size: 20px;\n    color: #4b4b4b;\n    text-align: center;\n    /* padding-top: 5px; */\n    box-sizing: border-box;\n"]))),vg=d.b.div(Hf||(Hf=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 10px;\n    /* background-color: #0400ffdc; */\n    font-size: 16px;\n    font-weight: 600;\n    line-height: 0;\n    color: #3b3b3b;\n    text-align: center;\n"]))),mg=function(e){return Object(se.jsx)(Og,{isActive:e.isActive,isDisable:e.isDisable,onClick:e.callback,children:e.labelName})},Og=d.b.div(Jf||(Jf=Object(s.a)(["\n    display: inline-block;\n    width: 100px;\n    height: 28px;\n    background: linear-gradient(to bottom, #e0e0e0, #aaaaaa, #e0e0e0);\n    ","\n    ","\n    color: #5d6e63;\n    border-radius: 2px;\n    border: solid 1px #747373;\n    font-size: 20px;\n    font-weight: 600;\n    text-align: center;\n\n    margin-left: 4px;\n"])),(function(e){return e.isActive?Object(d.a)(Wf||(Wf=Object(s.a)(["\n        background: linear-gradient(to bottom, #b7d9df, #59c6da, #b7d9df);\n    "]))):""}),(function(e){return e.isDisable?Ue:""})),kg=t(66),yg=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.melodyState;return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(Sg,{children:[Object(se.jsxs)(wg,{children:[Object(se.jsx)(mg,{labelName:"32",isDisable:!1,isActive:8===i.quantize,callback:function(){i.quantize=8,t.melody.setState(i)}}),Object(se.jsx)(mg,{labelName:"16",isDisable:!1,isActive:4===i.quantize,callback:function(){i.quantize=4,t.melody.setState(i)}}),Object(se.jsx)(mg,{labelName:"8",isDisable:!1,isActive:[2,6].includes(i.quantize),callback:function(){i.quantize=2,t.melody.setState(i)}}),Object(se.jsx)(mg,{labelName:"4",isDisable:!1,isActive:[1,3].includes(i.quantize),callback:function(){i.quantize=1,t.melody.setState(i)}}),Object(se.jsx)(mg,{labelName:"/3",isDisable:![1,2,3,6].includes(i.quantize),isActive:[3,6].includes(i.quantize),callback:function(){[3,6].includes(i.quantize)?(i.quantize/=3,t.melody.setState(i)):(i.quantize*=3,t.melody.setState(i))}})]}),Object(se.jsx)(Lg,{})]}),Object(se.jsxs)(Ig,{children:[Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.g,{}),labelName:"violin",soundfontInfo:{name:"violin",gain:9}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.b,{}),labelName:"guitar",soundfontInfo:{name:"overdriven_guitar",gain:4}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.d,{}),labelName:"saxphone",soundfontInfo:{name:"tenor_sax",gain:3}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.f,{}),labelName:"viola",soundfontInfo:{name:"viola",gain:5}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.e,{}),labelName:"trumpet",soundfontInfo:{name:"trumpet",gain:5}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.a,{}),labelName:"clarinet",soundfontInfo:{name:"clarinet",gain:4}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.a,{}),labelName:"oboe",soundfontInfo:{name:"oboe",gain:5}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.a,{}),labelName:"flute",soundfontInfo:{name:"flute",gain:5}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(kg.a,{}),labelName:"choir",soundfontInfo:{name:"choir_aahs",gain:6}}),Object(se.jsx)(fg,{icon:Object(se.jsx)(nt.b,{}),labelName:"shamisen",soundfontInfo:{name:"shamisen",gain:9}})]})]})},Sg=d.b.div(Yf||(Yf=Object(s.a)(["\n    display: block;\n    padding: 4px 4px 4px 0;\n    background-color: #bbbbbb;\n"]))),wg=d.b.div(Gf||(Gf=Object(s.a)(["\n    display: inline-block;\n    /* margin-left: 20px; */\n"]))),Lg=d.b.div(Qf||(Qf=Object(s.a)(["\n    display: inline-block;\n    margin-left: 20px;\n"]))),Ig=d.b.div(Xf||(Xf=Object(s.a)(["\n    display: inline-block;\n    /* padding: 4px 4px 4px 0; */\n    background-color: #e4e4e486;\n"]))),Ag=function e(){Object(x.a)(this,e)};Ag.mouseDownEvent=function(e,n,t,i,o){if(0===e.button){var c=n.refs.melody;if(null!=c.table&&null!=c.measure&&null!=c.chord&&null!=c.pitch){var a=n.melodyState,r=n.melodyState.tableMouse,s=r.notesState,l=n.scoreData.notesList,d=1/a.quantize,b=function(){var e=l.find((function(e){return p<w(e.pos)*a.beatWidth})),n=i;return void 0!=e&&(n=w(e.pos)*a.beatWidth),n},u=c.table.getBoundingClientRect(),p=e.clientX+c.table.scrollLeft-u.left,x=e.clientY+c.table.scrollTop-u.top;if(-1===s.index)r.isPut=!0,r.lock={x:Math.floor(p/a.beatWidth/d)*a.beatWidth*d,y:Math.floor(x/ie)*ie},r.nextLeft=b(),r.width=0;else if("normal"===s.side){var f=n.refs.melody;if(null!=f.table&&null!=f.measure&&null!=f.chord&&null!=f.pitch){a.dataHistory.add(JSON.stringify(n.scoreData.notesList));var g=f.table.getBoundingClientRect(),j=e.clientY+f.table.scrollTop-g.top,v=Math.floor(j/ie);l[s.index].pitchIndex=v,n.scoreData.notesList=l.slice(),C(v,n)}}else{var m=l[s.index];if(r.lock={x:w(m.pos)*a.beatWidth,y:0},r.nextLeft=b(),"left"===s.side){if(s.isMove=!0,r.prevRight=0,s.index>0){var O=l[s.index-1];r.prevRight=(w(O.pos)+w(O.len))*a.beatWidth}}else"right"===s.side&&(s.isResize=!0);r.notesState=Object(h.a)({},s)}o()}}},Ag.mouseMoveEvent=function(e,n,t,i,o){if(0===e.button){var c=n.refs.melody;if(null!=c.table&&null!=c.measure&&null!=c.chord&&null!=c.pitch){var a=n.melodyState,r=n.melodyState.tableMouse,s=r.notesState,l=n.scoreData.notesList,d=n.scoreData.chordList,b=1/a.quantize,u=c.table.getBoundingClientRect(),p=e.clientX+c.table.scrollLeft-u.left,x=e.clientY+c.table.scrollTop-u.top;if(r.isPut||s.isResize||s.isMove){if(r.isPut){var f=(Math.floor(p/a.beatWidth/b)+1)*a.beatWidth*b;r.width=(f>r.nextLeft?r.nextLeft:f)-r.lock.x}else if(s.isResize){var g=(Math.floor(p/a.beatWidth/b)+1)*a.beatWidth*b,j=l[s.index],v=g-r.lock.x;g>r.nextLeft&&(v=r.nextLeft-r.lock.x),g<=r.lock.x&&(v=a.beatWidth/a.quantize);var m=A(a.quantize,Math.floor(v/a.beatWidth*a.quantize));w(j.len)!==w(m)&&(a.dataHistory.add(JSON.stringify(n.scoreData.notesList)),j.len=m,n.scoreData.notesList=l.slice())}else if(s.isMove){var O=(Math.floor(p/a.beatWidth/b)+0)*a.beatWidth*b,k=l[s.index],y=w(k.len)*a.beatWidth,S=O;O+y>r.nextLeft&&(S=r.nextLeft-y),O<r.prevRight&&(S=r.prevRight);var L=A(a.quantize,Math.floor(S/a.beatWidth*a.quantize));w(k.pos)!==w(L)&&(a.dataHistory.add(JSON.stringify(n.scoreData.notesList)),k.pos=L,n.scoreData.notesList=l.slice())}}else{r.mousePitchIndex=Math.floor(x/ie),r.mouseMeasurePos=Math.floor(p/a.beatWidth/b);var I=0,E=d.find((function(e){if("chord"===e.type){var n=e.detail.beatLen*a.beatWidth;if(p>=I&&p<I+n)return e;I+=n}}));r.curChord=void 0==E?null:E,s.index=-1;var C=a.focusIndex;a.focusIndex=-1,s.side="normal";for(var T=0;T<l.length;T++){var M=l[T],D=w(M.pos)*a.beatWidth,N=D+w(M.len)*a.beatWidth;if(p>=D&&p<=N){s.index=T,a.focusIndex=T,p<D+10?s.side="left":p>N-10&&(s.side="right");break}}a.destIndex=a.focusIndex,-1!==C&&C!==a.focusIndex&&(a.lastFocus=C),r.notesState=Object(h.a)({},s)}o()}}},Ag.mouseUpEvent=function(e,n,t,i,o){if(0===e.button){var c=n.melodyState,a=n.melodyState.tableMouse,r=a.notesState,s=n.scoreData.notesList,l=c.quantize;if(a.isPut){if(a.isPut=!1,a.width>0){c.dataHistory.add(JSON.stringify(n.scoreData.notesList));var d=Math.floor(a.lock.y/ie);s.push({pos:A(l,Math.floor(a.lock.x/c.beatWidth*l)),pitchIndex:d,len:A(l,Math.floor(a.width/c.beatWidth*l))}),s.sort((function(e,n){var t=w(e.pos),i=w(n.pos);return t===i?0:t<i?-1:1})),t.melody.setNotesList(s),C(d,n)}}else r.isMove=!1,r.isResize=!1,a.notesState=Object(h.a)({},r),t.melody.setNotesList(s.slice());o()}};var Eg=Ag,Cg=function e(){Object(x.a)(this,e)};Cg.keyDownEvent=function(e,n,t){n.userEnv.keyConfig.note;var i=n.melodyState.keySwitch,o=n.melodyState,c=o.focusIndex===o.destIndex,a=o.tableMouse;if(o.isPreview)switch(e.key){case" ":N.stopPreview(n,t,n.reserveTasks)}else if(-1!==a.notesState.index&&(a.notesState.index=-1,a.notesState.isResize=!1,a.notesState.side="normal"),a.mouseMeasurePos=-1,a.mousePitchIndex=-1,i.scaleMode||i.octave||i.resize||i.move||i.shift||i.control){if(i.control)switch(e.key){case"c":t.melody.copyNotes();break;case"v":t.melody.pasteNotes();break;case"a":t.melody.allSelect();break;case"s":t.score.saveFile();break;case"z":t.melody.undo();break;case"y":t.melody.redo()}else if(i.scaleMode||i.octave){var r=i.scaleMode?"scale":"octave";switch(e.key){case"ArrowUp":t.melody.incrementCurPitch(!0,r);break;case"ArrowDown":t.melody.incrementCurPitch(!1,r)}}else if(i.resize)switch(e.key){case"ArrowLeft":t.melody.resizeNotes(!1);break;case"ArrowRight":t.melody.resizeNotes(!0)}else if(i.move)switch(e.key){case"ArrowLeft":t.melody.moveNotes(!1);break;case"ArrowRight":t.melody.moveNotes(!0)}else if(i.shift)switch(e.key){case"ArrowLeft":t.melody.moveDestFocus(!1);break;case"ArrowRight":t.melody.moveDestFocus(!0)}}else switch(e.key){case"ArrowUp":t.melody.incrementCurPitch(!0,"normal");break;case"ArrowDown":t.melody.incrementCurPitch(!1,"normal");break;case"ArrowLeft":c?t.melody.moveFocus(!1):t.melody.releaseRange(!1);break;case"ArrowRight":c?t.melody.moveFocus(!0):t.melody.releaseRange(!0);break;case"a":t.melody.addNotes();break;case"q":alert(JSON.stringify(n.scoreData.notesList[o.focusIndex].len));break;case"w":t.melody.adjustScrollX();break;case"e":t.melody.adjustScrollY();break;case"z":N.previewCurHarmony(n,t);break;case"p":o.isSolo=!o.isSolo,t.melody.setState(o);break;case"Home":t.melody.firstNotes();break;case"0":o.quantize=8,t.melody.setState(o);break;case"1":o.quantize=4,t.melody.setState(o);break;case"2":o.quantize=2,t.melody.setState(o);break;case"3":o.quantize=1,t.melody.setState(o);break;case"/":[3,6].includes(o.quantize)?o.quantize/=3:[2,1].includes(o.quantize)&&(o.quantize*=3),t.melody.setState(o);break;case"Delete":t.melody.removeNotes();break;case" ":t.melody.previewStart()}},Cg.keySwitchEvent=function(e,n,t,i){n.userEnv.keyConfig.note;var o=n.melodyState.keySwitch,c=n.melodyState;if(!c.isPreview&&("Control"===e.key&&(o.control=i,t.melody.setKeySwitch(o)),!o.control)){var a=c.focusIndex===c.destIndex;switch(e.key){case"x":o.octave=i,t.melody.setKeySwitch(o);break;case"c":a&&(o.scaleMode=i,t.melody.setKeySwitch(o));break;case"f":a&&(o.resize=i,t.melody.setKeySwitch(o));break;case"d":o.move=i,t.melody.setKeySwitch(o);break;case"Shift":o.shift=i,t.melody.setKeySwitch(o)}}i&&Cg.keyDownEvent(e,n,t)};var Tg,Mg,Dg,Ng,Fg,_g,zg,Rg,Bg,Pg,Kg,Ug,Vg,qg,Hg,Jg,Wg,Yg,Gg,Qg,Xg,Zg,$g,ej,nj,tj,ij,oj,cj,aj,rj,sj,lj,dj,bj,uj,hj,pj,xj,fj,gj,jj,vj,mj,Oj,kj,yj,Sj,wj,Lj,Ij,Aj,Ej,Cj,Tj,Mj,Dj,Nj,Fj,_j,zj,Rj,Bj,Pj,Kj,Uj,Vj,qj,Hj,Jj,Wj,Yj,Gj,Qj,Xj,Zj,$j,ev,nv,tv,iv,ov,cv,av,rv,sv,lv,dv,bv,uv,hv,pv,xv,fv,gv,jv,vv,mv,Ov,kv,yv,Sv,wv=Cg,Lv=function(e){var n,t=Object(o.useContext)(gS),i=t.store,c=t.dispatcher,a=i.scoreState,r=i.melodyState,s=Object(o.useRef)(null),d=Object(o.useRef)(null),b=Object(o.useRef)(null),u=Object(o.useState)({}),p=Object(l.a)(u,2),x=(p[0],p[1]),f=Object(o.useState)({}),g=Object(l.a)(f,2),j=(g[0],g[1]),m=function(){return x({})},O=r.tableMouse,k=O.isPut,L=O.notesState,I=O.curChord,A=O.mouseMeasurePos,C=O.mousePitchIndex,T=O.width,M=O.lock,D=i.refs.melody,N=150*r.beatWidth*4,F=i.scoreData.notesList,_=(i.melodyState.quantize,i.scoreState.isMelody);null==d.current||(d.current.scrollLeft,d.current.clientWidth);Object(o.useEffect)((function(){c.system.setRefs(Object(h.a)(Object(h.a)({},i.refs),{},{melody:Object(h.a)(Object(h.a)({},i.refs.melody),{},{table:d.current,pitch:b.current})})),c.system.setInvalidate(Object(h.a)(Object(h.a)({},i.invalidate),{},{melody:m}))}),[]),Object(o.useEffect)((function(){_&&null!=s.current&&s.current.focus()}),[_]);var z=Object(o.useMemo)((function(){var e=[];return a.measureCacheList.forEach((function(n,t){e.push(Object(se.jsx)(Vv,{isHead:4===n.rate,beatWidth:r.beatWidth},t))})),e}),[a.beatCacheList,150]),R=Object(o.useMemo)((function(){var e=[];return a.scaleCacheList.forEach((function(n,t){for(var i=("major"===n.scale?v.MAJOR_SCALE_INTERVALS:v.MINOR_SCALE_INTERVALS).map((function(e){return(n.keyIndex+e)%12})),o=[],c=0;c<60;c++){var a=S(c);o.push(Object(se.jsx)(Kv,{isScale:i.includes(a),isBase:a===i[0]},c))}e.push(Object(se.jsx)(Pv,{width:r.beatWidth/4*n.memoriCnt,isEven:t%2===0,children:o},t))})),e}),[a.scaleCacheList]),B=Object(o.useMemo)((function(){var e=[];if(0===a.scaleCacheList.length)return e;for(var n=function(n){var t=F[n],i=w(t.pos),o=w(t.len);if(null!=d.current){var s=d.current.scrollLeft,b=i*r.beatWidth;if(b+o*r.beatWidth-s<0||b-s>d.current.clientWidth)return"continue"}var u=y.getKeyScaleFromNotesPos(i,a.scaleCacheList),h=r.focusIndex<r.destIndex?[r.focusIndex,r.destIndex]:[r.destIndex,r.focusIndex],p=Object(l.a)(h,2),x=p[0],f=p[1],g=x<=n&&f>=n,j=("major"===u.scale?v.MAJOR_SCALE_INTERVALS:v.MINOR_SCALE_INTERVALS).map((function(e){return(u.keyIndex+e)%12})),m=S(t.pitchIndex),O=j.includes(m),k=E(t.pos),I=E(t.len);e.push(Object(se.jsx)(qv,{left:i*r.beatWidth,width:o*r.beatWidth,side:L.side,isActive:g,isScale:r.keySwitch.scaleMode,isResize:r.keySwitch.resize,isMove:r.keySwitch.move,isOctave:r.keySwitch.octave,isPreview:r.isPreview,onContextMenu:function(){c.melody.removeNotes()},children:Object(se.jsx)(Hv,{y:t.pitchIndex*ie,lenType:k>I?k:I,isScale:O,isActive:g,isPreview:r.isPreview})},n))},t=0;t<F.length;t++)n(t);return e}),[F,F.length,r.focusIndex,r.destIndex,L,r.isPreview,r.keySwitch.scaleMode,r.keySwitch.octave,r.keySwitch.resize,r.keySwitch.move,null===(n=D.table)||void 0===n?void 0:n.scrollLeft]);return Object(se.jsxs)(Iv,{tabIndex:999,ref:s,isActive:e.isActive,onKeyDown:function(e){return wv.keySwitchEvent(e,i,c,!0)},onKeyUp:function(e){return wv.keySwitchEvent(e,i,c,!1)},children:[Object(se.jsx)(Cv,{isEnable:!r.isPreview,children:Object(se.jsx)(yg,{})}),Object(se.jsxs)(Tv,{children:[function(){var e=r.timelineMouse;if(-1===e.lock)return-1===e.pos?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(Dv,{left:e.pos});var n=e.lock<e.pos?[e.lock,e.pos]:[e.pos,e.lock],t=Object(l.a)(n,2),i=t[0],o=t[1]-i;return Object(se.jsx)(Nv,{left:i,width:o})}(),Object(se.jsx)(Fv,{children:Object(se.jsx)($f,{barLength:150,beatWidth:r.beatWidth,curChord:I,timelineLength:N,mouseMeasurePos:A,update:function(){return j({})}})}),Object(se.jsx)(_v,{ref:b,children:Object(se.jsx)(dg,{mousePitchIndex:C,curChord:I})}),Object(se.jsxs)(zv,{ref:d,onScroll:function(){if(null!=D.table&&null!=D.measure&&null!=D.chord&&null!=D.pitch){var e=D.table.scrollLeft,n=D.table.scrollTop;D.measure.scrollTo({left:e}),D.chord.scrollTo({left:e}),D.pitch.scrollTo({top:n})}m()},children:[Object(se.jsx)(Rv,{width:N,children:z}),Object(se.jsx)(Bv,{width:N,children:R}),Object(se.jsxs)(Uv,{width:N,onMouseDown:function(e){return Eg.mouseDownEvent(e,i,c,N,m)},onMouseMove:function(e){return Eg.mouseMoveEvent(e,i,c,N,m)},onMouseUp:function(e){return Eg.mouseUpEvent(e,i,c,N,m)},onMouseLeave:function(){console.log("leave!"),-1!==O.notesState.index&&(O.notesState.index=-1,O.notesState.isResize=!1,O.notesState.side="normal"),O.mouseMeasurePos=-1,O.mousePitchIndex=-1,m()},children:[k?Object(se.jsx)(Ev,{x:M.x,y:M.y,width:T,lenType:T%r.beatWidth===0?4:T%(r.beatWidth/2)===0?8:16}):Object(se.jsx)(se.Fragment,{}),B]}),Object(se.jsx)(Jv,{isUse:r.isPreview,width:N})]})]})]})},Iv=d.b.div(Tg||(Tg=Object(s.a)(["\n    display: ",";\n    width: 100%;\n    height: 100%;\n    outline: none;\n"])),(function(e){return e.isActive?"inline-block":"none"})),Av=Object(d.c)(Mg||(Mg=Object(s.a)(["\n  0%,100% {\n    opacity: 0.2;\n  }\n  50% {\n    opacity: 1;\n  }\n"]))),Ev=d.b.div(Dg||(Dg=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: ","px;\n    top: ","px;\n    width: ","px;\n    height: ","px;\n    background: linear-gradient(to bottom, #dff85230, #fffb00, #dff85230);\n    border: 1px solid #fbffd9;\n    \n    animation: "," .8s linear infinite;\n"])),(function(e){return e.x}),(function(e){return e.y}),(function(e){return e.width}),(function(e){switch(e.lenType){case 4:return ie;case 8:return 24;case 16:return 18;default:return 16}}),Av),Cv=d.b.div(Ng||(Ng=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    background-color: #b3b3b3;\n    ","\n"])),80,(function(e){return e.isEnable?"":Ue})),Tv=d.b.div(Fg||(Fg=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: calc(100% - ","px);\n    background-color: #464646;\n"])),80),Mv=Object(d.a)(_g||(_g=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    pointer-events: none;\n    z-index: 99;\n    top: ","px;\n    height: calc(100% - 42px);\n    width: 3px;\n"])),32),Dv=d.b.div(zg||(zg=Object(s.a)(["\n    ","\n    left: ","px;\n    background-color: #15ff00;\n"])),Mv,(function(e){return te+e.left})),Nv=(d.b.div(Rg||(Rg=Object(s.a)(["\n    ","\n    left: ","px;\n    background-color: #fbff00;\n"])),Mv,(function(e){return te+e.left})),d.b.div(Bg||(Bg=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    pointer-events: none;\n    z-index: 99;\n    top: ","px;\n    height: calc(100% - 42px);\n    left: ","px;\n    width: ","px;\n    background-color: #ffffff8b;\n"])),32,(function(e){return te+e.left}),(function(e){return e.width}))),Fv=d.b.div(Pg||(Pg=Object(s.a)(["\n    display: inline-block;\n    margin-left: ","px;\n    width: calc(100% - ","px - 10px);\n    height: ","px;\n    background-color: #534b81;\n    overflow-y: hidden;\n"])),te,te,70),_v=d.b.div(Kg||(Kg=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: calc(100% - ","px - 10px);\n    background-color: #464545;\n    vertical-align: top;\n    overflow-y: hidden;\n"])),te,70),zv=d.b.div(Ug||(Ug=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: calc(100% - ","px);\n    height: calc(100% - ","px);\n    background-color: #bdbdbd;\n    vertical-align: top;\n    overflow: scroll;\n    &::-webkit-scrollbar {\n        width: 10px;\n        height: 10px;\n    }\n    &::-webkit-scrollbar-thumb {\n        border-radius: 5px;\n        background: #1959A8;\n    }\n    &::-webkit-scrollbar-track {\n        border-radius: 5px;\n        box-shadow: 0 0 4px #aaa inset;\n    }\n"])),te,70),Rv=d.b.div(Vg||(Vg=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 3;\n    width: ","px;\n    height: ","px;\n    white-space: nowrap;\n"])),(function(e){return e.width}),1800),Bv=d.b.div(qg||(qg=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    /* z-index: 6; */\n    width: ","px;\n    height: ","px;\n    /* pointer-events: none; */\n    /* background-color: #70ff7058; */\n"])),(function(e){return e.width}),1800),Pv=d.b.div(Hg||(Hg=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    top: 0;\n    left: 0;\n    /* z-index: 6; */\n    width: ","px;\n    height: 100%;\n    /* pointer-events: none; */\n    background-color: #70ff7021;\n    ","\n"])),(function(e){return e.width}),(function(e){return e.isEven?Object(d.a)(Jg||(Jg=Object(s.a)(["\n        background-color: #708aff20;\n    "]))):""})),Kv=d.b.div(Wg||(Wg=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: ","px;\n    margin: 1px 0 0 0;\n    background-color: #00000024;\n    /* border-bottom: 1px solid #00000018; */\n    ","\n    ","\n"])),29,(function(e){return e.isScale?Object(d.a)(Yg||(Yg=Object(s.a)(["\n        background-color: #d1d1d11f;\n    "]))):""}),(function(e){return e.isBase?Object(d.a)(Gg||(Gg=Object(s.a)(["\n        background-color: #e0e0e0;\n    "]))):""})),Uv=d.b.div(Qg||(Qg=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 5;\n    width: ","px;\n    height: ","px;\n    cursor: crosshair;\n"])),(function(e){return e.width}),1800),Vv=d.b.div(Xg||(Xg=Object(s.a)(["\n    display: inline-block;\n    /* background-color: #ffffffbe; */\n    width: ","px;\n    vertical-align: top;\n    height: ","px;\n    box-sizing: border-box;\n    border-left: solid "," #757575;\n"])),(function(e){return e.beatWidth/4}),1800,(function(e){return e.isHead?"2px":"1px"})),qv=d.b.div(Zg||(Zg=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 9;\n    left: ","px;\n    top: 0;\n    width: ","px;\n    height: 100%;\n    cursor: default;\n    background-color: #2727275a;\n    box-sizing: border-box;\n\n    // \u30a2\u30af\u30c6\u30a3\u30d6\u6642\n    ","\n    // \u30b9\u30b1\u30fc\u30eb\u30e2\u30fc\u30c9ON\n    ","\n    // \u30aa\u30af\u30bf\u30fc\u30d6\u30e2\u30fc\u30c9ON\n    ","\n    /* border-left: 1px solid #ff0000b2; */\n    ","\n\n    // \u30ad\u30fc\u30dc\u30fc\u30c9\u306b\u3088\u308b\u30ea\u30b5\u30a4\u30ba\u30e2\u30fc\u30c9ON\n    ","\n    // \u30ad\u30fc\u30dc\u30fc\u30c9\u306b\u3088\u308b\u79fb\u52d5\u30e2\u30fc\u30c9ON\n    ","\n    // \u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\n    ","\n"])),(function(e){return e.left}),(function(e){return e.width}),(function(e){return e.isActive?Object(d.a)($g||($g=Object(s.a)(["\n        background-color: #00a6cf52;\n    "]))):""}),(function(e){return e.isActive&&e.isScale?Object(d.a)(ej||(ej=Object(s.a)(["\n        background-color: #00cf4552;\n    "]))):""}),(function(e){return e.isActive&&e.isOctave?Object(d.a)(nj||(nj=Object(s.a)(["\n        background-color: #ffa9a952;\n    "]))):""}),(function(e){return e.isActive?"left"===e.side?Object(d.a)(tj||(tj=Object(s.a)(["\n        border-left: 3px solid #0026ffb1;\n        cursor : col-resize;\n        background-color: #1900ff52;\n    "]))):"right"===e.side?Object(d.a)(ij||(ij=Object(s.a)(["\n        border-right: 3px solid #0026ffb1;\n        cursor : col-resize;\n        background-color: #ff00006e;\n    "]))):"":""}),(function(e){return e.isActive&&e.isResize?Object(d.a)(oj||(oj=Object(s.a)(["\n        border-right: 3px solid #0026ffb1;\n        background-color: #ff00006e;\n    "]))):""}),(function(e){return e.isActive&&e.isMove?Object(d.a)(cj||(cj=Object(s.a)(["\n        border-left: 3px solid #0026ffb1;\n        background-color: #1900ff52;\n    "]))):""}),(function(e){return e.isActive&&e.isPreview?Object(d.a)(aj||(aj=Object(s.a)(["\n        background-color: #fffb0040;\n    "]))):""})),Hv=d.b.div(rj||(rj=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 10;\n    top: ","px;\n    width: 100%;\n    height: ","px;\n    /* background-color: red; */\n    /* background: linear-gradient(to bottom, ","); */\n    border-radius: 15px 0 0 15px;\n    background: linear-gradient(to bottom, #f8525232, #ff0000, #f8525232);\n    ","\n    opacity: 0.5;\n    ","\n    /* border: 1px solid #000; */\n    box-sizing: border-box;\n    font-size: 12px;\n    color: #000000;\n    box-shadow: 0 0 22px 0 #0000007d;\n    ","\n    &:hover {\n        opacity: 0.8;\n    }\n"])),(function(e){return e.y}),(function(e){return ie-(1===e.lenType?0:2===e.lenType?6:4===e.lenType?12:14)}),(function(e){switch(e.lenType){case 4:return"#f8525232, #ff0000, #f8525232";case 8:return"#5d52f831, #0400ff, #5d52f831";case 16:return"#52f85a31, #00ff15, #52f85a31"}}),(function(e){return e.isScale?"":Object(d.a)(sj||(sj=Object(s.a)(["    \n       background: linear-gradient(to bottom, #f8b65231, #ffae00, #f8b65231);\n    "])))}),(function(e){return e.isPreview&&!e.isActive?"":Object(d.a)(lj||(lj=Object(s.a)(["    \n       opacity: 1;\n    "])))}),(function(e){return e.isPreview&&e.isActive?Object(d.a)(dj||(dj=Object(s.a)(["\n        box-shadow: 0 0 32px 0 #ffffff92;\n    "]))):""})),Jv=d.b.div(bj||(bj=Object(s.a)(["\n    position: absolute;\n    display: ",";\n    z-index: 80;\n    width: ","px;\n    height: ","px;\n    background-color: #7a270028;\n"])),(function(e){return e.isUse?"block":"none"}),(function(e){return e.width}),1800),Wv=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.scoreState,c=n.melodyState,a=void 0!=n.systemState.directScore;Object(o.useEffect)((function(){var e=c.soundfontInfo;if(null==n.instruments.melodyFont&&null==n.instruments.harmonyFont){var i=n.instruments;jf.a.instrument(new AudioContext,e.name,{gain:e.gain,release:.5}).then((function(e){i.melodyFont=e,jf.a.instrument(new AudioContext,"electric_grand_piano",{gain:2,release:.5}).then((function(e){i.harmonyFont=e,t.score.setInstruments(i)}))}))}}),[]);var r=function(){i.isMelody=!i.isMelody,t.score.setScoreState(i)};if(0===n.scoreData.chordList.length)return Object(se.jsx)(se.Fragment,{});var s=i.isMelody?n.melodyState.isPreview:i.isPreview,l=i.isMelody?c.isSolo:i.isSolo,d=i.isMelody?function(){c.isPreview?N.stopPreview(n,t,n.reserveTasks):t.melody.previewStart()}:function(){i.isPreview?Nr.stopPreview(n,t,n.reserveTasks):Nr.previewStart(n,t)},b=i.isMelody?function(){c.isSolo=!c.isSolo,t.melody.setState(c)}:function(){i.isSolo=!i.isSolo,t.score.setScoreState(i)},u=Object(se.jsx)(nm,{isActive:s,children:"Play"}),h=Object(se.jsx)(nm,{isActive:!s,children:"Pause"}),p=Object(se.jsx)(nm,{isActive:!l,children:"Emsamble"}),x=Object(se.jsx)(nm,{isActive:l,children:"Solo"});return Object(se.jsxs)(Yv,{children:[Object(se.jsxs)(Gv,{isEnable:"none"===i.hideMenu,children:[Object(se.jsxs)(Qv,{isEnable:!s,children:[Object(se.jsx)(Xv,{isActive:!i.isMelody,onClick:function(){i.isMelody&&r()},children:"Harmony"}),Object(se.jsx)(Xv,{isActive:i.isMelody,onClick:function(){i.isMelody||r()},children:"Melody"})]}),Object(se.jsxs)(Zv,{children:[Object(se.jsxs)(em,{isEnable:!0,onClick:d,children:[u," / ",h]}),Object(se.jsxs)(em,{isEnable:!i.isPreview,onClick:b,children:[p," / ",x]}),Object(se.jsx)($v,{isEnable:!a,onClick:t.score.saveFile,children:"Save"})]})]}),Object(se.jsx)(tm,{tabIndex:999,onKeyDown:function(e){if(!s&&"none"===i.hideMenu)switch(e.key){case"r":r()}},children:Object(se.jsxs)(im,{children:[Object(se.jsx)(cf,{isActive:!i.isMelody}),Object(se.jsx)(Lv,{isActive:i.isMelody})]})})]})},Yv=d.b.div(uj||(uj=Object(s.a)(["\n    width: 100%;\n    height: 100%;\n    outline: none;\n"]))),Gv=d.b.div(hj||(hj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 35px;\n    background-color: #ececec;\n    ","\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),Qv=d.b.div(pj||(pj=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    height: 100%;\n    text-align: center;\n    margin-right: 20px;\n    ","\n"])),(function(e){return e.isEnable?"":Ue})),Xv=d.b.div(xj||(xj=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    width: 120px;\n    height: calc(100% - 8px);\n    /* background-color: #e0ff6f55; */\n    ","\n    margin: 4px 0 0 4px;\n\n    font-size: 18px;\n    font-weight: 600;\n    color: #505050;\n    border-radius: 5px;\n    border: 1px solid #969696;\n    box-sizing: border-box;\n    &:hover {\n        background-color: #e0ff6f55;\n        ","\n    }\n"])),(function(e){return e.isActive?Object(d.a)(fj||(fj=Object(s.a)(["background-color: #e2c36dc0;"]))):""}),(function(e){return e.isActive?Object(d.a)(gj||(gj=Object(s.a)(["background-color: #e2c36dc0;"]))):""})),Zv=d.b.div(jj||(jj=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    height: 100%;\n    /* background-color: #e0ff6f55; */\n\n    & * {\n        margin: 3px 0 0 5px;\n    }\n"]))),$v=d.b.div(vj||(vj=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    width: 150px;\n    height: calc(100% - 8px);\n    background-color: #cae4e3;\n    margin: 4px 0 0 24px;\n    text-align: center;\n\n    font-size: 18px;\n    font-weight: 600;\n    color: #000000cf;\n    border-radius: 5px;\n    border: 1px solid #969696;\n    box-sizing: border-box;\n    ","\n    &:hover {\n        background-color: #dceceb\n    }\n"])),(function(e){return e.isEnable?"":Ue})),em=d.b.div(mj||(mj=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    width: 220px;\n    height: calc(100% - 8px);\n    background-color: #e1e4ca;\n    margin: 4px 0 0 4px;\n    text-align: center;\n\n    font-size: 18px;\n    font-weight: 600;\n    color: #000000cf;\n    border-radius: 5px;\n    border: 1px solid #969696;\n    box-sizing: border-box;\n    ","\n    &:hover {\n        background-color: #eff3cf\n    }\n"])),(function(e){return e.isEnable?"":Ue})),nm=d.b.span(Oj||(Oj=Object(s.a)(["\n    color: #00109e6e;\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(kj||(kj=Object(s.a)(["color: #db0000;"]))):""})),tm=d.b.div(yj||(yj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: calc(100% - 35px);\n    background-color: #c50000;\n    outline: none;\n"]))),im=d.b.div(Sj||(Sj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 100%;\n    background-color: #dddddd;\n    vertical-align: top;\n"]))),om=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=-1!==n.scoreState.focusIndex;return Object(se.jsx)(cm,{children:Object(se.jsx)(le,{tabElements:[{name:"Manage",disable:!1,cont:Object(se.jsx)(Zc,{})},{name:"Edit",disable:!i,cont:Object(se.jsx)(Wv,{})}],activeNo:n.systemState.scoreTabIndex,selectTabIndex:function(e){return t.score.setScoreTabIndex(e)}})})},cm=d.b.div(wj||(wj=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin: ","px 0 0 ","px;\n    width: calc(100% - ","px);\n    height: calc(100% - ","px);\n    background-color: transparent;\n    /* background-color: #c3d8dd6f; */\n    /* border: solid 1px black;\n    border-radius: 5px; */\n    /* box-shadow: 0 2px 14px 4px #000b3a48; */\n"])),8,8,16,16),am=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher;return Object(se.jsx)(rm,{children:Object(se.jsx)(le,{tabElements:[{name:"Sound",disable:!0,cont:Object(se.jsx)("div",{})},{name:"Design",disable:!0,cont:Object(se.jsx)("div",{})}],activeNo:n.systemState.scoreTabIndex,selectTabIndex:function(e){return t.score.setScoreTabIndex(e)}})})},rm=d.b.div(Lj||(Lj=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin: ","px 0 0 ","px;\n    width: calc(100% - ","px);\n    height: calc(100% - ","px);\n    background-color: transparent;\n    /* background-color: #c3d8dd6f; */\n    /* border: solid 1px black;\n    border-radius: 5px; */\n    /* box-shadow: 0 2px 14px 4px #000b3a48; */\n"])),8,8,16,16),sm=function(){var e=function(e,n){var t=[];return t.push(Object(se.jsx)(um,{children:Object(se.jsx)("div",{children:e})},t.length)),n.forEach((function(e){var n=e.degree,i=(n.isFlat?v.DEGREE12_FLAT_LIST:v.DEGREE12_SHARP_LIST)[n.index],o=(n.isFlat?v.KEY12_FLAT_LIST:v.KEY12_SHARP_LIST)[n.index],c=v.getSymbolFromKey(e.symbolKey).name;t.push(Object(se.jsxs)(hm,{onMouseDown:function(n){0===n.button&&v.getSymbolFromKey(e.symbolKey).structs.map((function(n){var t=v.IntervalRelationProps[n];return 36+e.degree.index+t})).forEach((function(e){v.KEY12_SHARP_LIST[e%12],Math.floor(e/12)}))},children:[Object(se.jsxs)("div",{children:[i,c]}),Object(se.jsxs)("div",{children:[o,c]})]},t.length))})),Object(se.jsx)(dm,{children:t})};return Object(se.jsxs)(lm,{onMouseDown:function(e){e.button},children:[e("Diatonic Triad",[{degree:{index:0,isFlat:!1},symbolKey:"major"},{degree:{index:2,isFlat:!1},symbolKey:"minor"},{degree:{index:4,isFlat:!1},symbolKey:"minor"},{degree:{index:5,isFlat:!1},symbolKey:"major"},{degree:{index:7,isFlat:!1},symbolKey:"major"},{degree:{index:9,isFlat:!1},symbolKey:"minor"},{degree:{index:11,isFlat:!1},symbolKey:"minor-minus5"}]),e("Diatonic Tetrad",[{degree:{index:0,isFlat:!1},symbolKey:"major-maj7th"},{degree:{index:2,isFlat:!1},symbolKey:"minor-7th"},{degree:{index:4,isFlat:!1},symbolKey:"minor-7th"},{degree:{index:5,isFlat:!1},symbolKey:"major-maj7th"},{degree:{index:7,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:9,isFlat:!1},symbolKey:"minor-7th"},{degree:{index:11,isFlat:!1},symbolKey:"minor7-minus5"}]),e("Parallel Triad",[{degree:{index:0,isFlat:!0},symbolKey:"minor"},{degree:{index:2,isFlat:!0},symbolKey:"major"},{degree:{index:3,isFlat:!0},symbolKey:"major"},{degree:{index:5,isFlat:!0},symbolKey:"minor"},{degree:{index:7,isFlat:!0},symbolKey:"minor"},{degree:{index:8,isFlat:!0},symbolKey:"major"},{degree:{index:10,isFlat:!0},symbolKey:"major"}]),e("Secondary Dominant",[{degree:{index:7,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:9,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:11,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:0,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:2,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:4,isFlat:!1},symbolKey:"major-min7th"},{degree:{index:10,isFlat:!1},symbolKey:"major-min7th"}])]})},lm=d.b.div(Ij||(Ij=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    margin: 4px 0 0 4px;\n    background-color: #c3d8dd6f;\n    border: solid 1px #888;\n    border-radius: 5px;\n    box-sizing: border-box;\n"]))),dm=d.b.div(Aj||(Aj=Object(s.a)(["\n    display: inline-block;\n    width: 160px;\n    background-color: #bbbbbb;\n    padding-bottom: 5px;\n"]))),bm=d.b.div(Ej||(Ej=Object(s.a)(["\n    display: inline-block;\n    width: 150px;\n    height: 80px;\n    margin: 5px 0 0 5px;\n    box-sizing: border-box;\n    border-radius: 4px;\n"]))),um=Object(d.b)(bm)(Cj||(Cj=Object(s.a)(["\n    background-color: #51608f;\n    /* border: 1px solid #dfdfdf; */\n    font-weight: 600;\n    & div:nth-child(1) {\n        width: 100%;\n        text-align: center;\n        height: 100%;\n        font-size: 26px;\n        color: #ebebeb;\n    }\n"]))),hm=Object(d.b)(bm)(Tj||(Tj=Object(s.a)(["\n    background-color: #e0ebe5;\n    border: 1px solid #777;\n    & *{\n        width: 100%;\n        text-align: center;\n        height: 50%;\n    }\n    & div:nth-child(1) {\n        font-size: 26px;\n        color: #d40000;\n    }\n    & div:nth-child(2) {\n        font-size: 24px;\n        color: #000000;\n    }\n    &:hover {\n        background-color: #fcf29f;\n    }\n"]))),pm=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=Object(o.useState)([]),c=Object(l.a)(i,2),a=c[0],r=c[1];return Object(o.useEffect)((function(){fetch("assets/sample.lcrt").then((function(e){return e.text()})).then((function(e){var i=JSON.parse(re.a.unZip(e)),o=n.systemState;o.themaList.push(i),t.system.setState(o)})),fetch("assets/release_note.json").then((function(e){return e.json()})).then((function(e){r(e.map((function(e,n){var t=e.note.split("\n").map((function(e,n){return Object(se.jsxs)("span",{children:[e,Object(se.jsx)("br",{})]},n)}));return Object(se.jsxs)(fm,{children:[Object(se.jsxs)(gm,{children:["v",e.version," (",e.date,")"]}),Object(se.jsx)(jm,{children:t})]},n)})))}))}),[]),Object(se.jsx)(xm,{children:a})},xm=d.b.div(Mj||(Mj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - ","px);\n    margin: 4px 0 0 4px;\n    background-color: #d3d3c5;\n    border: 1px solid #e60000;\n    border-radius: 4px;\n    box-sizing: border-box;\n    overflow-y: auto;\n"])),490),fm=d.b.div(Dj||(Dj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    margin: 4px 0 0 4px;\n    background-color: #bfcace;\n    border: 1px solid #9b9b9b;\n    border-radius: 6px;\n"]))),gm=d.b.div(Nj||(Nj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: 20px;\n    font-size: ","px;\n    margin: 2px 0 0 4px;\n    font-weight: 600;\n    /* background-color: #8bdbf8; */\n    color: #494975;\n"])),Be.FONT_SMALL),jm=d.b.div(Fj||(Fj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    font-size: ","px;\n    margin: 2px 0 0 4px;\n    /* background-color: #dafce4; */\n    color: #754949;\n"])),Be.FONT_SMALL),vm=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,Object(o.useState)("-")),i=Object(l.a)(t,2),c=(i[0],i[1]),a=Object(o.useState)(0),r=Object(l.a)(a,2),s=r[0],d=r[1],b=Object(o.useState)([]),u=Object(l.a)(b,2),h=u[0],p=u[1],x=n.userEnv.login;Object(o.useEffect)((function(){null==n.systemState.directScore&&mm().then((function(e){d(24+e),Om().then((function(e){p(e)}))}))}),[]),Object(o.useEffect)((function(){c(x?x.id:"")}),[x]);var f=h.map((function(e,n){return Object(se.jsxs)(Im,{onClick:function(){window.open(re.a.getPreviewURL(e.seq),"_blank")},children:[Object(se.jsx)(Am,{children:"".concat(e.owner)}),Object(se.jsx)(Em,{children:"".concat(e.dispnam)}),Object(se.jsx)(Cm,{children:e.lastmod})]},n)}));return Object(se.jsxs)(km,{children:[Object(se.jsxs)(ym,{children:[Object(se.jsxs)(Sm,{children:[s," users have created accounts."]}),Object(se.jsx)(pm,{})]}),Object(se.jsxs)(wm,{children:[Object(se.jsxs)(Sm,{children:[h.length," licresia scores have been published."]}),Object(se.jsx)(Lm,{children:f})]})]})},mm=function(){var e=Object(p.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.a.sendQueryRequestToAPI("select","SELECT count(*) cnt FROM user_tbl");case 2:return n=e.sent,e.next=5,n.json();case 5:return t=e.sent,e.abrupt("return",t[0].cnt);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Om=function(){var e=Object(p.a)(u.a.mark((function e(){var n,t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.a.sendQueryRequestToAPI("select","\n        SELECT seq, (select id from user_tbl where seq = score.user_seq) as owner, dispnam, lastmod\n        FROM scoretbl score\n        WHERE share <> 'url'\n        ORDER BY lastmod desc\n    ");case 2:return n=e.sent,e.next=5,n.json();case 5:return t=e.sent,e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),km=d.b.div(_j||(_j=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    margin: 4px 0 0 4px;\n    background-color: #ccc;\n"]))),ym=d.b.div(zj||(zj=Object(s.a)(["\n    display: inline-block;\n    width: 50%;\n    height: 100%;\n    background-color: #bbcac7;\n"]))),Sm=d.b.div(Rj||(Rj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    font-size: 22px;\n    font-weight: 600;\n    color: #cd0202;\n    background-color: #ffffff3d;\n    padding: 0 0 0 10px;\n    box-sizing: border-box;\n"]))),wm=(d.b.div(Bj||(Bj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: ","px;\n    margin: 4px 0 4px 4px;\n    background-color: #acacac;\n    border: solid 1px #1b00b3;\n    ","\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: #060053;\n"])),400,(function(e){return e.isEnable?"":Object(d.a)(Pj||(Pj=Object(s.a)(["\n        opacity: 0.3;\n        pointer-events: none;\n    "])))})),d.b.div(Kj||(Kj=Object(s.a)(["\n    display: inline-block;\n    height: 40px;\n    font-size: 30px;\n    font-weight: 600;\n    color: #1c2c95;\n    /* background-color: #3f80cf57; */\n    padding: 0 10px;\n"]))),d.b.div(Uj||(Uj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 35px;\n    /* background-color: #3fcf7b56; */\n    padding: 4px 0 0 10px;\n"]))),d.b.div(Vj||(Vj=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: 140px;\n    font-size: 24px;\n    line-height: 24px;\n    font-weight: 600;\n    color: #08106e;\n    border: solid 1px #1b00b3;\n    box-sizing: border-box;\n    /* background-color: #85a2c5; */\n    background: linear-gradient(to bottom, #8a98a7, #a3bbd2, #8a98a7);\n    border-radius: 4px;\n    text-align: center;\n"]))),d.b.div(qj||(qj=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 30px;\n    user-select: text;\n    /* font-weight: 600; */\n    color: #ffffff;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #808080;\n    text-align: left;\n"]))),d.b.input(Hj||(Hj=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 24px;\n    /* font-weight: 600; */\n    color: #1a1a1a;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #e9e9e9;\n    text-align: left;\n"]))),d.b.div(Jj||(Jj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    /* background-color: #888888; */\n    box-sizing: border-box;\n    text-align: left;\n"]))),d.b.div(Wj||(Wj=Object(s.a)(["\n    ","\n    /* width: 160px; */\n    padding: 0 40px;\n    /* line-height: 25px; */\n    box-sizing: border-box;\n    background-color: #a8a8a8;\n    background: linear-gradient(to bottom, #787878, #b4b4b4, #787878);\n    border: 1px solid #1a2b3f;\n    color: #1a2b3f;\n    border-radius: 4px;\n    margin: 5px 0 0 4px;\n    ","\n    &:hover {\n        /* background-color: #98bfc2; */\n    background: linear-gradient(to bottom, #989898, #b4b4b4, #989898);\n    }\n"])),Ke,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),d.b.div(Yj||(Yj=Object(s.a)(["\n    display: inline-block;\n    width: 50%;\n    height: 100%;\n    background-color: #bbbfca;\n    vertical-align: top;\n"])))),Lm=d.b.div(Gj||(Gj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - 42px);\n    margin: 4px 0 0 4px;\n    background-color: #d3d3c5;\n    border: 1px solid #e60000;\n    border-radius: 4px;\n    box-sizing: border-box;\n    overflow-y: auto;\n"]))),Im=d.b.div(Qj||(Qj=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    /* height: 60px; */\n    border-bottom: 1px solid #888888;\n    /* background-color: white; */\n    background: linear-gradient(to bottom, transparent, #b6b6b684);\n    margin: 2px 0 0 0;\n    padding: 0 0 0 4px;\n    box-sizing: border-box;\n    /* padding-left: 4px; */\n    &:hover {\n        background: linear-gradient(to bottom, transparent, #ffffff5c);\n    }\n"]))),Am=d.b.div(Xj||(Xj=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 20px;\n    line-height: 21px;\n    font-size: 18px;\n    font-weight: 600;\n    color: #c9494f;\n    overflow: hidden;\n    white-space: nowrap;\n"]))),Em=d.b.div(Zj||(Zj=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 250px);\n    height: 35px;\n    font-size: 24px;\n    line-height: 36px;\n    font-weight: 600;\n    color: #47417c;\n    /* background-color: #f8f8e8; */\n    overflow: hidden;\n    white-space: nowrap;\n"]))),Cm=d.b.div($j||($j=Object(s.a)(["\n    display: inline-block;\n    width: 250px;\n    height: 35px;\n    font-size: 24px;\n    line-height: 36px;\n    font-weight: 600;\n    color: #417c49;\n    /* background-color: #f8f8e8; */\n    overflow: hidden;\n    white-space: nowrap;\n"]))),Tm=function(){var e=Object(o.useContext)(gS),n=e.store,t=(e.dispatcher,Object(o.useState)("-")),i=Object(l.a)(t,2),c=(i[0],i[1],n.systemState.directScore),a=null==c?["-","-"]:[c.owner,c.name],r=Object(l.a)(a,2),s=r[0],d=r[1];return Object(se.jsx)(Dm,{children:Object(se.jsxs)(Nm,{children:[Object(se.jsx)(zm,{children:Object(se.jsx)(_m,{children:"Score Data"})}),Object(se.jsxs)(Fm,{isEnable:!0,children:[Object(se.jsxs)(zm,{children:[Object(se.jsx)(Rm,{children:"owner"}),Object(se.jsx)(Bm,{children:s})]}),Object(se.jsxs)(zm,{children:[Object(se.jsx)(Rm,{children:"name"}),Object(se.jsx)(Bm,{children:d})]}),Object(se.jsx)(Pm,{isEnable:!0,onClick:function(){Mm(JSON.stringify(n.scoreData))},children:"Download"})]})]})})},Mm=function(e){window.showSaveFilePicker({types:[{accept:{"text/plain":[".lcrs"]}}]}).then((function(n){Object(p.a)(u.a.mark((function t(){var i,o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.createWritable();case 2:return i=t.sent,o=re.a.gZip(e),t.next=6,i.write(o);case 6:return t.next=8,i.close();case 8:case"end":return t.stop()}}),t)})))()})).catch((function(){console.log("\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f")}))},Dm=d.b.div(ev||(ev=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    margin: 4px 0 0 4px;\n    background-color: #ccc;\n"]))),Nm=d.b.div(nv||(nv=Object(s.a)(["\n    display: inline-block;\n    width: 50%;\n    height: 100%;\n    background-color: #bbcac7;\n"]))),Fm=d.b.div(tv||(tv=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: 400px;\n    margin: 4px 0 4px 4px;\n    background-color: #acacac;\n    border: solid 1px #1b00b3;\n    ","\n    border-radius: 4px;\n    box-sizing: border-box;\n    color: #060053;\n"])),(function(e){return e.isEnable?"":Object(d.a)(iv||(iv=Object(s.a)(["\n        opacity: 0.3;\n        pointer-events: none;\n    "])))})),_m=d.b.div(ov||(ov=Object(s.a)(["\n    display: inline-block;\n    height: 40px;\n    font-size: 30px;\n    font-weight: 600;\n    color: #1c2c95;\n    /* background-color: #3f80cf57; */\n    padding: 0 10px;\n"]))),zm=d.b.div(cv||(cv=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 35px;\n    /* background-color: #3fcf7b56; */\n    padding: 4px 0 0 10px;\n"]))),Rm=d.b.div(av||(av=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: 140px;\n    font-size: 24px;\n    line-height: 24px;\n    font-weight: 600;\n    color: #08106e;\n    border: solid 1px #1b00b3;\n    box-sizing: border-box;\n    /* background-color: #85a2c5; */\n    background: linear-gradient(to bottom, #8a98a7, #a3bbd2, #8a98a7);\n    border-radius: 4px;\n    text-align: center;\n"]))),Bm=d.b.div(rv||(rv=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 30px;\n    user-select: text;\n    /* font-weight: 600; */\n    color: #ffffff;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #808080;\n    text-align: left;\n"]))),Pm=(d.b.input(sv||(sv=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 170px);\n    margin-left: 10px;\n    font-size: 24px;\n    line-height: 24px;\n    /* font-weight: 600; */\n    color: #1a1a1a;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #e9e9e9;\n    text-align: left;\n"]))),d.b.div(lv||(lv=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    background-color: #888888;\n    box-sizing: border-box;\n    text-align: left;\n"]))),d.b.div(dv||(dv=Object(s.a)(["\n    ","\n    /* width: 160px; */\n    padding: 0 40px;\n    /* line-height: 25px; */\n    box-sizing: border-box;\n    background-color: #a8a8a8;\n    background: linear-gradient(to bottom, #787878, #b4b4b4, #787878);\n    border: 1px solid #1a2b3f;\n    color: #1a2b3f;\n    border-radius: 4px;\n    margin: 5px 0 0 4px;\n    ","\n    &:hover {\n        /* background-color: #98bfc2; */\n    background: linear-gradient(to bottom, #989898, #b4b4b4, #989898);\n    }\n"])),Ke,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}))),Km=function(){var e=Object(o.useContext)(gS),n=e.store;e.dispatcher;return Object(se.jsx)(Um,{children:Object(se.jsx)(le,{tabElements:[{name:"Info",disable:!1,cont:Object(se.jsx)(Tm,{})},{name:"View",disable:!1,cont:Object(se.jsx)(Wv,{})}],activeNo:n.systemState.scoreTabIndex})})},Um=d.b.div(bv||(bv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin: ","px 0 0 ","px;\n    width: calc(100% - ","px);\n    height: calc(100% - ","px);\n    background-color: transparent;\n    /* background-color: #c3d8dd6f; */\n    /* border: solid 1px black;\n    border-radius: 5px; */\n    /* box-shadow: 0 2px 14px 4px #000b3a48; */\n"])),8,8,16,16),Vm=t(40),qm=t(14);(Sv=yv||(yv={})).createNode=function(e,n){return n.isOpen=!0,{data:e,parent:n,depth:n.depth+1,isOpen:!1,children:[]}},Sv.getChildIndex=function(e){var n=e.parent;if(null!=n)for(var t=0;t<n.children.length;t++)if(e==n.children[t])return t;return-1},Sv.Frame=function(e){var n,t,i=null!==(n=e.isDisable)&&void 0!==n&&n,c=null!==(t=e.focusNode)&&void 0!==t?t:null,a=function(){return function e(n,t,i){var o={data:t.data,depth:n,isOpen:!1,children:[],parent:i};return o.children=t.children.map((function(t){return e(n+1,t,o)})),o}(0,e.rootDataNode,null)},r=Object(o.useState)(a()),s=Object(l.a)(r,2),d=s[0],b=s[1];Object(o.useEffect)((function(){b(a())}),[e.rootDataNode]);var u=Object(o.useMemo)((function(){console.log(d);var n=[];return function t(o,a){var r=o.data==(null===c||void 0===c?void 0:c.data);n.push(Object(se.jsxs)(lO,{isActive:i&&r||!i&&function(){for(var e=!1,n=c;null!=n;){if(null==o.parent||o==n){e=!0;break}n=n.parent}return e}(),isDisable:r&&i,children:[a.map((function(e,n){var t=[];return(a.length-1===n||e)&&t.push(e?Object(se.jsx)(uO,{},t.length):Object(se.jsx)(bO,{},t.length)),a.length-1===n&&t.push(Object(se.jsx)(hO,{},t.length)),Object(se.jsx)(dO,{children:t},n)})),0===o.children.length?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(pO,{onClick:function(){o.isOpen=!o.isOpen,b(Object(h.a)({},d))},children:o.isOpen?"-":"+"}),Object(se.jsx)(xO,{onClick:function(){e.clickEvent(o),b(Object(h.a)({},d))},onDoubleClick:function(){o.isOpen=!o.isOpen,b(Object(h.a)({},d))},children:e.getLabelJsx(o)})]},n.length)),o.isOpen&&o.children.forEach((function(e,n){t(e,a.slice().concat(o.children.length-1!==n))}))}(d,[]),n}),[d,e.invalidate,i]);return Object(se.jsx)(sO,{isDisable:i,children:u})};var Hm,Jm,Wm,Ym,Gm,Qm,Xm,Zm,$m,eO,nO,tO,iO,oO,cO,aO,rO=yv,sO=d.b.div(uv||(uv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #cecece;\n    width: calc(100% - 10px);\n    height: calc(100% - 10px);\n    box-sizing: border-box;\n    border: solid 1px #000;\n    margin: 5px;\n    overflow: auto;\n    ","\n"])),(function(e){return e.isDisable?Object(d.a)(hv||(hv=Object(s.a)(["\n        pointer-events: none;\n        background-color: #a58c8c;\n    "]))):""})),lO=d.b.div(pv||(pv=Object(s.a)(["\n    display: block;\n    /* position: relative; */\n    background-color: #ffffff47;\n    ","\n    ","\n    /* width: calc(100% - 10px); */\n    height: 40px;\n    box-sizing: border-box;\n    white-space: nowrap;\n    /* border: solid 1px #000;\n    margin: 5px; */\n    & *{\n        vertical-align: top;\n    }\n    &:hover {\n        opacity: 1;\n    }\n"])),(function(e){return e.isDisable?Object(d.a)(xv||(xv=Object(s.a)(["\n        background-color: #ff454546;\n    "]))):""}),(function(e){return e.isActive?"":Object(d.a)(fv||(fv=Object(s.a)(["\n        background-color: transparent;\n        opacity: 0.5;\n    "])))})),dO=d.b.div(gv||(gv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    /* background-color: #b6d5be; */\n    width: 40px;\n    height: 100%;\n    box-sizing: border-box;\n    /* border: solid 1px #000; */\n"]))),bO=d.b.div(jv||(jv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #b60000;\n    width: 4px;\n    height: 22px;\n    box-sizing: border-box;\n    margin: 0 0 0 20px;\n"]))),uO=d.b.div(vv||(vv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #b60000;\n    width: 4px;\n    height: 100%;\n    box-sizing: border-box;\n    margin: 0 0 0 20px;\n"]))),hO=d.b.div(mv||(mv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #b60000;\n    width: 16px;\n    height: 4px;\n    box-sizing: border-box;\n    margin: 18px 0 0 0;\n"]))),pO=d.b.div(Ov||(Ov=Object(s.a)(["\n    display: inline-block;\n    /* position: relative; */\n    background-color: #d1d1d1;\n    width: 30px;\n    height: calc(100% - 10px);\n    border: solid 1px #000;\n    margin: 5px 0 0 3px;\n    box-sizing: border-box;\n    font-size: 30px;\n    /* font-weight: 600; */\n    color: #6d1717;\n    line-height: 20px;\n    padding-left: 3px;\n"]))),xO=d.b.div(kv||(kv=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    /* background-color: #ffffff3c; */\n    min-width: 100px;\n    height: 100%;\n    margin: 0 0  0 3px;\n    box-sizing: border-box;\n"])));(aO=cO||(cO={})).InputTextForm=function(e){var n;return Object(se.jsxs)(HO,{isEnable:null===(n=e.isEnable)||void 0===n||n,children:[Object(se.jsx)(JO,{children:e.titleLabel}),Object(se.jsx)(WO,{type:"text",value:e.value,onChange:function(n){e.setValue(n.target.value)}})]})},aO.createBlankCatList=function(e){return[{value:"",labelText:""}].concat(e)},aO.InputComboboxForm=function(e){var n;return Object(se.jsxs)(HO,{isEnable:null===(n=e.isEnable)||void 0===n||n,children:[Object(se.jsx)(JO,{children:e.titleLabel}),Object(se.jsx)(YO,{value:e.value,onChange:function(n){e.setValue(n.target.value)},children:e.list.map((function(e,n){return Object(se.jsx)("option",{value:e.value,children:e.labelText},n)}))})]})},aO.LabelTextItem=function(e){return Object(se.jsxs)(HO,{isEnable:!0,children:[Object(se.jsx)(JO,{children:e.titleLabel}),Object(se.jsx)(WO,{readOnly:!0,type:"text",value:e.value})]})},aO.TextAreaView=function(e){var n,t=null!==(n=e.height)&&void 0!==n?n:150;return Object(se.jsx)(ZO,{readOnly:!0,value:e.value,height:t})},aO.BorderPanel=function(e){var n;return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(QO,{children:e.title}),Object(se.jsx)(XO,{isEnable:null===(n=e.isEnable)||void 0===n||n,children:e.innerJsx})]})},aO.ButtonDiv=function(e){return Object(se.jsx)(HO,{isEnable:!0,children:e.buttons.map((function(e,n){var t;return Object(se.jsx)(GO,{isEnable:null===(t=e.isEnable)||void 0===t||t,onClick:e.callback,children:e.name},n)}))})},aO.ListManager=function(e){return Object(se.jsx)($O,{height:e.height,children:e.records.map((function(e,n){var t=e.buttons.map((function(e){return e.width})).reduce((function(e,n){return e+n+2})),i=e.buttons.map((function(e,n){var t;return Object(se.jsx)(tk,{width:e.width,isEnable:null===(t=e.isEnable)||void 0===t||t,onClick:e.callback,children:e.label},n)}));return Object(se.jsxs)(ek,{children:[Object(se.jsx)(nk,{dim:t+2,children:e.label}),i]},n)}))})};var fO,gO,jO,vO,mO,OO,kO,yO,SO,wO,LO,IO,AO,EO,CO,TO,MO,DO,NO,FO,_O,zO,RO,BO,PO,KO,UO,VO,qO=cO,HO=d.b.div(Hm||(Hm=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    /* background-color: #b3b4c4; */\n    ","\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),JO=d.b.div(Jm||(Jm=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: 140px;\n    font-size: 24px;\n    line-height: 28px;\n    font-weight: 600;\n    color: #08106e;\n    border: solid 1px #1b00b3;\n    box-sizing: border-box;\n    /* background-color: #85a2c5; */\n    background: linear-gradient(to bottom, #8a98a7, #a3bbd2, #8a98a7);\n    border-radius: 4px;\n    text-align: center;\n    vertical-align: top;\n    margin-left: 4px;\n    margin-top: 2px;\n"]))),WO=d.b.input(Wm||(Wm=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 150px);\n    margin-top: 2px;\n    margin-left: 4px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #1f1f1f;\n    border: solid 1px #000;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n    ","\n"])),(function(e){return e.readOnly?Object(d.a)(Ym||(Ym=Object(s.a)(["\n        color: #020075;\n        border: none;\n        outline: none;\n        background-color: transparent;\n    "]))):""})),YO=d.b.select(Gm||(Gm=Object(s.a)(["\n    display: inline-block;\n    height: calc(100% - 4px);\n    width: calc(100% - 150px);\n    margin-top: 2px;\n    margin-left: 4px;\n    font-size: 24px;\n    line-height: 32px;\n    /* font-weight: 600; */\n    color: #1f1f1f;\n    border: solid 1px #000;\n    padding: 0 5px;\n    box-sizing: border-box;\n    background-color: #dbdbdb;\n    text-align: left;\n    vertical-align: top;\n    user-select: text;\n"]))),GO=(d.b.div(Qm||(Qm=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 40px;\n    /* background-color: #888888; */\n    box-sizing: border-box;\n    text-align: left;\n    white-space: nowrap;\n"]))),d.b.div(Xm||(Xm=Object(s.a)(["\n    ","\n    /* width: 160px; */\n    padding: 0 40px;\n    /* line-height: 25px; */\n    box-sizing: border-box;\n    background-color: #a8a8a8;\n    background: linear-gradient(to bottom, #787878, #b4b4b4, #787878);\n    border: 1px solid #1a2b3f;\n    color: #1a2b3f;\n    border-radius: 4px;\n    margin-left: 4px;\n    margin-top: 2px;\n    margin: 5px 0 0 4px;\n    ","\n    &:hover {\n        /* background-color: #98bfc2; */\n    background: linear-gradient(to bottom, #989898, #b4b4b4, #989898);\n    }\n"])),Ke,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE}))),QO=d.b.div(Zm||(Zm=Object(s.a)(["\n    ","\n    color: #990000;\n    /* background-color: #0a0a0a40; */\n    font-style: italic;\n    margin: 4px 0 0 8px;\n"])),Pe),XO=d.b.div($m||($m=Object(s.a)(["\n    display: inline-block;\n    margin: 0 0 0 6px;\n    padding: 4px;\n    width: calc(100% - 12px);\n    background-color: #d4d6bc;\n    border: 1px solid #000;\n    box-sizing: border-box;\n    border-radius: 4px;\n    text-align: left;\n    ","\n"])),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),ZO=d.b.textarea(eO||(eO=Object(s.a)(["\n    display: inline-block;\n    font-size: ","px;\n    color: #0a0038;\n    background-color: #b7bcd3;\n    resize: none;\n    width: calc(100% - 8px);\n    height: ","px;\n    box-sizing: border-box;\n    margin: 0 0 0 4px;\n    outline: none;\n"])),Be.FONT_SMALL,(function(e){return e.height})),$O=d.b.div(nO||(nO=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - 8px);\n    height: ","px;\n    margin: 4px 0 0 4px;\n    border: solid 2px #850000;\n    background-color: #bcbcbc;\n    box-sizing: border-box;\n    padding: 0 0 2px 0;\n    overflow-y: auto;\n"])),(function(e){return e.height})),ek=d.b.div(tO||(tO=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 30px;\n    ",";\n    margin: 2px 0 0 0;\n    background-color: #fff7dc;\n    text-align: left;\n    box-sizing: border-box;\n    padding-left: 4px;\n"])),Be.CSS_LABEL_SMALL),nk=d.b.div(iO||(iO=Object(s.a)(["\n    display: inline-block;\n    width: calc(100% - ","px);\n    height: 100%;\n    color: #9c1e1e;\n    text-align: left;\n"])),(function(e){return e.dim})),tk=d.b.div(oO||(oO=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: 100%;\n    color: #110549;\n    text-align: center;\n    background-color: #93bec3;\n    border-radius: 4px;\n    border: solid 1px #274154;\n    box-sizing: border-box;\n    margin: 0 1px;\n    ","\n    &:hover {\n        background-color: #b7d6d9;\n    }\n"])),(function(e){return e.width}),(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),ik=function(e){var n=Object(o.useContext)($k),t=n.node,i=n.invalidate,c=n.setFocusNode,a=n.setTreeDisable,r=t.parent,s=Object(o.useState)(""),d=Object(l.a)(s,2),b=d[0],u=d[1],h=Object(o.useState)([]),p=Object(l.a)(h,2),x=p[0],f=p[1],g=Object(o.useState)([]),j=Object(l.a)(g,2),m=j[0],O=j[1];Object(o.useEffect)((function(){if(null==t.data)u(""),f([]);else{var e=t.data;u(e.attr),f(e.symbols.slice())}}),[t]),Object(o.useEffect)((function(){var e=[];""!==b&&0!==x.length||e.push("target is none."),O(e)}),[b,x]);var k=""===b?[]:v.getSymbolsFromAttr(b);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"attribute",value:b,setValue:function(e){u(e),f([])},list:qO.createBlankCatList(v.SymbolAttributeList.map((function(e){return{value:e,labelText:e}})))}),Object(se.jsx)(ok,{children:k.map((function(e,n){return Object(se.jsxs)(ck,{isActive:x.includes(e.key),onClick:function(){x.includes(e.key)?x.splice(x.indexOf(e.key),1):x.push(e.key),f(x.slice())},children:[Object(se.jsx)(ak,{children:e.key})," [",e.name,"]"]},n)}))}),Object(se.jsx)(qO.BorderPanel,{title:"selft element",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.TextAreaView,{value:m.join("\n"),height:50}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:0===m.length,callback:function(){if(null==t.data){var n={attr:b,symbols:x.slice(),roots:[]};if(t.data=n,e.isPattern)r.data.attrs.push(n);else r.data.defs.push(n);a(!1)}else{var o=t.data;o.attr=b,o.symbols=x,i()}}},{name:"Del",isEnable:!0,callback:function(){c(r);var n=rO.getChildIndex(t);(r.children.splice(n,1),e.isPattern)?r.data.attrs.splice(n,1):r.data.defs.splice(n,1);a(!1),i()}}]})]})}),Object(se.jsx)(qO.BorderPanel,{title:"children element",isEnable:null!=t.data,innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"Child",value:"Root Element"}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:!0,callback:function(){var e=rO.createNode(null,t);t.children.push(e),c(e),a(!0)}},{name:"Del",isEnable:!0,callback:function(){var e=t.data;t.children=[],e.roots=[],i()}}]})]})})]})},ok=d.b.div(fO||(fO=Object(s.a)(["\n    display: inline-block;\n    background-color: #e3ecee;\n    width: calc(100% - 8px);\n    min-height: 50px;\n    margin: 4px 0 0 4px;\n    box-sizing: border-box;\n    border: 1px solid #26242c;\n    padding: 0 4px 4px 0;\n"]))),ck=d.b.div(gO||(gO=Object(s.a)(["\n    display: inline-block;\n    background-color: #a2bcc2;\n    ","\n    ","\n    color: #4f59b3;\n    padding: 0 10px;\n    margin: 4px 0 0 4px;\n    box-sizing: border-box;\n    border: 1px solid #697ab3;\n    border-radius: 5px;\n    &:hover {\n        background-color: #c2d5da;\n        ","\n    }\n"])),(function(e){return e.isActive?Object(d.a)(jO||(jO=Object(s.a)(["\n        background-color: #dee058;\n    "]))):""}),Be.CSS_LABEL_SMALL,(function(e){return e.isActive?Object(d.a)(vO||(vO=Object(s.a)(["\n            background-color:#c2c461;\n        "]))):""})),ak=d.b.span(mO||(mO=Object(s.a)(["\n    color: #d65d5d;\n"]))),rk=function(e){var n=Object(o.useContext)($k),t=n.node,i=n.invalidate,c=n.setThamaData,a=t.data,r=Object(o.useState)(a.themaName),s=Object(l.a)(r,2),d=s[0],b=s[1],h=Object(o.useState)([]),x=Object(l.a)(h,2),f=x[0],g=x[1];return Object(o.useEffect)((function(){var e=[];""===d&&e.push("name is empty."),g(e)}),[d]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Export",isEnable:!0,callback:function(){window.showSaveFilePicker({types:[{accept:{"text/plain":[".lcrt"]}}]}).then((function(e){Object(p.a)(u.a.mark((function n(){var t,i;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.createWritable();case 2:return t=n.sent,i=re.a.gZip(JSON.stringify(a)),n.next=6,t.write(i);case 6:return n.next=8,t.close();case 8:case"end":return n.stop()}}),n)})))()})).catch((function(){console.log("\u30ad\u30e3\u30f3\u30bb\u30eb\u3055\u308c\u307e\u3057\u305f")}))}},{name:"Import",isEnable:!0,callback:function(){Object(p.a)(u.a.mark((function e(){var n,o,a,r,s,d,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.showOpenFilePicker();case 2:return n=e.sent,o=Object(l.a)(n,1),a=o[0],e.next=7,a.getFile();case 7:return r=e.sent,e.next=10,r.text();case 10:s=e.sent,d=re.a.unZip(s),b=JSON.parse(d),c(b),t.data=b,console.log(JSON.stringify(t.data)),i();case 17:case"end":return e.stop()}}),e)})))()}}]}),Object(se.jsx)(qO.InputTextForm,{titleLabel:"name",value:d,setValue:function(e){b(e)}}),Object(se.jsx)(qO.BorderPanel,{title:"selft operatioon",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.TextAreaView,{value:f.join("\n"),height:50}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:0===f.length,callback:function(){a.themaName=d,i()}}]})]})}),Object(se.jsx)(qO.BorderPanel,{title:"install",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Install",isEnable:!e.themaList.map((function(e){return e.themaName})).includes(a.themaName),callback:function(){e.addThema(a)}}]}),Object(se.jsx)(qO.ListManager,{height:140,records:e.themaList.map((function(n,t){return{label:n.themaName,buttons:[{label:"\u2193",width:30,isEnable:t<e.themaList.length-1,callback:function(){var n=e.themaList[t];e.themaList[t]=e.themaList[t+1],e.themaList[t+1]=n,i()}},{label:"\u2191",width:30,isEnable:t>0,callback:function(){var n=e.themaList[t];e.themaList[t]=e.themaList[t-1],e.themaList[t-1]=n,i()}},{label:"Load",width:50,isEnable:!1,callback:function(){}},{label:"Delete",width:60,callback:function(){e.themaList.splice(t,1),i()}}]}}))})]})})]})},sk=function(e){var n,t=Object(o.useContext)($k),i=t.node,c=t.setFocusNode,a=t.invalidate,r=t.setTreeDisable,s=i.data,d=Object(o.useState)(""),b=Object(l.a)(d,2),u=b[0],h=b[1],p=Object(o.useState)([]),x=Object(l.a)(p,2),f=x[0],g=x[1],j=Object(o.useState)(-1),v=Object(l.a)(j,2),m=v[0],O=v[1],k=i==(null===(n=i.parent)||void 0===n?void 0:n.children[0]);return Object(o.useEffect)((function(){g(s.prenams.slice()),O(0===s.prenams.length?0:s.prenams.map((function(e){return e.seq})).reduce((function(e,n){return e<n?n:e}),-1)+1)}),[i]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"Method",value:k?"Sustain":"Pattern"}),Object(se.jsx)(qO.BorderPanel,{title:"preset define",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputTextForm,{titleLabel:"Preset",value:u,setValue:function(e){h(e)}}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:""!==u&&!f.map((function(e){return e.name})).includes(u),callback:function(){f.push({name:u,seq:m}),g(f.slice()),h(""),O(m+1)}}]}),Object(se.jsx)(qO.ListManager,{height:140,records:f.map((function(e,n){return{label:"".concat(e.seq,": ").concat(e.name),buttons:[{label:"\u2193",width:30,isEnable:n<f.length-1,callback:function(){var e=f[n];f[n]=f[n+1],f[n+1]=e,g(f.slice())}},{label:"\u2191",width:30,isEnable:n>0,callback:function(){var e=f[n];f[n]=f[n-1],f[n-1]=e,g(f.slice())}},{label:"Delete",width:60,callback:function(){f.splice(n,1),g(f.slice())}}]}}))})]})}),Object(se.jsx)(qO.BorderPanel,{title:"selft operatioon",innerJsx:Object(se.jsx)(se.Fragment,{children:Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:!0,callback:function(){s.prenams=f.slice(),a()}}]})})}),Object(se.jsx)(qO.BorderPanel,{title:"children operatioon",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"Child",value:(k?"Sustain":"Pattern")+" Element"}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:!0,callback:function(){var e=rO.createNode(null,i);i.children.push(e),c(e),r(!0)}},{name:"Del",isEnable:!0,callback:function(){i.children=[],s.defs=[],a()}}]})]})})]})},lk=function(){var e,n,t,i=Object(o.useContext)($k),c=i.node,a=i.invalidate,r=i.setFocusNode,s=i.dispatcher,d=i.setBackingWnd,b=i.setTreeDisable,u=c.parent,h=u.data,p=null===(e=c.parent)||void 0===e?void 0:e.data,x=(null===(n=c.parent)||void 0===n||null===(t=n.parent)||void 0===t||t.data,Object(o.useState)("")),f=Object(l.a)(x,2),g=f[0],j=f[1],m=Object(o.useState)(""),k=Object(l.a)(m,2),y=k[0],S=k[1],w=Object(o.useState)(0),L=Object(l.a)(w,2),I=L[0],A=L[1],E=Object(o.useState)("major"),C=Object(l.a)(E,2),T=C[0],M=C[1],D=Object(o.useState)(""),N=Object(l.a)(D,2),F=N[0],_=N[1],z=Object(o.useState)([]),R=Object(l.a)(z,2),B=R[0],P=R[1];Object(o.useEffect)((function(){if(null==c.data)j(""),S(""),A(0),M("major"),_("");else{var e=c.data;j(e.pattName),S(-1===e.refer?"":e.refer.toString()),A(0),M("major"),_(JSON.stringify(e.source))}}),[c]);var K=Object(o.useMemo)((function(){return null==c.data?h.patts.map((function(e){return e.key})).reduce((function(e,n){return e<n?n:e}),-1)+1:c.data.key}),[c]);Object(o.useEffect)((function(){var e=[];""===g&&e.push("name is empty."),""===F&&e.push("source is empty."),P(e)}),[g,K,y,F]);var U=Object(o.useMemo)((function(){if(null!=c.data){var e=c.data;return void 0!=h.patts.find((function(n){return n.refer===e.key}))}return!1}),[c]),V=Object(o.useMemo)((function(){if(""===F)return[];var e=JSON.parse(F).channelSize;return p.patts.filter((function(n){var t=-1!==n.refer,i=n.source.channelSize===e;return n.key!==K&&i&&!t})).map((function(e){return e.key}))}),[c,F]);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"key",value:K.toString()}),Object(se.jsx)(qO.InputTextForm,{titleLabel:"name",value:g,setValue:function(e){j(e)}}),Object(se.jsx)(qO.BorderPanel,{title:"source",isEnable:!0,innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"root",value:I.toString(),setValue:function(e){A(Number.parseInt(e))},list:v.KEY12_SHARP_LIST.map((function(e,n){return{value:n.toString(),labelText:e}}))}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"symbol",value:T,setValue:function(e){M(e)},list:v.SYMBOL_LIST.map((function(e){return{value:e.key,labelText:"".concat(e.key,": [").concat(e.name,"]")}}))}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Edit",isEnable:!0,callback:function(){var e={pattern:""===F?{channelSize:1,layers:[{divs:[{rate:4,div3:0,isDot:!1}],notesList:[],vels:[5]},{divs:[{rate:4,div3:0,isDot:!1}],notesList:[],vels:[5]}]}:JSON.parse(F),voicingList:[]};s.thema.openBackingEditor(p.beat,p.head,p.tail,T,I,e,(function(e){if(null!=e.pattern){var n=O.buildPatternProps(e.pattern);_(JSON.stringify(n))}}),(function(){d(!1)})),d(!0)}}]}),Object(se.jsx)(qO.TextAreaView,{value:F}),Object(se.jsx)(qO.LabelTextItem,{titleLabel:"channel",value:(""===F?"-":JSON.parse(F).channelSize).toString()})]})}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"depend",value:y,isEnable:!U&&!(null!=c.data&&c.data.attrs.length>=1),setValue:function(e){S(e)},list:[""].concat(V.map((function(e){return e.toString()}))).map((function(e){return{value:e,labelText:e}}))}),Object(se.jsx)(qO.BorderPanel,{title:"selft operatioon",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.TextAreaView,{value:B.join("\n"),height:50}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:0===B.length,callback:function(){if(null==c.data){var e={pattName:g,source:JSON.parse(F),key:K,refer:""===y?-1:Number(y),attrs:[]};c.data=e,h.patts.push(e),b(!1)}else{var n=c.data;n.pattName=g,n.source=JSON.parse(F),n.key=K,n.refer=""===y?-1:Number(y),a()}}},{name:"Del",isEnable:!0,callback:function(){r(u);var e=rO.getChildIndex(c);if(null!=c.data){var n=c.data;h.patts.forEach((function(e){e.refer===n.key&&(e.refer=-1)}))}u.children.splice(e,1),h.patts.splice(e,1),b(!1),a()}}]})]})}),Object(se.jsx)(qO.BorderPanel,{title:"children operatioon",isEnable:null!=c.data&&""===y,innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"Child",value:"Attribute Element"}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:!0,callback:function(){var e=rO.createNode(null,c);c.children.push(e),r(e),b(!0)}},{name:"Del",isEnable:!0,callback:function(){var e=c.data;c.children=[],e.attrs=[],a()}}]})]})})]})},dk=function(){var e=Object(o.useContext)($k),n=e.node,t=e.setFocusNode,i=e.invalidate,c=e.setTreeDisable,a=n.parent,r=a.data,s=Object(o.useState)(""),d=Object(l.a)(s,2),b=d[0],u=d[1],h=Object(o.useState)(""),p=Object(l.a)(h,2),x=p[0],f=p[1],g=Object(o.useState)([]),j=Object(l.a)(g,2),m=j[0],O=j[1];return Object(o.useEffect)((function(){if(null==n.data)u(""),f("");else{var e=n.data;u(e.minIdx.toString()),f(e.maxIdx.toString())}}),[n]),Object(o.useEffect)((function(){var e=[];""===b||""===x?e.push("min or max form is null."):Number(b)>Number(x)&&e.push("min is upper than max."),O(e)}),[b,x]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"minIdx",value:b.toString(),setValue:function(e){u(e)},list:qO.createBlankCatList(v.KEY12_SHARP_LIST.map((function(e,n){return{value:n.toString(),labelText:e}})))}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"maxIdx",value:x.toString(),setValue:function(e){f(e)},list:qO.createBlankCatList(v.KEY12_SHARP_LIST.map((function(e,n){return{value:n.toString(),labelText:e}})))}),Object(se.jsx)(qO.BorderPanel,{title:"selft operatioon",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.TextAreaView,{value:m.join("\n"),height:50}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:0===m.length,callback:function(){if(null==n.data){var e={minIdx:Number(b),maxIdx:Number(x),voics:[]};n.data=e,r.roots.push(e),c(!1)}else{var t=n.data;t.minIdx=Number(b),t.maxIdx=Number(x),i()}}},{name:"Del",isEnable:!0,callback:function(){t(a);var e=rO.getChildIndex(n);a.children.splice(e,1),r.roots.splice(e,1),c(!1),i()}}]})]})}),Object(se.jsx)(qO.BorderPanel,{title:"children operatioon",isEnable:null!=n.data,innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"Child",value:"Voicing Element"}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:!0,callback:function(){var e=rO.createNode(null,n);n.children.push(e),t(e),c(!0)}},{name:"Del",isEnable:!0,callback:function(){var e=n.data;n.children=[],e.voics=[],i()}}]})]})})]})},bk=function(e){var n=Object(o.useContext)($k),t=n.node,i=n.invalidate,c=n.setFocusNode,a=n.setTreeDisable,r=t.data,s=t.parent,d=s.data,b=Object(o.useState)(""),u=Object(l.a)(b,2),h=u[0],p=u[1],x=Object(o.useState)(""),f=Object(l.a)(x,2),g=f[0],j=f[1],v=Object(o.useState)(""),m=Object(l.a)(v,2),O=m[0],k=m[1],y=Object(o.useState)([]),S=Object(l.a)(y,2),w=S[0],L=S[1];return Object(o.useEffect)((function(){if(null==t.data)p(""),j("0"),k("0");else{var e=t.data;p(e.beat.toString()),j(e.head.toString()),k(e.tail.toString())}}),[t]),Object(o.useEffect)((function(){var e=[];""===h&&e.push("beat is empty."),""===g&&e.push("head is empty."),""===O&&e.push("tail is empty."),L(e)}),[h,g,O]),Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"beat",value:h.toString(),list:["",1,2,3,4].map((function(e){return{value:e.toString(),labelText:e.toString()}})),setValue:function(e){p(e)}}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"head",value:g.toString(),list:["",-2,-1,0,1,2].map((function(e){return{value:e.toString(),labelText:e.toString()}})),setValue:function(e){j(e)}}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"tail",value:O.toString(),list:["",-2,-1,0,1,2].map((function(e){return{value:e.toString(),labelText:e.toString()}})),setValue:function(e){k(e)}}),Object(se.jsx)(qO.BorderPanel,{title:"selft element",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.TextAreaView,{value:w.join("\n"),height:50}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:0===w.length,callback:function(){if(null==t.data){var e={beat:Number(h),head:Number(g),tail:Number(O),patts:[]};t.data=e,d.defs.push(e),a(!1)}else{var n=t.data;n.beat=Number(h),n.head=Number(g),n.tail=Number(O),i()}i()}},{name:"Del",isEnable:!0,callback:function(){c(s);var e=rO.getChildIndex(t);s.children.splice(e,1),d.defs.splice(e,1),a(!1),i()}}]})]})}),Object(se.jsx)(qO.BorderPanel,{title:"children element",isEnable:null!=t.data,innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.LabelTextItem,{titleLabel:"Child",value:"Pattern Element"}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:!0,callback:function(){var e=rO.createNode(null,t);t.children.push(e),c(e),a(!0)}},{name:"Del",isEnable:!0,callback:function(){t.children=[],r.patts=[],i()}}]})]})})]})},uk=function(e){var n,t,i,c,a,r,s,d,b,u,h,p,x,f,g,j,m,k,y=Object(o.useContext)($k),S=y.node,w=y.invalidate,L=y.dispatcher,I=y.setBackingWnd,A=y.setFocusNode,E=y.setTreeDisable,C=e.isPattern?null===(c=S.parent)||void 0===c||null===(a=c.parent)||void 0===a||null===(r=a.parent)||void 0===r||null===(s=r.parent)||void 0===s||null===(d=s.parent)||void 0===d?void 0:d.data:null===(n=S.parent)||void 0===n||null===(t=n.parent)||void 0===t||null===(i=t.parent)||void 0===i?void 0:i.data,T=e.isPattern?null===(b=S.parent)||void 0===b||null===(u=b.parent)||void 0===u||null===(h=u.parent)||void 0===h||null===(p=h.parent)||void 0===p?void 0:p.data:null,M=e.isPattern?null===(x=S.parent)||void 0===x||null===(f=x.parent)||void 0===f||null===(g=f.parent)||void 0===g?void 0:g.data:null,D=null===(j=S.parent)||void 0===j||null===(m=j.parent)||void 0===m?void 0:m.data,N=null===(k=S.parent)||void 0===k?void 0:k.data,F=Object(o.useState)(0),_=Object(l.a)(F,2),z=_[0],R=_[1],B=Object(o.useState)("major"),P=Object(l.a)(B,2),K=P[0],U=P[1],V=Object(o.useState)(""),q=Object(l.a)(V,2),H=q[0],J=q[1],W=Object(o.useState)(""),Y=Object(l.a)(W,2),G=Y[0],Q=Y[1],X=Object(o.useState)(""),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],ne=Object(o.useState)([]),te=Object(l.a)(ne,2),ie=te[0],oe=te[1],ce=Object(o.useState)([]),ae=Object(l.a)(ce,2),re=ae[0],le=ae[1],de=Object(o.useMemo)((function(){return v.SYMBOL_LIST.filter((function(e){return D.symbols.includes(e.key)}))}),[]);Object(o.useEffect)((function(){if(null==S.data)R(N.minIdx),U(de[0].key),J(""),Q(""),ee(""),oe([]);else{var e=S.data;R(N.minIdx),U(de[0].key),J(JSON.stringify(e.source)),Q(""),ee(""),oe(e.preUsies.slice())}}),[S]);var be=Object(o.useMemo)((function(){if(null==T||null==M)return null;var e=M.key;return T.patts.filter((function(n){return n.key!==e&&n.refer===e}))}),[S]);Object(o.useEffect)((function(){var e=[];""===H&&e.push("source is null."),le(e)}),[H]);var ue=function(e){var n=O.getVoicingListFromTable(e.voicingTable);J(JSON.stringify(n)),I(!1)},he=function(){I(!1)};return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.BorderPanel,{title:"source",isEnable:!0,innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"root",value:z.toString(),setValue:function(e){R(Number.parseInt(e))},list:v.KEY12_SHARP_LIST.filter((function(e,n){return n>=N.minIdx&&n<=N.maxIdx})).map((function(e,n){return{value:(n+N.minIdx).toString(),labelText:e}}))}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"symbol",value:K,setValue:function(e){U(e)},list:de.map((function(e){return{value:e.key,labelText:"".concat(e.key,": [").concat(e.name,"]")}}))}),Object(se.jsx)(qO.LabelTextItem,{titleLabel:"channel",value:null==M?"-":M.source.channelSize.toString()}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Edit",isEnable:!0,callback:function(){var e=JSON.parse(""!==H?H:"[]");if(null==M||null==T){var n={pattern:null,voicingList:e};L.thema.openBackingEditor(4,0,0,K,z,n,ue,he)}else{var t={pattern:M.source,voicingList:e};L.thema.openBackingEditor(T.beat,T.head,T.tail,K,z,t,ue,he)}I(!0)}}]}),Object(se.jsx)(qO.TextAreaView,{value:H})]})}),Object(se.jsx)(qO.BorderPanel,{title:"preset use",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"Depend",isEnable:null!=M,value:G,setValue:function(e){Q(e)},list:[{value:"",labelText:""}].concat((null!==be&&void 0!==be?be:[]).map((function(e){return{labelText:"".concat(e.key,": ").concat(e.pattName),value:e.key.toString()}})))}),Object(se.jsx)(qO.InputComboboxForm,{titleLabel:"Preset",value:$,setValue:function(e){ee(e)},list:[{value:"",labelText:""}].concat(C.prenams.filter((function(e){return!ie.map((function(e){return e.presKey})).includes(e.seq)})).map((function(e){return{labelText:"".concat(e.seq,": ").concat(e.name),value:e.seq.toString()}})))}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Add",isEnable:""!==$,callback:function(){ie.push({depPatt:""===G?-1:Number(G),presKey:Number($)}),oe(ie.slice()),Q(""),ee("")}}]}),Object(se.jsx)(qO.ListManager,{height:100,records:ie.map((function(e,n){return{label:"".concat(-1===e.depPatt?"":e.depPatt+"@","[").concat((t=e.presKey,C.prenams.find((function(e){return e.seq===t})).name),"]"),buttons:[{label:"\u2193",width:30,isEnable:n<ie.length-1,callback:function(){var e=ie[n];ie[n]=ie[n+1],ie[n+1]=e,oe(ie.slice())}},{label:"\u2191",width:30,isEnable:n>0,callback:function(){var e=ie[n];ie[n]=ie[n-1],ie[n-1]=e,oe(ie.slice())}},{label:"Delete",width:60,callback:function(){ie.splice(n,1),oe(ie.slice())}}]};var t}))})]})}),Object(se.jsx)(qO.BorderPanel,{title:"selft element",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qO.TextAreaView,{value:re.join("\n"),height:50}),Object(se.jsx)(qO.ButtonDiv,{buttons:[{name:"Update",isEnable:0===re.length,callback:function(){if(null==S.data){var e={source:JSON.parse(H),preUsies:ie.slice()};S.data=e,N.voics.push(e),E(!1)}else{var n=S.data;n.source=JSON.parse(H),n.preUsies=ie.slice(),w()}}},{name:"Del",isEnable:!0,callback:function(){var e=S.parent,n=e.data;A(e);var t=rO.getChildIndex(S);e.children.splice(t,1),n.voics.splice(t,1),E(!1),w()}}]})]})})]})},hk=function(e){var n=Object(o.useMemo)((function(){if(null==e.cur)return Object(se.jsx)(se.Fragment,{});var n=[],t=function(e,t){n.push(Object(se.jsx)("span",{children:" > "},n.length)),e?n.push(Object(se.jsx)(fk,{children:"Create..."},n.length)):t()},i=function(e){n.push(Object(se.jsxs)(gk,{children:["[",e.themaName,"]"]},n.length))},o=function(e){t(null==e,(function(){n.push(Object(se.jsxs)(jk,{children:["[",e.method,"]"]},n.length))}))},c=function(e){t(null==e,(function(){n.push(Object(se.jsxs)(vk,{children:["[",e.beat,"* (",e.head,",",e.tail,")]"]},n.length))}))},a=function(e){t(null==e,(function(){n.push(Object(se.jsxs)(mk,{children:[e.key,": [",e.pattName," channel: ",e.source.channelSize,"]"]},n.length))}))},r=function(e){t(null==e,(function(){var t=e.symbols.map((function(e){var n;return"[".concat(null===(n=v.getSymbolFromKey(e))||void 0===n?void 0:n.name,"]")}));n.push(Object(se.jsxs)(Ok,{children:["@",e.attr,": ",t.join(", ")]},n.length))}))},s=function(e){t(null==e,(function(){var t=v.KEY12_SHARP_LIST;n.push(Object(se.jsxs)(kk,{children:["[",t[e.minIdx],"\uff5e",t[e.maxIdx],"]"]},n.length))}))},l=function(e){t(null==e,(function(){n.push(Object(se.jsxs)(yk,{children:["[",e.source.map((function(e){return"".concat(e.octave,"-").concat(e.struct)})).join(", "),"]"]},n.length))}))};switch(e.cur.depth){case 0:i(e.cur.data);break;case 1:var d;i(null===(d=e.cur.parent)||void 0===d?void 0:d.data),o(e.cur.data);break;case 2:var b,u,h;i(null===(b=e.cur.parent)||void 0===b||null===(u=b.parent)||void 0===u?void 0:u.data);var p=null===(h=e.cur.parent)||void 0===h?void 0:h.data;switch(o(p),p.method){case"sustain":r(e.cur.data);break;case"pattern":c(e.cur.data)}break;case 3:var x,f,g,j,m;i(null===(x=e.cur.parent)||void 0===x||null===(f=x.parent)||void 0===f||null===(g=f.parent)||void 0===g?void 0:g.data);var O=null===(j=e.cur.parent)||void 0===j||null===(m=j.parent)||void 0===m?void 0:m.data;switch(o(O),O.method){case"sustain":var k;r(null===(k=e.cur.parent)||void 0===k?void 0:k.data),s(e.cur.data);break;case"pattern":var y;c(null===(y=e.cur.parent)||void 0===y?void 0:y.data),a(e.cur.data)}break;case 4:var S,w,L,I,A,E,C;i(null===(S=e.cur.parent)||void 0===S||null===(w=S.parent)||void 0===w||null===(L=w.parent)||void 0===L||null===(I=L.parent)||void 0===I?void 0:I.data);var T=null===(A=e.cur.parent)||void 0===A||null===(E=A.parent)||void 0===E||null===(C=E.parent)||void 0===C?void 0:C.data;switch(o(T),T.method){case"sustain":var M,D,N;r(null===(M=e.cur.parent)||void 0===M||null===(D=M.parent)||void 0===D?void 0:D.data),s(null===(N=e.cur.parent)||void 0===N?void 0:N.data),l(e.cur.data);break;case"pattern":var F,_,z;c(null===(F=e.cur.parent)||void 0===F||null===(_=F.parent)||void 0===_?void 0:_.data),a(null===(z=e.cur.parent)||void 0===z?void 0:z.data),r(e.cur.data)}break;case 5:var R,B,P,K,U,V,q,H,J;i(null===(R=e.cur.parent)||void 0===R||null===(B=R.parent)||void 0===B||null===(P=B.parent)||void 0===P||null===(K=P.parent)||void 0===K||null===(U=K.parent)||void 0===U?void 0:U.data);var W=null===(V=e.cur.parent)||void 0===V||null===(q=V.parent)||void 0===q||null===(H=q.parent)||void 0===H||null===(J=H.parent)||void 0===J?void 0:J.data;switch(o(W),W.method){case"sustain":break;case"pattern":var Y,G,Q,X,Z,$;c(null===(Y=e.cur.parent)||void 0===Y||null===(G=Y.parent)||void 0===G||null===(Q=G.parent)||void 0===Q?void 0:Q.data),a(null===(X=e.cur.parent)||void 0===X||null===(Z=X.parent)||void 0===Z?void 0:Z.data),r(null===($=e.cur.parent)||void 0===$?void 0:$.data),s(e.cur.data)}break;case 6:var ee,ne,te,ie,oe,ce,ae,re,le,de,be;i(null===(ee=e.cur.parent)||void 0===ee||null===(ne=ee.parent)||void 0===ne||null===(te=ne.parent)||void 0===te||null===(ie=te.parent)||void 0===ie||null===(oe=ie.parent)||void 0===oe||null===(ce=oe.parent)||void 0===ce?void 0:ce.data);var ue=null===(ae=e.cur.parent)||void 0===ae||null===(re=ae.parent)||void 0===re||null===(le=re.parent)||void 0===le||null===(de=le.parent)||void 0===de||null===(be=de.parent)||void 0===be?void 0:be.data;switch(o(ue),ue.method){case"sustain":break;case"pattern":var he,pe,xe,fe,ge,je,ve,me,Oe,ke;c(null===(he=e.cur.parent)||void 0===he||null===(pe=he.parent)||void 0===pe||null===(xe=pe.parent)||void 0===xe||null===(fe=xe.parent)||void 0===fe?void 0:fe.data),a(null===(ge=e.cur.parent)||void 0===ge||null===(je=ge.parent)||void 0===je||null===(ve=je.parent)||void 0===ve?void 0:ve.data),r(null===(me=e.cur.parent)||void 0===me||null===(Oe=me.parent)||void 0===Oe?void 0:Oe.data),s(null===(ke=e.cur.parent)||void 0===ke?void 0:ke.data),l(e.cur.data)}}return n}),[e.cur]);return Object(se.jsx)(pk,{children:Object(se.jsx)(xk,{children:n})})},pk=d.b.div(OO||(OO=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #eeeeee3b;\n    border: 1px solid #402cad;\n    width: calc(100% - 8px);\n    height: calc(100% - 8px);\n    margin: 4px 0 0 4px;\n    box-sizing: border-box;\n    overflow: hidden;\n    /* text-align: right; */\n"]))),xk=d.b.div(kO||(kO=Object(s.a)(["\n    ","\n    margin: 0 0 0 4px;\n    color: #0000005a;\n    font-weight: 400;\n"])),Be.CSS_LABEL_MIDIUM),fk=d.b.span(yO||(yO=Object(s.a)(["\n    color: #e69d00;\n"]))),gk=d.b.span(SO||(SO=Object(s.a)(["\n    color: #0c6900;\n"]))),jk=d.b.span(wO||(wO=Object(s.a)(["\n    color: #23237e;\n"]))),vk=d.b.span(LO||(LO=Object(s.a)(["\n    color: #7e5723;\n"]))),mk=d.b.span(IO||(IO=Object(s.a)(["\n    color: #7e7223;\n"]))),Ok=d.b.span(AO||(AO=Object(s.a)(["\n    color: #7e2323;\n"]))),kk=d.b.span(EO||(EO=Object(s.a)(["\n    color: #79237e;\n"]))),yk=d.b.span(CO||(CO=Object(s.a)(["\n    color: #237c7e;\n"])));(VO=UO||(UO={})).getLabelJsx=function(e,n){var t=Object(se.jsx)(se.Fragment,{}),i=function(){t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"attr",children:"Attribute"}),function(){if(null==e.data)return Object(se.jsx)(Hk,{children:Object(se.jsx)(Gk,{children:"Create..."})});var n=e.data,t=n.symbols.map((function(e){var n;return"[".concat(null===(n=v.getSymbolFromKey(e))||void 0===n?void 0:n.name,"]")}));return Object(se.jsxs)(Hk,{children:["@",n.attr,": ",Object(se.jsx)(Jk,{children:t.join(", ")})]})}()]})},o=function(){t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"root",children:"Root"}),function(){if(null==e.data)return Object(se.jsx)(Hk,{children:Object(se.jsx)(Gk,{children:"Create..."})});var n=e.data,t=v.KEY12_SHARP_LIST;return Object(se.jsxs)(Hk,{children:["[",t[n.minIdx],"\uff5e",t[n.maxIdx],"]"]})}()]})},c=function(){t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"voicing",children:"Voicing"}),function(){if(null==e.data)return Object(se.jsx)(Hk,{children:Object(se.jsx)(Gk,{children:"Create..."})});var n=e.data;return Object(se.jsxs)(Hk,{children:["[",n.source.map((function(e){return"".concat(e.octave,"-").concat(e.struct)})).join(", "),"]"]})}()]})};switch(e.depth){case 0:!function(){var n=e.data;t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"base",children:"Base"}),Object(se.jsx)(Hk,{children:n.themaName})]})}();break;case 1:!function(){var n=e.data;t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"method",children:"Method"}),Object(se.jsx)(Hk,{children:n.method})]})}();break;case 2:var a;switch((null===(a=e.parent)||void 0===a?void 0:a.data).method){case"sustain":i();break;case"pattern":t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"sustain",children:"Sustain"}),function(){if(null==e.data)return Object(se.jsx)(Hk,{children:Object(se.jsx)(Gk,{children:"Create..."})});var n=e.data;return Object(se.jsxs)(Hk,{children:["[",n.beat,"* (",n.head,",",n.tail,")]"]})}()]})}break;case 3:var r,s;switch((null===(r=e.parent)||void 0===r||null===(s=r.parent)||void 0===s?void 0:s.data).method){case"sustain":o();break;case"pattern":t=Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(qk,{type:"pattern",children:"Pattern"}),function(){if(null==e.data)return Object(se.jsx)(Hk,{children:Object(se.jsx)(Gk,{children:"Create..."})});var n,t=e.data,i=(null===(n=e.parent)||void 0===n?void 0:n.data).patts.map((function(e){return e.refer})).includes(t.key)?" master":"",o=-1===t.refer?"":" depend: ".concat(t.refer);return Object(se.jsxs)(Hk,{children:[Object(se.jsx)(Xk,{children:t.key}),": [",t.pattName," ",Object(se.jsxs)(Qk,{children:[" channel: ",t.source.channelSize]}),"]",Object(se.jsx)(Wk,{children:i}),Object(se.jsx)(Yk,{children:o})]})}()]})}break;case 4:var l,d,b;switch((null===(l=e.parent)||void 0===l||null===(d=l.parent)||void 0===d||null===(b=d.parent)||void 0===b?void 0:b.data).method){case"sustain":c();break;case"pattern":i()}break;case 5:var u,h,p,x;switch((null===(u=e.parent)||void 0===u||null===(h=u.parent)||void 0===h||null===(p=h.parent)||void 0===p||null===(x=p.parent)||void 0===x?void 0:x.data).method){case"pattern":o()}break;case 6:var f,g,j,m,O;switch((null===(f=e.parent)||void 0===f||null===(g=f.parent)||void 0===g||null===(j=g.parent)||void 0===j||null===(m=j.parent)||void 0===m||null===(O=m.parent)||void 0===O?void 0:O.data).method){case"pattern":c()}}return Object(se.jsx)(Zk,{isActive:n,children:t})},VO.getInitialThema=function(){return{themaName:"test",meths:[{method:"sustain",prenams:[],defs:[]},{method:"pattern",prenams:[],defs:[]}]}};var Sk,wk,Lk,Ik,Ak,Ek,Ck,Tk,Mk,Dk,Nk,Fk,_k,zk,Rk,Bk,Pk,Kk,Uk=UO,Vk=Object(d.a)(TO||(TO=Object(s.a)(["\n    font-size: 24px;\n    font-weight: 600;\n    height: calc(100% - 8px);\n    margin-top: 4px;\n"]))),qk=d.b.div(MO||(MO=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    ","\n    color: #660000;\n    background-color: ",";\n    padding: 0 15px;\n    border-radius: 5px;\n"])),Vk,(function(e){switch(e.type){case"base":return"#6fa480";case"method":return"#7779a2";case"sustain":return"#c7a67e";case"pattern":return"#9b77a2";case"attr":return"#b67575";case"root":return"#a2a177";case"voicing":return"#779ea2"}})),Hk=d.b.div(DO||(DO=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    ","\n    color: #6d1717;\n    background-color: #ffffff49;\n    padding: 0 10px;\n    margin-left: 5px;\n"])),Vk),Jk=d.b.span(NO||(NO=Object(s.a)(["\n    color: #959595;\n"]))),Wk=d.b.span(FO||(FO=Object(s.a)(["\n    color: #d40101;\n"]))),Yk=d.b.span(_O||(_O=Object(s.a)(["\n    color: #0300cc;\n"]))),Gk=d.b.span(zO||(zO=Object(s.a)(["\n    color: #fff9c2;\n"]))),Qk=d.b.span(RO||(RO=Object(s.a)(["\n    color: #d3701381;\n"]))),Xk=d.b.span(BO||(BO=Object(s.a)(["\n    color: #868686;\n"]))),Zk=d.b.div(PO||(PO=Object(s.a)(["\n    display: inline-block;\n    padding: 0 5px;\n    height: 100%;\n    ","\n"])),(function(e){return e.isActive?Object(d.a)(KO||(KO=Object(s.a)(["\n        background-color: #fffb0077;\n    "]))):""})),$k=Object(o.createContext)({}),ey=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=Object(o.useState)(Uk.getInitialThema()),c=Object(l.a)(i,2),a=c[0],r=c[1],s=Object(o.useState)(null),d=Object(l.a)(s,2),b=d[0],u=d[1],p=Object(o.useState)(!1),x=Object(l.a)(p,2),f=x[0],g=x[1],j=Object(o.useState)(!1),v=Object(l.a)(j,2),m=v[0],O=v[1],k=Object(o.useState)(null),y=Object(l.a)(k,2),S=y[0],w=y[1],L=Object(o.useMemo)((function(){return{data:a,children:a.meths.map((function(e){return{data:e,children:function(){switch(e.method){case"sustain":return e.defs.map((function(e){return{data:e,children:e.roots.map((function(e){return{data:e,children:e.voics.map((function(e){return{data:e,children:[]}}))}}))}}));case"pattern":return e.defs.map((function(e){return{data:e,children:e.patts.map((function(e){return{data:e,children:e.attrs.map((function(e){return{data:e,children:e.roots.map((function(e){return{data:e,children:e.voics.map((function(e){return{data:e,children:[]}}))}}))}}))}}))}}))}}()}}))}}),[a]),I=Object(o.useMemo)((function(){if(null!=b)switch(b.depth){case 0:return 0;case 1:return 1;case 2:var e;return"sustain"===(null===(e=b.parent)||void 0===e?void 0:e.data).method?4:2;case 3:var n,t;return"sustain"===(null===(n=b.parent)||void 0===n||null===(t=n.parent)||void 0===t?void 0:t.data).method?5:3;case 4:var i,o,c;return"sustain"===(null===(i=b.parent)||void 0===i||null===(o=i.parent)||void 0===o||null===(c=o.parent)||void 0===c?void 0:c.data).method?6:4;case 5:return 5;case 6:return 6}return-1}),[b]),A=function(e,n){return I===e?Object(se.jsx)(ay,{children:n}):Object(se.jsx)(se.Fragment,{})};return Object(se.jsxs)(ny,{tabIndex:0,onKeyDown:function(e){_r.main(e,n,t)},children:[Object(se.jsxs)(ty,{children:[Object(se.jsx)(iy,{children:Object(se.jsx)(hk,{cur:b})}),Object(se.jsx)(oy,{children:Object(se.jsx)(rO.Frame,{rootDataNode:L,clickEvent:function(e){u(e)},getLabelJsx:function(e){return Uk.getLabelJsx(e,(null===b||void 0===b?void 0:b.data)==e.data)},invalidate:S,focusNode:b,isDisable:m})})]}),Object(se.jsx)(cy,{children:Object(se.jsx)($k.Provider,{value:{node:b,setFocusNode:u,invalidate:function(){w({})},setBackingWnd:g,dispatcher:t,treeDisable:m,setThamaData:r,setTreeDisable:O},children:Object(se.jsx)(le,{tabElements:[{name:"base",disable:!0,cont:A(0,Object(se.jsx)(rk,{themaList:n.systemState.themaList,addThema:function(e){var i=n.systemState.themaList;i.push(JSON.parse(JSON.stringify(e))),t.system.setState(Object(h.a)(Object(h.a)({},n.systemState),{},{themaList:i}))}}))},{name:"Method",disable:!0,cont:A(1,Object(se.jsx)(sk,{}))},{name:"Sustain",disable:!0,cont:A(2,Object(se.jsx)(bk,{}))},{name:"Pattern",disable:!0,cont:A(3,Object(se.jsx)(lk,{}))},{name:"Attribute",disable:!0,cont:A(4,Object(se.jsx)(ik,{isPattern:4===(null===b||void 0===b?void 0:b.depth)}))},{name:"Root",disable:!0,cont:A(5,Object(se.jsx)(dk,{}))},{name:"voicing",disable:!0,cont:A(6,Object(se.jsx)(uk,{isPattern:6===(null===b||void 0===b?void 0:b.depth)}))}],tabRecordNum:2,activeNo:I,selectTabIndex:function(e){return t.score.setScoreTabIndex(e)}})})}),Object(se.jsx)(ry,{isVisible:f,children:Object(se.jsx)(sy,{children:f?Object(se.jsx)(Jh,{}):Object(se.jsx)(se.Fragment,{})})})]})},ny=d.b.div(Sk||(Sk=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    background-color: #c3d8dd;\n    width: 100%;\n    height: 100%;\n"]))),ty=d.b.div(wk||(wk=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    /* background-color: #d5d4d8; */\n    width: calc(100% - ","px);\n    height: 100%;\n    vertical-align: top;\n"])),460),iy=d.b.div(Lk||(Lk=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    /* background-color: #d5d4d8; */\n    width: 100%;\n    height: 40px;\n"]))),oy=d.b.div(Ik||(Ik=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: calc(100% - 40px);\n"]))),cy=d.b.div(Ak||(Ak=Object(s.a)(["\n    display: inline-block;\n    /* position: relative; */\n    /* background-color: #532fc0; */\n    width: ","px;\n    height: 100%;\n    vertical-align: top;\n    box-sizing: border-box;\n    padding: 6px 6px 6px 0;\n"])),460),ay=d.b.div(Ek||(Ek=Object(s.a)(["\n    display: inline-block;\n    /* position: relative; */\n    background-color: #c0c9c4;\n    width: calc(100% - 4px);\n    height: calc(100% - 4px);\n    margin: 2px 0 0 2px;\n"]))),ry=d.b.div(Ck||(Ck=Object(s.a)(["\n    display: inline-block;\n    ","\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 10;\n    background-color: #0012616c;\n    width: 100%;\n    height: 100%;\n"])),(function(e){return e.isVisible?"":Object(d.a)(Tk||(Tk=Object(s.a)(["\n        display: none;\n    "])))})),sy=d.b.div(Mk||(Mk=Object(s.a)(["\n    display: inline-block;\n    width: 630px;\n    /* height: 400px; */\n    background-color: #a3a3a3;\n    /* opacity: 0.9; */\n    overflow: hidden;\n"]))),ly=function(){var e=Object(o.useContext)(gS);e.store,e.dispatcher;return Object(se.jsx)(dy,{children:Object(se.jsx)(le,{tabElements:[{name:"Backing-Library",disable:!0,cont:Object(se.jsx)(ey,{})},{name:"Design",disable:!0,cont:Object(se.jsx)("div",{})}],activeNo:0})})},dy=d.b.div(Dk||(Dk=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin: ","px 0 0 ","px;\n    width: calc(100% - ","px);\n    height: calc(100% - ","px);\n    background-color: transparent;\n    /* background-color: #c3d8dd6f; */\n    /* border: solid 1px black;\n    border-radius: 5px; */\n    /* box-shadow: 0 2px 14px 4px #000b3a48; */\n"])),8,8,16,16),by=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher,c=re.a.getDecryptionedScoreSeq(e.hashKey);return Object(o.useEffect)((function(){re.a.findScore(c).then((function(e){if(e.length>0){var n=e[0].data,o=e[0].owner,c=e[0].dispnam,a=re.a.unZip(n);!function(e,n,o){t.scoreState.focusIndex=2,t.scoreState.distIndex=t.scoreState.focusIndex,i.score.setScoreState(Object(h.a)({},t.scoreState)),i.score.setScoreData(o),t.scoreData=o,y.updateHarmonizeCache(t,i),t.systemState.mainChannelIndex=5,t.systemState.scoreTabIndex=0,t.systemState.directScore={owner:e,name:n},i.system.setState(t.systemState)}(o,c,JSON.parse(a))}}))}),[]),null==t.systemState.directScore?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(qm.a,{to:"/"})},uy=function(e){var n=Object(o.useContext)(gS),t=n.store,i=n.dispatcher;return Object(o.useEffect)((function(){var n=re.a.getDecryptionedUserSeq(e.hashKey);console.log(n),re.a.findUserInfoFromSeq(n).then((function(e){if(console.log(e),e.length>0){var n=e[0];t.userEnv.login=n,i.system.setUserEnv(t.userEnv)}}))}),[]),null==t.userEnv.login?Object(se.jsx)(se.Fragment,{}):Object(se.jsx)(qm.a,{to:"/"})},hy=function(){var e=Object(o.useContext)(gS);e.store,e.dispatcher;return Object(se.jsx)(Vm.a,{basename:"",children:Object(se.jsx)(py,{})})},py=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=new URLSearchParams(Object(qm.g)().search).get("v"),c=null!=n.systemState.directScore;return Object(se.jsxs)(qm.d,{children:[Object(se.jsx)(qm.b,{path:"/",exact:!0,children:Object(se.jsx)(xy,{children:Object(se.jsx)(qn,{tabElements:[{name:"Home",icon:Object(se.jsx)($n.a,{}),isEnable:!c,cont:Object(se.jsx)(vm,{})},{name:"Perform",icon:Object(se.jsx)(et.b,{}),isEnable:!1,cont:Object(se.jsx)(sm,{})},{name:"Score",icon:Object(se.jsx)(nt.c,{}),isEnable:!c,cont:Object(se.jsx)(om,{})},{name:"Custom",icon:Object(se.jsx)(it.a,{}),isEnable:!c,cont:Object(se.jsx)(ly,{})},{name:"Setting",icon:Object(se.jsx)(et.a,{}),isEnable:!1,cont:Object(se.jsx)(am,{})},{name:"Preview",icon:Object(se.jsx)(tt.a,{}),isEnable:c,cont:c?Object(se.jsx)(Km,{}):Object(se.jsx)(se.Fragment,{})}],activeNo:n.systemState.mainChannelIndex,selectTabIndex:function(e){return t.system.setMainTabIndex(e)}})})}),Object(se.jsx)(qm.b,{path:"/test",exact:!0,children:Object(se.jsx)(xy,{})}),Object(se.jsx)(qm.b,{path:"/preview",exact:!0,children:Object(se.jsx)(by,{hashKey:i})}),Object(se.jsx)(qm.b,{path:"/user",exact:!0,children:Object(se.jsx)(uy,{hashKey:i})})]})},xy=d.b.div(Nk||(Nk=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin: ","px 0 0 ","px;\n    width: calc(100% - ","px);\n    height: calc(100% - ","px);\n    background-color: transparent;\n    /* background-color: #c3d8dd6f; */\n    /* border: solid 1px black;\n    border-radius: 5px; */\n    /* box-shadow: 0 2px 14px 4px #000b3a48; */\n"])),15,15,30,30),fy=function(e){var n=Object(o.useState)(!1),t=Object(l.a)(n,2),i=t[0],c=t[1],a=Object(o.useState)(),r=Object(l.a)(a,2),s=r[0],d=r[1];return Object(o.useEffect)((function(){d(setTimeout((function(){c(!0)}),3e3))}),[]),Object(o.useEffect)((function(){i&&setTimeout((function(){e.remove()}),500)}),[i]),Object(se.jsx)(gy,{isSwitch:i,onClick:function(e){clearTimeout(s),c(!0)},children:Object(se.jsxs)(jy,{children:[Object(se.jsxs)(my,{children:[Object(se.jsx)("span",{children:"L"}),"iCreSia"]}),Object(se.jsx)(Oy,{children:"Now Loading..."}),Object(se.jsx)(ky,{children:"Copyright \xa9 2022 Licresia All Rights Reserved."})]})})},gy=d.b.div(Fk||(Fk=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 10;\n    width: 100%;\n    height: 100%;\n    background-color: #000f3a86;\n    opacity: ",";\n    transition: opacity 500ms;\n"])),(function(e){return e.isSwitch?"0":"1"})),jy=d.b.div(_k||(_k=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    left: calc(50% - 450px);\n    top: calc(50% - 300px);\n    z-index: 11;\n    width: 900px;\n    height: 600px;\n    background: radial-gradient(#868686, #ffffff);\n    border-radius: 8px;\n    border: solid 2px #cfcfcf;\n    box-sizing: border-box;\n    transition: opacity 500ms;\n"]))),vy=Object(d.c)(zk||(zk=Object(s.a)(["\n  0%, 100% {\n    opacity: 0.4;\n  }\n  50% {\n    opacity: 1;\n  }\n"]))),my=d.b.div(Rk||(Rk=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    margin-top: 10%;\n    width: 100%;\n    /* height: 400px; */\n    /* background-color: #0003b69e; */\n    background: linear-gradient(to bottom, #99999913, #ffffff13,#ffffff13,#ffffff13, #99999913);\n    color: white;\n    font-size: 130px;\n    font-weight: 600;\n    text-align: center;\n    text-shadow: 1px 2px 22px #0000003d;\n    /* line-height: 350px; */\n    animation: "," 3s linear infinite;\n    /* -webkit-box-reflect:below 1px; */\n    -webkit-box-reflect: below 1px -webkit-gradient(\n      linear,left top,left bottom,\n      from(transparent),\n      color-stop(0.6, transparent),\n      to(#f80000));\n    & span {\n        color: red;\n        font-size: 160px;\n    }\n"])),vy),Oy=d.b.div(Bk||(Bk=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    bottom: 80px;\n    width: 100%;\n    left: 20px;\n    color: #ffffff;\n    font-size: 42px;\n    font-weight: 600;\n    text-align: center;\n"]))),ky=d.b.div(Pk||(Pk=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    bottom: 5px;\n    left: 20px;\n    color: #636363;\n    font-size: 22px;\n    font-weight: 600;\n    text-align: left;\n"]))),yy=t(70);!function(e){var n=e.createURL=function(e,n,t){var i=document.createElement("canvas"),o=i.getContext("2d");return i.width=e,i.height=n,t(o),i.toDataURL()};e.getLogoURL=function(){return Kk.createURL(350,80,(function(e){e.shadowColor="#555",e.shadowOffsetX=2,e.shadowOffsetY=1,e.shadowBlur=5,e.font="55pt Arial",e.fillStyle="#db0000",e.fillText("L",30,70);var n=e.measureText("L").width;e.fillStyle="#ffffff",e.fillText("iCreSia",30+n,70),e.save()}))},e.getAuthTextURL=function(e){var t=ne.AUTH_TEXT_WIDTH,i=ne.AUTH_TEXT_WIDTH/6;return n(t,ne.AUTH_TEXT_HEIGHT,(function(n){n.rotate(1*Math.PI/180);for(var t=0;t<e.length;t++){var o=e.charAt(t),c=60*Math.random(),a=60*Math.random();n.font="".concat(20+c,"pt Arial"),n.fillStyle="rgba("+[40,0,100,.05+.01*a]+")",n.fillText(o,t*i,60)}}))}}(Kk||(Kk={}));var Sy,wy,Ly,Iy,Ay,Ey,Cy,Ty,My,Dy,Ny,Fy,_y,zy,Ry,By,Py,Ky,Uy,Vy,qy,Hy,Jy,Wy,Yy,Gy,Qy=Kk,Xy=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=Object(o.useState)(!1),c=Object(l.a)(i,2),a=c[0],r=c[1],s=Object(o.useState)({value:"",errors:[]}),d=Object(l.a)(s,2),b=d[0],h=d[1],x=Object(o.useState)({value:"",errors:[]}),f=Object(l.a)(x,2),g=f[0],j=f[1],v=Object(o.useState)({value:"",errors:[]}),m=Object(l.a)(v,2),O=m[0],k=m[1],y=Object(o.useState)([]),S=Object(l.a)(y,2),w=S[0],L=S[1],I=Object(o.useState)([]),A=Object(l.a)(I,2),E=A[0],C=A[1],T=function(){for(var e="0123456789",n="",t=0;t<6;t++)n+=e.charAt(Math.random()*e.length);return n};Object(o.useEffect)((function(){re.a.findUserIdList().then((function(e){C(e)}))}),[]);var M=Object(o.useState)(T()),D=Object(l.a)(M,2),N=D[0],F=D[1],_=Object(o.useState)({value:"",errors:[]}),z=Object(l.a)(_,2),R=z[0],B=z[1],P=Object(o.useMemo)((function(){return Qy.getAuthTextURL(N)}),[N]);Object(o.useEffect)((function(){var e=[];if(b.errors.length>0)switch(b.errors[0]){case"required":e.push("[user id] is required.");break;case"length":e.push("[user id] set a value between 4 and 20.");break;case"value":e.push("[user id] accepts only half-width alphanumeric characters.");break;case"relation":e.push("[user id] already in use.")}if(g.errors.length>0)switch(g.errors[0]){case"required":e.push("[password] is required.");break;case"length":e.push("[password] set a value between 4 and 20.");break;case"relation":e.push("[password] does not match confirm.")}if(O.errors.length>0)switch(O.errors[0]){case"length":e.push("[password *] set a value between 4 and 20.")}L(e)}),[b,g]);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(Zy,{isVisible:!a,children:Object(se.jsx)(He.BorderPanel,{title:"Login information",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(He.Message,{message:"Please, enter User ID/Pass (Confirm)."}),Object(se.jsx)(He.InputTextForm,{placeholder:"user id",checkable:b,setCheckable:h,validates:[{checker:function(e){return cn.checkRequired(e)},errorType:"required"},{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return cn.checkAsciiChars(e)},errorType:"value"},{checker:function(e){return!E.includes(e)},errorType:"relation"}],width:300,isCenter:!0}),Object(se.jsx)(He.InputTextForm,{placeholder:"password",isPassword:!0,checkable:g,setCheckable:j,validates:[{checker:function(e){return cn.checkRequired(e)},errorType:"required"},{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return e===O.value},errorType:"relation"}],dependency:[O],width:300,isCenter:!0}),Object(se.jsx)(He.InputTextForm,{placeholder:"password*",isPassword:!0,checkable:O,setCheckable:k,validates:[{checker:function(e){return cn.checkRequired(e)},errorType:"required"},{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return e===g.value},errorType:"relation"}],dependency:[g],width:300,isCenter:!0}),Object(se.jsx)(He.InfoFrame,{textRecords:w}),Object(se.jsx)(He.ButtonRecord,{buttons:[{label:"Enter",isEnable:0===b.errors.length&&0===g.errors.length&&0===O.errors.length,callback:function(){r(!0)}}]})]})})}),Object(se.jsxs)(Zy,{isVisible:a,children:[Object(se.jsx)(He.BorderPanel,{title:"Proof not a robot",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(He.Message,{message:"Please, input the same 6 number as the picture."}),Object(se.jsx)($y,{src:P}),Object(se.jsx)(He.ButtonRecord,{buttons:[{label:"Change",callback:function(){F(T()),B({value:"",errors:[]})}}]}),Object(se.jsx)(He.InputTextForm,{placeholder:"6 numbers",checkable:R,setCheckable:B,width:300,isCenter:!0}),Object(se.jsx)(He.ButtonRecord,{buttons:[{label:"Regist",isEnable:0===R.errors.length&&N===R.value,callback:function(){Object(p.a)(u.a.mark((function e(){var i,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.a.sendQueryRequestToAPI("select","SELECT count(*) as cnt FROM user_tbl where id = '".concat(b,"'"));case 2:return i=e.sent,e.next=5,i.json();case 5:if(o=e.sent,console.log(JSON.stringify(o[0].cnt)),!(o[0].cnt>0)){e.next=12;break}L(["That user id has already been recorded."]),e.next=19;break;case 12:return e.next=14,re.a.getNextUserSeq();case 14:return c=e.sent,console.log(c),e.next=18,re.a.sendQueryRequestToAPI("update","INSERT INTO user_tbl(seq, id, password) VALUES(".concat(c,", '").concat(b.value,"', '").concat(g.value,"')"));case 18:t.system.setDialog(Object(se.jsx)(hn.Component,{message:"You have successfully created an account!",buttons:[{label:"OK",callback:function(){n.userEnv.login={seq:c,id:b.value,password:g.value,email:""},t.system.setUserEnv(n.userEnv),t.system.setDialog(Object(se.jsx)(gn,{}))}}]}));case 19:case"end":return e.stop()}}),e)})))()}}]})]})}),Object(se.jsx)(He.MessageLink,{message:"Return to login information.",clickAction:function(){r(!1)}})]})]})},Zy=d.b.div(Sy||(Sy=Object(s.a)(["\n    display: ",";\n"])),(function(e){return e.isVisible?"block":"none"})),$y=d.b.img(wy||(wy=Object(s.a)(["\n    display: block;\n    text-align: center;\n    margin: 4px auto;\n    background-color: #f7f0f0;\n    border: 1px solid #888888;\n    box-sizing: border-box;\n"]))),eS=function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=Object(o.useState)(!1),c=Object(l.a)(i,2),a=c[0],r=c[1],s=Object(o.useState)({value:"",errors:[]}),d=Object(l.a)(s,2),b=d[0],h=d[1],x=Object(o.useState)({value:"",errors:[]}),f=Object(l.a)(x,2),g=f[0],j=f[1],v=Object(o.useState)({value:"",errors:[]}),m=Object(l.a)(v,2),O=m[0],k=m[1],y=Object(o.useState)([]),S=Object(l.a)(y,2),w=S[0],L=S[1];Object(o.useEffect)((function(){var e=[];if(b.errors.length>0)switch(b.errors[0]){case"required":e.push("[user id] is required.");break;case"length":e.push("[user id] set a value between 4 and 20.");break;case"value":e.push("[user id] accepts only half-width alphanumeric characters.");break;case"relation":e.push("[user id] already in use.")}if(g.errors.length>0)switch(g.errors[0]){case"required":e.push("[password] is required.");break;case"length":e.push("[password] set a value between 4 and 20.")}L(e)}),[b,g]);return Object(se.jsxs)(se.Fragment,{children:[Object(se.jsxs)(nS,{isVisible:!a,children:[Object(se.jsx)(He.BorderPanel,{title:"Login information",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(He.Message,{message:"Please, enter User ID/Pass."}),Object(se.jsx)(He.InputTextForm,{placeholder:"user id",checkable:b,setCheckable:h,validates:[{checker:function(e){return cn.checkRequired(e)},errorType:"required"},{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"},{checker:function(e){return cn.checkAsciiChars(e)},errorType:"value"}],width:300,isCenter:!0}),Object(se.jsx)(He.InputTextForm,{placeholder:"password",isPassword:!0,checkable:g,setCheckable:j,validates:[{checker:function(e){return cn.checkRequired(e)},errorType:"required"},{checker:function(e){return cn.checkStringLength(e,4,20)},errorType:"length"}],width:300,isCenter:!0}),Object(se.jsx)(He.InfoFrame,{textRecords:w}),Object(se.jsx)(He.ButtonRecord,{buttons:[{label:"Enter",isEnable:0===b.errors.length&&0===g.errors.length,callback:function(){Object(p.a)(u.a.mark((function e(){var i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re.a.findUserInfoLogin(b.value,g.value);case 2:i=e.sent,console.log(JSON.stringify(i)),i.length>0?(n.userEnv.login={seq:i[0].seq,id:i[0].id,password:i[0].password,email:i[0].email},t.system.setUserEnv(n.userEnv),t.system.setDialog(Object(se.jsx)(hn.Component,{message:"Login successful!"}))):L(["Incorrect user id or password."]);case 5:case"end":return e.stop()}}),e)})))()}}]})]})}),Object(se.jsx)(He.MessageLink,{message:"Forgot your login information?",clickAction:function(){r(!0)}})]}),Object(se.jsxs)(nS,{isVisible:a,children:[Object(se.jsx)(He.BorderPanel,{title:"Email",innerJsx:Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(He.Message,{message:"Submit login information to account address."}),Object(se.jsx)(He.InputTextForm,{placeholder:"email",checkable:O,setCheckable:k,validates:[{checker:function(e){return cn.checkRequired(e)},errorType:"required"},{checker:function(e){return cn.checkStringLength(e,4,40)},errorType:"length"},{checker:function(e){return 0===e.length||2===e.split("@").length},errorType:"value"}],width:500,isCenter:!0}),Object(se.jsx)(He.ButtonRecord,{buttons:[{label:"Send",isEnable:0===O.errors.length,callback:function(){re.a.findUserInfoFromEmail(O.value).then((function(e){if(e.length>0){var n=e[0],i=re.a.getHashedFromUserSeq(n.seq),o="https://demo-app.licresia.com/#/user?v=".concat(i);re.a.sendQueryRequestToMailAPI({from:"info@licresia.com",to:O.value,subject:"\u3010LiCreSia\u3011support",text:"Your login information is as follows.\n\nURL: ".concat(o,"\nUSR ID: ").concat(n.id)}),t.system.setDialog(Object(se.jsx)(hn.Component,{message:"Your login information has been sent!"}))}else t.system.setDialog(Object(se.jsx)(hn.Component,{message:"This email address is not registered."}))}))}}]})]})}),Object(se.jsx)(He.MessageLink,{message:"Return to login information.",clickAction:function(){r(!1)}})]})]})},nS=d.b.div(Ly||(Ly=Object(s.a)(["\n    display: ",";\n"])),(function(e){return e.isVisible?"block":"none"})),tS=function(){var e=Object(o.useContext)(gS),n=(e.store,e.dispatcher,Object(o.useState)(!1)),t=Object(l.a)(n,2),i=t[0],c=t[1],a=Object(o.useMemo)((function(){return Qy.getLogoURL()}),[]);return Object(se.jsxs)(iS,{width:600,height:500,children:[Object(se.jsx)(oS,{children:Object(se.jsx)("img",{src:a})}),Object(se.jsxs)(cS,{children:[Object(se.jsx)(aS,{isActive:!i,onClick:function(){c(!1)},children:"Login"}),Object(se.jsx)(aS,{isActive:i,onClick:function(){c(!0)},children:"Create Account"})]}),i?Object(se.jsx)(Xy,{}):Object(se.jsx)(eS,{})]})},iS=d.b.div(Iy||(Iy=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    z-index: 11;\n    top: calc(50% - ","px);\n    left: calc(50% - ","px);\n    width: ","px;\n    height: ","px;\n    background-color: #e7e7e7e2;\n    border: 1px solid #9e9e9e;\n    border-radius: 4px;\n"])),(function(e){return e.height/2}),(function(e){return e.width/2}),(function(e){return e.width}),(function(e){return e.height})),oS=d.b.div(Ay||(Ay=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 80px;\n    background-color: #eeeaea;\n    text-align: center;\n"]))),cS=d.b.div(Ey||(Ey=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: 50px;\n    /* background-color: #d1d1d1; */\n    text-align: center;\n"]))),aS=d.b.div(Cy||(Cy=Object(s.a)(["\n    ",";\n    background-color: #bf808075;\n    ","\n    color: white;\n    width: 250px;\n    margin: 10px 10px;\n    text-align: center;\n    &:hover {\n    background-color: #bf8080a2;\n        ","\n    }\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isActive?Object(d.a)(Ty||(Ty=Object(s.a)(["\n        background-color: #c7a73e;\n    "]))):""}),(function(e){return e.isActive?Object(d.a)(My||(My=Object(s.a)(["\n            background-color: #c7a73e;\n        "]))):""})),rS=(d.b.div(Dy||(Dy=Object(s.a)(["\n    display: inline-block;\n    margin: 2px 0 0 0;\n    width: 100%;\n    height: 50px;\n    /* background-color: #e6e3c1; */\n    text-align: left;\n"]))),d.b.div(Ny||(Ny=Object(s.a)(["\n    ",";\n    /* background-color: #80e45832; */\n    color: #bd2d2d;\n    width: 150px;\n    margin: 10px 0 0 5px;\n    text-align: center;\n"])),Be.CSS_LABEL_MIDIUM),d.b.input(Fy||(Fy=Object(s.a)(["\n    ",";\n    background-color: #f7f09787;\n    width: 300px;\n    margin: 10px 0 0 15px;\n    text-align: center;\n    border: solid 1px #5e5e5e;\n    text-align: left;\n    box-sizing: border-box;\n    border-radius: 4px;\n"])),Be.CSS_LABEL_MIDIUM),d.b.div(_y||(_y=Object(s.a)(["\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    padding: 6px 4px 0 0;\n    box-sizing: border-box;\n    width: 100%;\n    height: 50px;\n    background-color: #d1d1d1;\n    text-align: right;\n"]))),d.b.div(zy||(zy=Object(s.a)(["\n    ",";\n    ",";\n    background-color: #5c9253;\n    width: 150px;\n    margin: 10px 5px 0 0;\n    text-align: center;\n    &:hover {\n        background-color: #7eaf75;\n    }\n"])),Be.CSS_LABEL_MIDIUM,(function(e){return e.isEnable?"":Be.CSS_BUTTON_DISABLE})),function(){var e=Object(o.useContext)(gS),n=e.store,t=e.dispatcher,i=n.userEnv.login,c=Object(o.useState)(""),a=Object(l.a)(c,2),r=a[0],s=a[1];Object(o.useEffect)((function(){console.log(i),void 0!=i&&s("@"+i.id)}),[i]);var d=void 0==i?Object(se.jsxs)(pS,{onClick:function(){n.systemState.dialog=Object(se.jsx)(tS,{}),t.system.setState(n.systemState),console.log(window.location.origin)},children:[Object(se.jsx)("div",{children:Object(se.jsx)(tt.b,{})}),"Login / Sign up"]}):Object(se.jsxs)(se.Fragment,{children:[Object(se.jsx)(xS,{isEntry:null!=n.userEnv.login,onClick:function(){t.system.setDialog(Object(se.jsx)(gn,{}))},children:r}),Object(se.jsxs)(pS,{onClick:function(){n.userEnv.login=null,t.system.setUserEnv(n.userEnv),t.system.setDialog(Object(se.jsx)(hn.Component,{message:"Logout.\nSee you next time!"}))},children:[Object(se.jsx)("div",{children:Object(se.jsx)(tt.b,{})}),"Logout"]})]});return Object(se.jsxs)(sS,{children:[Object(se.jsxs)(lS,{children:[Object(se.jsx)(bS,{children:"L"}),Object(se.jsx)(dS,{children:"iCreSia"})]}),Object(se.jsxs)(uS,{children:[d,Object(se.jsx)(fS,{children:Object(se.jsx)("div",{children:Object(se.jsx)(yy.a,{})})})]})]})}),sS=d.b.div(Ry||(Ry=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: ","px;\n    background: linear-gradient(to bottom, #ececec, #e2e2e2, #eeeeee);\n    /* background-color: #c2c2c2; */\n    box-shadow: 0 0 8px 0 #000b3a48;\n"])),44),lS=d.b.div(By||(By=Object(s.a)(["\n    display: inline-block;\n    margin: 2px 0 0 10px;\n    width: 200px;\n    height: calc(100% - 4px);\n    /* background-color: #00000013; */\n    font-size: 34px;\n    font-weight: 600;\n    line-height: 36px;\n    text-shadow: 1px 2px 3px #8080806a;\n"]))),dS=d.b.span(Py||(Py=Object(s.a)(["\n    color: #ffffff;\n"]))),bS=d.b.span(Ky||(Ky=Object(s.a)(["\n    font-size: 34px;\n    color: #da4242;\n"]))),uS=d.b.div(Uy||(Uy=Object(s.a)(["\n    display: inline-block;\n    /* width: 300px; */\n    height: 100%;\n    position: absolute;\n    right: 30px;\n    /* background-color: #ff00002b; */\n"]))),hS=d.b.div(Vy||(Vy=Object(s.a)(["\n    background-color: #c9c7c7;\n    &:hover {\n        background-color: #cf9bae;\n    }\n    transition: background-color 800ms;\n"]))),pS=Object(d.b)(hS)(qy||(qy=Object(s.a)(["\n    display: inline-block;\n    /* width: 240px; */\n    padding: 0 30px;\n    margin: 5px 10px 0 0;\n    height: calc(100% - 10px);\n    border-radius: 20px;\n    /* background: linear-gradient(to bottom, #e9baba, #d39d9d, #e9baba); */\n    /* background-color: #adadad; */\n    /* border: 1px solid #7e7e7e; */\n    /* box-shadow: 0 0 8px 0 #000b3a48; */\n    /* text-shadow: 1px 2px 3px #808080ba; */\n    text-align: center;\n    font-size: 22px;\n    font-weight: 600;\n    line-height: 28px;\n    color: #ffffff;\n    vertical-align: top;\n\n    & div {\n        display: inline-block;\n        /* background-color: #0000007d; */\n        margin: 2px 5px 0 0;\n        vertical-align: top;\n    }\n"]))),xS=d.b.div(Hy||(Hy=Object(s.a)(["\n    display: inline-block;\n    /* width: 240px; */\n    margin: 5px 20px 0 0;\n    height: calc(100% - 10px);\n    text-align: center;\n    font-size: 22px;\n    font-weight: 600;\n    line-height: 28px;\n    color: #003a86;\n    ","\n    vertical-align: top;\n"])),(function(e){return e.isEntry?"":Object(d.a)(Jy||(Jy=Object(s.a)(["\n        color: #96000057;\n    "])))})),fS=Object(d.b)(hS)(Wy||(Wy=Object(s.a)(["\n    display: inline-block;\n    width: ","px;\n    height: ","px;\n    margin: 3px 0 0 0;\n    border-radius: 50%;\n    /* background: linear-gradient(to bottom, #e9baba, #d39d9d, #e9baba); */\n    /* background-color: #48aa9d; */\n    /* border: 1px solid #7e7e7e; */\n    /* box-shadow: 0 0 8px 0 #000b3a48; */\n    /* text-shadow: 1px 2px 3px #808080ba; */\n    /* text-align: center; */\n    font-size: 28px;\n    font-weight: 600;\n    color: #ffffff;\n    & div {\n        display: inline-block;\n        margin: 2px 0 0 5px;\n        /* background-color: #0000007d; */\n        vertical-align: top;\n    }\n"])),38,38),gS=Object(o.createContext)({}),jS=function(){var e=Object(o.useReducer)(g,Kn),n=Object(l.a)(e,2),t=n[0],i=n[1],c=new yn(t,i),a=Object(o.useCallback)(c.system.switchSplashToMain,[]);return Object(se.jsx)(gS.Provider,{value:{store:t,dispatcher:c},children:Object(se.jsxs)(se.Fragment,{children:[t.systemState.isSplash?Object(se.jsx)(fy,{remove:a}):Object(se.jsx)(se.Fragment,{}),Object(se.jsxs)(vS,{children:[Object(se.jsx)(Un,{}),Object(se.jsx)(rS,{}),Object(se.jsx)(mS,{children:Object(se.jsx)(hy,{})})]})]})})},vS=d.b.div(Yy||(Yy=Object(s.a)(["\n    display: inline-block;\n    position: relative;\n    width: 100%;\n    height: 100%;\n    background-color: #d8d8d8;\n"]))),mS=d.b.div(Gy||(Gy=Object(s.a)(["\n    display: inline-block;\n    width: 100%;\n    height: calc(100% - ","px);\n    /* background-color: #c2c2c2; */\n"])),44);var OS=function(){return Object(o.useEffect)((function(){document.oncontextmenu=function(){return!1},document.onkeydown=function(e){if(e.ctrlKey&&["f","s"].includes(e.key))return!1}}),[]),Object(se.jsx)(jS,{})},kS=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,132)).then((function(n){var t=n.getCLS,i=n.getFID,o=n.getFCP,c=n.getLCP,a=n.getTTFB;t(e),i(e),o(e),c(e),a(e)}))},yS=t(71);r.a.render(Object(se.jsx)(yS.a,{domain:"dev-a0p0m4lr.us.auth0.com",clientId:"ABaWpYVBZwTr3tkyxhq1kWh2YwT4epew",redirectUri:window.location.origin,children:Object(se.jsx)(c.a.StrictMode,{children:Object(se.jsx)(OS,{})})}),document.getElementById("root")),kS()},77:function(e,n,t){},90:function(e,n){},92:function(e,n){}},[[131,1,2]]]);
//# sourceMappingURL=main.832c4e02.chunk.js.map